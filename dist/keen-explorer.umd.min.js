!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"),require("react"),require("classnames"),require("moment"),require("keymirror"),require("jQuery"),require("string"),require("qs"),require("react-highlight"),require("keen-dataviz"),require("flux"),require("json-stable-stringify"),require("react-dom"),require("keen-analysis"));else if("function"==typeof define&&define.amd)define(["lodash","react","classnames","moment","keymirror","jQuery","string","qs","react-highlight","keen-dataviz","flux","json-stable-stringify","react-dom","keen-analysis"],t);else{var a="object"==typeof exports?t(require("lodash"),require("react"),require("classnames"),require("moment"),require("keymirror"),require("jQuery"),require("string"),require("qs"),require("react-highlight"),require("keen-dataviz"),require("flux"),require("json-stable-stringify"),require("react-dom"),require("keen-analysis")):t(e.lodash,e.react,e.classnames,e.moment,e.keymirror,e.jQuery,e.string,e.qs,e["react-highlight"],e["keen-dataviz"],e.flux,e["json-stable-stringify"],e["react-dom"],e["keen-analysis"]);for(var n in a)("object"==typeof exports?exports:e)[n]=a[n]}}(window,function(e,t,a,n,r,i,l,s,o,u,c,d,p,f){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=88)}([function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toTitleCase=u,t.singularize=c,t.prettyPrintJSON=d,t.coercionTypeForPropertyType=p,t.booleanMap=f,t.sortItems=h,t.isDateInStrictFormat=m,t.convertDateToUTC=v,t.formatISOTimeNoTimezone=y,t.generateRandomId=g,t.generateTempId=E,t.isValidQueryValue=_,t.parseList=b,t.isList=C,t.isNullOrUndefined=T,t.padLeft=S;var n=l(a(0)),r=l(a(44)),i=l(a(9));function l(e){return e&&e.__esModule?e:{default:e}}var s="YYYY-MM-DDTHH:mm:ss.SSS";function o(e){return"'"===e.substring(0,1)&&"'"===e.substring(e.length-1)}function u(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function c(e){return e.replace(/s+$/,"")}function d(e){return JSON.stringify(e,void 0,2)}function p(e){return{string:"String",num:"Number",datetime:"Datetime",list:"List",null:"Null",bool:"Boolean"}[e]}function f(e){return null===e||""===e?"":"false"===e?"false":"true"===e?"true":e?"true":"false"}function h(e,t){t=t||function(e){return e.replace(/[-_ .]/,"").toLowerCase()};var a=e.map(function(e,a){return{index:a,value:t(e)}});return a.sort(function(e,t){return e.value.localeCompare(t.value)}),a.map(function(t){return e[t.index]})}function m(e){return(0,i.default)(e,s,!0).isValid()}function v(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}function y(e){return(0,i.default)(e).format("YYYY-MM-DDTHH:mm:ss.SSS")}function g(e){return(e||"")+(+new Date+Math.floor(999999*Math.random())).toString(36)}function E(){return g("TEMP-")}function _(e){return n.default.isArray(e)?e.length>0:!1===e||(0===e||(n.default.isPlainObject(e)?!n.default.isEmpty(e):!T(e)))}function b(e){if(e){if(!C(e))return"";var t=(0,r.default)(e).parseCSV();return t=n.default.map(t,function(e){if(o(e)){var t=e.replace("'","");parseFloat(t)&&(e=parseFloat(t))}return e})}return""}function C(e){var t,a=!0,n=String(e).match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);if(n){for(var r=0;r<n.length&&(a=o(n[r].trim())||'"'===(t=n[r].trim()).substring(0,1)&&'"'===t.substring(t.length-1));r++);return a}return!1}function T(e){return n.default.isNull(e)||n.default.isUndefined(e)}function S(e){return e<10?"0"+e:e}var P={toTitleCase:u,singularize:c,prettyPrintJSON:d,coercionTypeForPropertyType:p,booleanMap:f,sortItems:h,isDateInStrictFormat:m,convertDateToUTC:v,formatISOTimeNoTimezone:y,generateRandomId:g,generateTempId:E,isValidQueryValue:_,parseList:b,isList:C,isNullOrUndefined:T,padLeft:S};t.default=P},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(0)),r=c(a(45)),i=c(a(82)),l=(c(a(9)),c(a(2))),s=c(a(81)),o=(c(a(5)),c(a(8))),u=c(a(17));function c(e){return e&&e.__esModule?e:{default:e}}var d=["event_collection","analysis_type","target_property","percentile","group_by","timeframe","interval","timezone","filters","steps","email","latest","property_names"],p=["extraction","count","funnel"];var f={};function h(e,t){return n.default.without(n.default.map(e,t),f)}var m={EXRACTION_EVENT_LIMIT:100,isPersisted:function(e){return e.id&&!e.id.toString().match("TEMP")},saveType:function(e){return m.isPersisted(e)?"update":"save"},shouldHaveTarget:function(e){return!l.default.isNullOrUndefined(e.query.analysis_type)&&-1===p.indexOf(e.query.analysis_type)},isEmailExtraction:function(e){return"extraction"===e.query.analysis_type&&!n.default.isNull(e.query.email)},isImmediateExtraction:function(e){return"extraction"===e.query.analysis_type&&n.default.isNull(e.query.email)},mergeResponseWithExplorer:function(e,t){var a=n.default.defaultsDeep(m.formatQueryParams(t),e);return delete a.originalModel,a.id=t.query_name,a.originalModel=n.default.cloneDeep(a),a},queryJSON:function(e){if(e&&e.query){var t=n.default.cloneDeep(e.query);return"extraction"===t.analysis_type?l.default.isNullOrUndefined(t.email)&&(t.latest=100):(delete t.latest,delete t.email,delete t.property_names),"funnel"!==t.analysis_type&&n.default.assign(t,u.default.getTimeParameters(t.time,t.timezone)),t.filters&&(t.filters=n.default.map(t.filters,function(e){return o.default.queryJSON(e)})),t.steps&&(t.steps=n.default.map(t.steps,s.default.stepJSON)),n.default.each(t,function(e,a){n.default.isArray(e)&&n.default.remove(e,function(e){return!n.default.isNumber(e)&&n.default.isEmpty(e)}),l.default.isValidQueryValue(e)&&n.default.includes(d,a)||delete t[a]}),t}},toJSON:function(e){var t=n.default.pick(e,["id","query_name","refresh_rate","metadata"]);return t.query=m.queryJSON(e),"extraction"===t.query.analysis_type&&(t.refresh_rate=0),t},cleanJSONforSave:function(e){return"extraction"===e.query.analysis_type&&(e.query.latest=100,delete e.query.email,delete e.query.property_names),e},paramsForURL:function(e){var t=m.toJSON(e);return n.default.omit(t,["id","query_name","refresh_rate","metadata"])},runQuery:function(e){e.client.query(e.query.analysis_type,n.default.omit(e.query,"analysis_type")).then(function(t,a){a?e.error(a):e.success(t),e.complete&&e.complete(a,t)}).catch(e.error)},formatQueryParams:function(e){if(e&&e.query){if(e.query&&e.query.timeframe){var t=u.default.unpackTimeframeParam(e.query.timeframe,e.query.timezone);e.query.time=t.time,e.query.timezone=t.timezone}return e.query.group_by&&!n.default.isArray(e.query.group_by)&&(e.query.group_by=[e.query.group_by]),e.query.filters&&(e.query.filters=n.default.compact(n.default.map(e.query.filters,o.default.formatFilterParams))),e.query.steps&&(e.query.steps=n.default.compact(n.default.map(e.query.steps,s.default.formatQueryParams)),e.query.steps[e.query.steps.length-1].active=!0),!e.id&&e.query_name&&(e.id=e.query_name),e.metadata||(e.metadata={}),e.metadata.display_name||(e.metadata.display_name=e.query_name),e.metadata.visualization&&e.metadata.visualization.chart_type||(e.metadata.visualization={},e.query.interval?e.metadata.visualization.chart_type="area":e.metadata.visualization.chart_type="metric"),e}},encodeAttribute:function(e){return encodeURIComponent(JSON.stringify(e))},getApiQueryUrl:function(e,t){var a=m.queryJSON(t),i=e.url("queries",a.analysis_type);a.analysis_type;delete a.analysis_type;var l=n.default.cloneDeep(a.timeframe);delete a.timeframe;var s,o=n.default.map(a.filters,function(e){return n.default.omit(n.default.cloneDeep(e),"coercion_type")});delete a.filters,a.steps&&a.steps.length&&(s=m.encodeAttribute(a.steps),delete a.steps),a.group_by&&n.default.isArray(a.group_by)&&a.group_by.length&&(a.group_by=a.group_by.length>1?JSON.stringify(a.group_by):a.group_by[0]);var c=r.default.stringify(a);return l&&"relative"===u.default.timeframeType(t.query.time)?c+="&timeframe="+l:l&&"absolute"===u.default.timeframeType(t.query.time)&&(c+="&timeframe="+(l=m.encodeAttribute(l))),o&&(c+="&filters="+(o=m.encodeAttribute(o))),s&&(c+="&steps="+s),i+="?api_key="+e.readKey()+"&"+c},resultCanBeVisualized:function(e){return e.response&&!l.default.isNullOrUndefined(e.response.result)&&(n.default.isNumber(e.response.result)||n.default.isArray(e.response.result)&&e.response.result.length)},isJSONViz:function(e){return e.metadata.visualization.chart_type&&"json"===e.metadata.visualization.chart_type.toLowerCase()},isTableViz:function(e){return e.metadata.visualization.chart_type&&"table"===e.metadata.visualization.chart_type.toLowerCase()},getSdkExample:function(e,t){var a,r,l,s={host:"api.keen.io",protocol:"https",requestType:"jsonp"},o=m.queryJSON(e),u=i.default,c="Untitled Chart";e.metadata&&e.metadata.display_name&&(c=e.metadata.display_name);var d="";switch(e.metadata&&e.metadata.visualization&&e.metadata.visualization.chart_type&&"JSON"!==e.metadata.visualization.chart_type&&(d=e.metadata.visualization.chart_type),o.analysis_type){case"funnel":r=["steps"];break;default:r=["event_collection","filters","group_by","interval","target_property","percentile","timeframe","timezone"]}o.steps&&(o.steps=n.default.map(o.steps,function(e){return n.default.omit(e,"active")})),l=h(["host","protocol","requestType"],function(e){return t.config[e]==s[e]?f:"  "+e+": "+u(t.config[e])}).join(",\n"),n.default.each(o.filters,function(e){delete e.coercion_type}),a=h(r,function(e){return o[e]?"        "+e+": "+u(o[e],{space:0}):f}).join(",\n");var p,v,y=["<!DOCTYPE html>","<html>","<head>",'  <meta charset="utf-8">','  <link href="https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.css" rel="stylesheet" />',"</head>","<body>","  \x3c!-- Target DOM Node --\x3e",'  <div id="keen-example-chart"></div>',"  ",'  <script src="https://d26b395fwzu5fz.cloudfront.net/keen-analysis-1.2.2.js" type="text/javascript"><\/script>','  <script src="https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.js" type="text/javascript"><\/script>','  <script type="text/javascript">',"    var client = new Keen({","      projectId: "+u(t.config.projectId)+",","      readKey: "+u(t.config.readKey)+(p=l,v=",",p?v:""),l,"    });","    ","    var chart = new Keen.Dataviz()",'      .el("#keen-example-chart")',"      .height(240)",'      .title("'+c+'")',""+d?'      .type("'+d+'")':"","      .prepare();","    ","    client","      .query("+u(o.analysis_type)+", {",a,"      })","      .then(function(res) {","        chart.data(res).render();","      })","      .catch(function(err) {","        chart.message(err.message);","      });","    ","  <\/script>","</body>","</html>"];return n.default.filter(y,function(e){return""!==e}).join("\n")},slugify:function(e){return e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/ /g,"-")}};t.default=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(a(0)),r=m(a(7)),i=m(a(19)),l=m(a(11)),s=m(a(25)),o=m(a(18)),u=m(a(24)),c=m(a(28)),d=m(a(16)),p=m(a(12)),f=m(a(3)),h=m(a(26));function m(e){return e&&e.__esModule?e:{default:e}}var v={create:function(e){r.default.dispatch({actionType:i.default.EXPLORER_CREATE,attrs:e})},createBatch:function(e){r.default.dispatch({actionType:i.default.EXPLORER_CREATE_BATCH,models:e})},clone:function(e){r.default.dispatch({actionType:i.default.EXPLORER_CLONE,id:e}),o.default.create({text:"Query cloned! Add a name for this cloned query and save it.",type:"success",icon:"check"})},update:function(e,t){var a,l=d.default.getProject();r.default.dispatch({actionType:i.default.EXPLORER_UPDATE,id:e,updates:t}),(a=t.query?t.query:t.response&&t.response.query?t.response.query:{}).event_collection&&c.default.fetchCollectionSchema(l.client,a.event_collection),a.steps&&a.steps.length&&n.default.each(a.steps,function(e,t){c.default.fetchCollectionSchema(l.client,e.event_collection)})},remove:function(e){r.default.dispatch({actionType:i.default.EXPLORER_REMOVE,id:e})},setActive:function(e){r.default.dispatch({actionType:i.default.EXPLORER_SET_ACTIVE,id:e})},revertActiveChanges:function(){r.default.dispatch({actionType:i.default.EXPLORER_REVERT_ACTIVE_CHANGES})},clear:function(e){r.default.dispatch({actionType:i.default.EXPLORER_CLEAR,id:e})},validate:function(e){r.default.dispatch({actionType:i.default.EXPLORER_VALIDATE,id:e})},addFilter:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_ADD_FILTER,id:e,attrs:t})},removeFilter:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_REMOVE_FILTER,id:e,index:t})},updateFilter:function(e,t,a){r.default.dispatch({actionType:i.default.EXPLORER_UPDATE_FILTER,id:e,index:t,attrs:a})},addStep:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_ADD_STEP,id:e,attrs:t})},removeStep:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_REMOVE_STEP,id:e,index:t})},setStepActive:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_SET_STEP_ACTIVE,id:e,index:t})},updateStep:function(e,t,a){var n=d.default.getProject();r.default.dispatch({actionType:i.default.EXPLORER_UPDATE_STEP,id:e,index:t,attrs:a}),a.event_collection&&c.default.fetchCollectionSchema(n.client,a.event_collection)},moveStep:function(e,t,a){r.default.dispatch({actionType:i.default.EXPLORER_MOVE_STEP,id:e,index:t,direction:a})},addStepFilter:function(e,t,a){r.default.dispatch({actionType:i.default.EXPLORER_ADD_STEP_FILTER,id:e,stepIndex:t,attrs:a})},removeStepFilter:function(e,t,a){r.default.dispatch({actionType:i.default.EXPLORER_REMOVE_STEP_FILTER,id:e,stepIndex:t,filterIndex:a})},updateStepFilter:function(e,t,a,n){r.default.dispatch({actionType:i.default.EXPLORER_UPDATE_STEP_FILTER,id:e,stepIndex:t,filterIndex:a,attrs:n})},exec:function(e,t){var a=l.default.get(t);if(a.loading)throw new Error("Warning: calling exec when model loading is true. Explorer id: "+a.id);v.validate(a.id),(a=l.default.get(t)).isValid?(o.default.clearAll(),r.default.dispatch({actionType:i.default.EXPLORER_UPDATE,id:a.id,updates:{loading:!0}}),f.default.runQuery({client:e,query:f.default.queryJSON(a),error:v.execError.bind(this,a),success:v.execSuccess.bind(this,a)})):r.default.dispatch({actionType:i.default.EXPLORER_FOUND_INVALID,id:a.id})},execError:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_QUERY_ERROR,query:e.query,error:t.message}),v.update(e.id,{loading:!1}),o.default.create({text:t.message,type:"error"})},execSuccess:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_QUERY_SUCCESS,query:e.query,isSaved:f.default.isPersisted(e)}),o.default.clearAll();var a={};a.response=t,t.query||(t.query=f.default.queryJSON(e)),a.loading=!1,h.default.responseSupportsChartType(t.query,e.metadata.visualization.chart_type)||(a.metadata=n.default.cloneDeep(e.metadata),a.metadata.visualization.chart_type=h.default.getChartTypeOptions(t.query)[0]),a.dataTimestamp=Date.now(),v.update(e.id,a)},runEmailExtraction:function(e,t){v.validate(t);var a=l.default.get(t);a.isValid?(o.default.clearAll(),r.default.dispatch({actionType:i.default.EXPLORER_UPDATE,id:a.id,updates:{loading:!0}}),f.default.runQuery({client:e,query:f.default.queryJSON(a),success:v.runEmailExtractionSuccess.bind(this,a),error:v.runEmailExtractionError})):r.default.dispatch({actionType:i.default.EXPLORER_FOUND_INVALID,id:a.id})},runEmailExtractionSuccess:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_QUERY_SUCCESS,query:e.query,isSaved:f.default.isPersisted(e)}),o.default.clearAll(),o.default.create({text:"Email extraction successfully requested. Check your email ("+e.query.email+").",type:"success",icon:"check"}),v.update(e.id,{result:t,loading:!1})},runEmailExtractionError:function(e){o.default.create({text:e.message,type:"error",icon:"remove-sign"})},fetchAllPersisted:function(e,t){u.default.update({fetchingPersistedExplorers:!0}),e.get(null,function(e,a){if(e)t(e);else{var n=[];a.forEach(function(e){var t=f.default.formatQueryParams(e);p.default.run(s.default,t),t.isValid||(console.warn("A persisted explorer model is invalid: ",t),console.log("Errors: ",t.errors)),n.push(t)}),v.createBatch(n),u.default.update({fetchingPersistedExplorers:!1}),t(null)}})},fetchPersisted:function(e,t,a){e.get(t,function(e,t){if(e)a(e);else{var n=f.default.formatQueryParams(t);p.default.run(s.default,n),n.isValid||console.warn("A persisted explorer model is invalid: ",n),v.create(n),a(null)}})},save:function(e,t){var a=f.default.saveType(l.default.get(t)),n="save"===a?"create":"update";r.default.dispatch({actionType:i.default.EXPLORER_SAVING,id:t,saveType:a});var s=l.default.get(t);if(!s.isValid)return r.default.dispatch({actionType:i.default.EXPLORER_FOUND_INVALID,id:s.id}),void v.update(t,{saving:!1});o.default.clearAll();var u=f.default.cleanJSONforSave(f.default.toJSON(l.default.get(t)));e[n](u,function(e,n){e?r.default.dispatch({actionType:i.default.EXPLORER_SAVE_FAIL,saveType:a,id:t,errorResp:e,query:l.default.get(t).query}):v.saveSuccess(t,n)})},saveSuccess:function(e,t){var a=f.default.saveType(l.default.get(e)),n=f.default.mergeResponseWithExplorer(l.default.get(e),t);r.default.dispatch({actionType:i.default.EXPLORER_UPDATE,id:e,updates:n}),r.default.dispatch({actionType:i.default.EXPLORER_SAVE_SUCCESS,id:n.id,saveType:a,query:n.query})},destroy:function(e,t){r.default.dispatch({actionType:i.default.EXPLORER_DESTROYING});var a=n.default.clone(f.default.toJSON(l.default.get(t)));e.destroy(a,function(e,n){e?r.default.dispatch({actionType:i.default.EXPLORER_DESTROY_FAIL,errorMsg:e,query:l.default.get(t).query}):(r.default.dispatch({actionType:i.default.EXPLORER_REMOVE,id:t}),r.default.dispatch({actionType:i.default.EXPLORER_DESTROY_SUCCESS,query:a.query}))})}};t.default=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r(a(0));var n=r(a(80));r(a(2));function r(e){return e&&e.__esModule?e:{default:e}}var i={DEFAULT_TIMEZONE:"UTC",ANALYSIS_TYPES:["sum","count","count_unique","minimum","maximum","average","select_unique","extraction","percentile","median","funnel"],ABSOLUTE_INTERVAL_TYPES:[{name:"minutely",value:"minutely"},{name:"hourly",value:"hourly"},{name:"daily",value:"daily"},{name:"weekly",value:"weekly"},{name:"monthly",value:"monthly"},{name:"yearly",value:"yearly"}],RELATIVE_INTERVAL_TYPES:[{name:"minutes",value:"minutes"},{name:"hours",value:"hours"},{name:"days",value:"days"},{name:"weeks",value:"weeks"},{name:"months",value:"months"},{name:"years",value:"years"}],TIMEZONES:[{name:"UTC",offset:0,dst_offset:0},{name:"Europe/London",offset:0,dst_offset:3600},{name:"Africa/Casablanca",offset:0,dst_offset:0},{name:"Africa/Nairobi",offset:10800,dst_offset:0},{name:"Asia/Dubai",offset:14400,dst_offset:0},{name:"America/Sao_Paulo",offset:-10800,dst_offset:-7200},{name:"US/Eastern",offset:-18e3,dst_offset:-14400},{name:"US/Central",offset:-21600,dst_offset:-18e3},{name:"US/Mountain",offset:-25200,dst_offset:-21600},{name:"US/Pacific",offset:-28800,dst_offset:-25200},{name:"US/Alaska",offset:-32400,dst_offset:-28800},{name:"US/Hawaii",offset:-36e3,dst_offset:-32400},{name:"Europe/Paris",offset:3600,dst_offset:7200},{name:"Europe/Amsterdam",offset:3600,dst_offset:7200},{name:"Europe/Stockholm",offset:3600,dst_offset:7200},{name:"Europe/Prague",offset:3600,dst_offset:7200},{name:"Asia/Istanbul",offset:7200,dst_offset:10800},{name:"Europe/Istanbul",offset:7200,dst_offset:10800},{name:"Europe/Copenhagen",offset:3600,dst_offset:7200},{name:"Asia/Jakarta",offset:25200,dst_offset:25200},{name:"Asia/Singapore",offset:28800,dst_offset:28800},{name:"Australia/Perth",offset:28800,dst_offset:28800},{name:"Asia/Tokyo",offset:32400,dst_offset:32400},{name:"Australia/Sydney",offset:36e3,dst_offset:39600},{name:"Pacific/Auckland",offset:43200,dst_offset:46800}],FILTER_OPERATORS:[{name:"= Equal to",value:"eq",canBeCoeredTo:["String","Number","Null","List","Boolean","Datetime"]},{name:"≠ Not equal to",value:"ne",canBeCoeredTo:["String","Number","Null","List","Boolean","Datetime"]},{name:"> Greater than",value:"gt",canBeCoeredTo:["Number","Null","Datetime","String"]},{name:"≥ Greater than or equal to",value:"gte",canBeCoeredTo:["Number","Null","Datetime","String"]},{name:"< Less than",value:"lt",canBeCoeredTo:["Number","Null","Datetime","String"]},{name:"≤ Less than or equal to",value:"lte",canBeCoeredTo:["Number","Null","Datetime","String"]},{name:"∃ Property exists",value:"exists",canBeCoeredTo:["Boolean"]},{name:"⊚ String contains",value:"contains",canBeCoeredTo:["String","Null"]},{name:"⍉ String does not contain",value:"not_contains",canBeCoeredTo:["String","Null"]},{name:"⧇ Matches any value in a list",value:"in",canBeCoeredTo:["List"]},{name:"⚐ Within a given radius (geo)",value:"within",canBeCoeredTo:["Geo"]}]},l={getConstant:function(e){return i[e]},eventsUrl:function(e){return e.url("events",{api_key:e.config.masterKey})},getEventCollectionPropertyNames:function(e,t){return e.schema[t]?e.schema[t].sortedProperties:[]},getPropertyType:function(e,t,a){return(t=e.schema[t])?t.properties[a]:null},getLocalTimezoneOffset:function(e){return-1*(new Date).getTimezoneOffset()*60},getLocalTimezone:function(e){var t=n.default.isDST(),a=l.getLocalTimezoneOffset(),r=i.TIMEZONES.filter(function(e){return t?e.dst_offset===a:e.offset===a});return r.length?r[0].name:a}};t.default=l},function(e,t){e.exports=a},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(79);t.default=new n.Dispatcher},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(0)),r=o(a(9)),i=(o(a(44)),o(a(17)),o(a(2))),l=o(a(30)),s=o(a(12));function o(e){return e&&e.__esModule?e:{default:e}}function u(e){return!n.default.isNull(e)&&!n.default.isUndefined(e)}var c={coercionFunctions:{Datetime:function(e){if("string"==typeof e.property_value){var t=new Date(e.property_value);if(null!==t&&"Invalid Date"!==t.toString())return t.toString()}return c.defaultDate()},String:function(e){return u(e.property_value)?e.property_value.toString():null},Number:function(e){if(!u(e.property_value))return null;var t=parseFloat(e.property_value);return(void 0===t||null===t||isNaN(t))&&(t=""),t},Boolean:function(e){return!("false"===e.property_value||!1===e.property_value)},Null:function(e){return null},Geo:function(e){return e.property_value},List:function(e){return e.property_value}},defaultDate:function(){var e=(0,r.default)().subtract(1,"days").startOf("day").format("x");return new Date(Number(e))},getCoercedValue:function(e){return c.coercionFunctions[e.coercion_type]?c.coercionFunctions[e.coercion_type](e):null},getCoercionType:function(e){switch(a=e.property_value,{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case"object":return"Geo";case"string":return"exists"===e.operator?"Boolean":["false","true"].indexOf(e.property_value)>-1?"Boolean":(t=e.property_value,isNaN(t)||-1!==["contains","not_contains"].indexOf(e.operator)?i.default.isDateInStrictFormat(e.property_value.substring(0,e.property_value.length-6))?"Datetime":i.default.isList(e.property_value)?"List":"String":"Number");case"array":return"List";case"boolean":return"Boolean";case"number":return"Number";case"null":return"Null"}var t,a},isComplete:function(e){for(var t=["property_name","property_value","operator","coercion_type"],a=!0,r=0;r<t.length;r++){var i=e[t[r]];if(a=!n.default.isUndefined(i)&&!n.default.isNull(i),n.default.isObject(i)&&(a=!n.default.isEmpty(i)),!a)break}return a},queryJSON:function(e){if(s.default.run(l.default,e),!e.isValid)return{};var t=n.default.cloneDeep(e);return t.property_value=c.getCoercedValue(e),"Datetime"===t.coercion_type&&(t.property_value=i.default.formatISOTimeNoTimezone(t.property_value)),"List"===t.coercion_type&&(t.property_value=i.default.parseList(t.property_value)),n.default.pick(t,["property_name","operator","property_value"])},initList:function(e){var t="";return n.default.each(e.property_value,function(a,r){n.default.isString(a)&&(t+='"'+a+'"'),n.default.isNumber(a)&&(t+="'"+a+"'"),r!==e.property_value.length-1&&(t+=", ")}),e.property_value=t,e},formatFilterParams:function(e){return e.coercion_type=c.getCoercionType(e),"List"===e.coercion_type&&(e=n.default.assign({},e,c.initList(e))),e.property_value=c.getCoercedValue(e),"Datetime"===e.coercion_type&&(e.property_value=i.default.convertDateToUTC(new Date(e.property_value))),e},coerceGeoValue:function(e){var t=e.match(/\.+$/);return"-"===e||t&&t.length?e:parseFloat(e)||0},validFilters:function(e){return n.default.filter(e,function(e){return s.default.run(l.default,e),e.isValid})}};t.default=c},function(e,t){e.exports=n},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=l(a(1)),i=l(a(0));function l(e){return e&&e.__esModule?e:{default:e}}var s=r.default.createClass({displayName:"ReactSelect",getDefaultProps:function(){return{items:[],wrapClasses:"",inputClasses:"",placeholder:"",handleBlur:function(){},handleChange:function(){},handleSelection:function(){}}},getInitialState:function(){return{focusedItem:"",limit:30,initialFocus:!1,selectedItem:0,visible:!1,visibleItems:0}},resetState:function(){this.setState({focusedItem:"",limit:30,selectedItem:0,visible:!1,initialFocus:!0})},handleClick:function(e){this.setState({visible:!0}),this.handleItemFocus()},handleChange:function(e){var t={initialFocus:!1};this.state.visible?(t.limit=30,t.selectedItem=0,this.refs.scrollpane.scrollTop=0):t.visible=!0,this.setState(t),this.props.handleChange(this.props.name,this.refs.input.value)},handleFocus:function(e){this.state.visible?this.resetState():this.setState({initialFocus:!0,visible:!0})},handleBlur:function(e){this.refs.scrollpane&&e.relatedTarget!==this.refs.scrollpane&&(this.state.visible||e.preventDefault(),this.resetTimeout=setTimeout(this.resetState,100),this.blurTimeout=setTimeout(this.props.handleBlur(e),100))},handleItemFocus:function(){clearTimeout(this.resetTimeout),clearTimeout(this.blurTimeout)},handleItemSelection:function(e){if(n(this.props.items[e])){var t=String(this.props.items[e]);this.setState({initialFocus:!1}),this.refs.input.focus(),this.resetState(),this.props.handleChange(this.props.name,t),this.props.handleSelection(this.props.name,t)}},handleKeyDown:function(e){var t,a;"Tab"!==e.key&&"Shift"!==e.key&&(this.setState({visible:!0}),this.refs.list&&this.state.selectedItem&&(a=(t=this.refs.list.children[this.state.selectedItem].scrollHeight+1)*this.state.selectedItem),this.keyDownCallbacks[e.key]&&this.keyDownCallbacks[e.key].call(this,e,t,a))},keyDownCallbacks:{ArrowUp:function(e,t,a){var n={},r=this.refs.list;this.state.selectedItem-1>=0?(n.selectedItem=this.state.selectedItem-1,r&&(n.focusedItem=r.children[this.state.selectedItem-1].innerHTML)):(n.selectedItem=0,r&&(n.focusedItem=r.children[0].innerHTML)),this.setState(n),r&&a>3*t&&(this.refs.scrollpane.scrollTop-=t),e.preventDefault()},ArrowDown:function(e,t,a){var n={},r=this.refs.list;this.state.selectedItem+1<this.visibleItems?(n.selectedItem=this.state.selectedItem+1,r&&(n.focusedItem=this.refs.list.children[this.state.selectedItem+1].innerHTML)):(n.selectedItem=this.visibleItems-1,r&&(n.focusedItem=r.children[this.visibleItems-1].innerHTML)),this.setState(n),r&&a>3*t&&(this.refs.scrollpane.scrollTop+=t),e.preventDefault()},Enter:function(e,t,a){var n=this.refs.list;if(n){var r=n.children[this.state.selectedItem];r&&this.handleItemSelection(r.getAttribute("data-index"))}else this.resetState();e.preventDefault()},Escape:function(e,t,a){this.handleBlur(e),e.preventDefault()}},handleScroll:function(e){var t=this.refs.scrollpane;t.scrollHeight-t.scrollTop-200<50&&this.setState({limit:this.state.limit+30})},appendListItems:function(e){var t=this;return e.forEach(function(e,a){t.props.items.push(e)}),this.forceUpdate(),this},insertListItems:function(e,t){return this.props.items.splice.apply(this.props.items,[e,0].concat(t)),this.forceUpdate(),this},removeListItems:function(){return this.props.items=[],this.forceUpdate(),this},getItems:function(){var e=this,t=0;this.visibleItems=0;var a=this.state.initialFocus?"":this.props.value||"";return this.props.items.map(function(n,l){if(!(a.length>0&&String(n).toLowerCase().search(i.default.escapeRegExp(a).toLowerCase())<0||++t>e.state.limit))return e.visibleItems=e.visibleItems+1,r.default.createElement("li",{className:e.state.selectedItem===t-1?"react-select-item active":"react-select-item",key:l,"data-index":l,onMouseDown:e.handleItemSelection.bind(e,l),onFocus:e.handleItemFocus.bind(e,l),"aria-live":"polite",role:"option"},n)})},getScrollPane:function(e){if(this.state.visible)return r.default.createElement("div",{ref:"scrollpane",className:"react-select-scrollpane",onScroll:this.handleScroll,tabIndex:"-1","aria-hidden":"false"},r.default.createElement("div",{className:"react-select-aria-notice","aria-live":"assertive"},this.state.focusedItem||""),r.default.createElement("ul",{ref:"list",className:"react-select-list","aria-atomic":"false","aria-label":"Begin typing to filter options, or key up or down to browse available options","aria-live":"assertive","aria-relevant":"additions",role:"listbox",id:this.props.id+"-scrollpane"},e))},render:function(){var e=this.getItems(),t=this.getScrollPane(e),a="react-select";this.props.wrapClasses&&(a=a+" "+this.props.wrapClasses),this.state.visible&&(a+=" visible");var n="react-select-input";return this.props.inputClasses&&(n=n+" "+this.props.inputClasses),r.default.createElement("div",{ref:"wrapper",className:a},r.default.createElement("input",{ref:"input",name:this.props.name,className:n,value:this.props.value||"",placeholder:this.props.placeholder,onClick:this.handleClick,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,"aria-expanded":this.state.visible,"aria-owns":this.props.id+"-scrollpane","aria-label":this.props.title||"Select value","aria-selected":!(!this.props.value||!this.props.value.length)||void 0,"aria-live":"polite",autoComplete:"off"}),t)}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(7)),r=a(21),i=h(a(0)),l=h(a(19)),s=h(a(2)),o=h(a(3)),u=h(a(8)),c=h(a(5)),d=h(a(16)),p=h(a(12)),f=h(a(25));h(a(30)),h(a(38));function h(e){return e&&e.__esModule?e:{default:e}}var m=["event_collection","time","timezone","filters"],v={};function y(){return{id:s.default.generateTempId(),query_name:null,active:!1,saving:!1,dataTimestamp:null,response:null,loading:!1,isValid:!0,errors:[],refresh_rate:0,query:{event_collection:null,analysis_type:null,target_property:null,percentile:null,group_by:[],interval:null,timezone:c.default.getLocalTimezone(),filters:[],steps:[],email:null,latest:null,property_names:[],time:{relativity:"this",amount:14,sub_timeframe:"days"}},metadata:{display_name:null,visualization:{chart_type:null}}}}function g(){return{event_collection:null,actor_property:null,time:{relativity:"this",amount:14,sub_timeframe:"days"},timezone:c.default.getLocalTimezone(),filters:[],optional:!1,inverted:!1,with_actors:!1,active:!1,isValid:!0,errors:[]}}function E(e){p.default.run(f.default,v[e])}function _(e,t){var a=i.default.mergeWith({},e,i.default.omit(t,"response"),function(e,t,a){return i.default.isArray(e)?t:"time"===a&&i.default.isPlainObject(e)?t:void 0});return t.response&&(a.response=t.response),t.query&&t.query.event_collection&&t.query.event_collection!==e.query.event_collection&&(a.query.property_names=[]),"funnel"===a.query.analysis_type&&"funnel"!==e.query.analysis_type?a=function(e,t){var a=g();a.active=!0,i.default.each(m,function(n){i.default.isUndefined(e.query[n])||i.default.isNull(e.query[n])||(a[n]=e.query[n]),t.query[n]="filters"===n?[]:null}),i.default.isUndefined(e.query.target_property)||i.default.isNull(e.query.target_property)||(a.actor_property=e.query.target_property,e.query.target_property=null);return t.query.steps=[a],t}(e,a):"funnel"!==a.query.analysis_type&&"funnel"===e.query.analysis_type&&(a=function(e,t){if(e.query.steps.length<1)return t;var a=i.default.find(e.query.steps,{active:!0})||e.query.steps[0];i.default.each(m,function(e){i.default.isUndefined(a[e])||(t.query[e]=a[e])}),!i.default.isNull(a.actor_property)&&o.default.shouldHaveTarget(t)&&(t.query.target_property=a.actor_property);return t.query.steps=[],t}(e,a)),a=function(e){o.default.isEmailExtraction(e)||(e.query.latest=null,e.query.email=null);"extraction"===e.query.analysis_type&&(e.query.group_by=null,e.query.interval=null);"extraction"!==e.query.analysis_type&&(e.query.latest=null);"percentile"!==e.query.analysis_type&&(e.query.percentile=null);i.default.includes(["count","extraction","funnel"],e.query.analysis_type)&&(e.query.target_property=null);"funnel"!==e.query.analysis_type&&(e.query.steps=[]);"funnel"===e.query.analysis_type&&(e.query.filters=[],e.query.time=null,e.query.timezone=null,e.query.group_by=null,e.query.timeframe=null,e.query.interval=null);return e}(a)}function b(e,t,a){if(a.property_name&&a.property_name!==t.property_name)"exists"===t.operator?a.coercion_type="Boolean":a.coercion_type=function(e,t){var a=c.default.getPropertyType(d.default.getProject(),e.query.event_collection,t.property_name);return s.default.coercionTypeForPropertyType(a)}(e,i.default.merge({},t,a));else if(a.operator&&a.operator!==t.operator){var n=a.operator;"in"===n&&(a.coercion_type="List"),"exists"===n&&(a.coercion_type="Boolean"),"within"===n&&(a.coercion_type="Geo");var r=i.default.find(c.default.getConstant("FILTER_OPERATORS"),{value:a.operator}).canBeCoeredTo,l=a.coercion_type||t.coercion_type;i.default.includes(r,l)||(a.coercion_type=r[0])}return"Geo"===a.coercion_type&&"Geo"!==t.coercion_type&&(a.property_value={coordinates:[],max_distance_miles:null}),a.property_value=u.default.getCoercedValue(i.default.merge({},t,a)),a}function C(e){return i.default.isArray(e)||(e=[e]),i.default.pull(e,null)}function T(e){if(e&&!0===e.active)throw new Error("You must use setActive to set a model as active.");e=e||{};var t=i.default.merge(y(),e);return t.query.steps&&(t.query.steps=i.default.map(t.query.steps,function(e){return i.default.merge(g(),e)})),t.metadata||(t.metadata={display_name:null,visualization:{chart_type:null}}),t.query.group_by=C(t.query.group_by),t.query.percentile=parseFloat(t.query.percentile)||null,v[t.id]=t,t.id}function S(e,t){if(t&&!0===t.active&&!v[e].active)throw new Error("You must use setActive to set a model as active.");var a=_(v[e],t);return a.query.group_by=C(a.query.group_by),a.query.percentile=parseFloat(a.query.percentile)||null,t.id&&t.id!==e?(v[t.id]=a,delete v[e],t.id):(v[e]=a,e)}function P(e){i.default.each(v,function(e,t){e.active=!1,delete e.originalModel}),v[e].active=!0,v[e].originalModel=i.default.cloneDeep(v[e])}function N(e,t){v[e].query.steps.forEach(function(e){e.active=!1}),v[e].query.steps[t].active=!0}var k=i.default.assign({},r.EventEmitter.prototype,{unregisterWithDispatcher:function(){n.default.unregister(this.dispatchToken)},clearAll:function(){v={}},set:function(e){v[e.id]=e},get:function(e){return v[e]},getActive:function(){return i.default.find(v,{active:!0})},getAll:function(){return v},getLast:function(){var e=i.default.keys(v);return v[e[e.length-1]]},getAllPersisted:function(){return i.default.filter(v,function(e){return o.default.isPersisted(e)})},emitChange:function(){this.emit("change")},addChangeListener:function(e){this.on("change",e)},removeChangeListener:function(e){this.removeListener("change",e)}});k.dispatchToken=n.default.register(function(e){function t(e){e&&E(e),k.emitChange()}switch(e.actionType){case l.default.EXPLORER_CREATE:T(e.attrs),t();break;case l.default.EXPLORER_CREATE_BATCH:e.models.forEach(function(e){v[e.id]?S(e.id,e):T(e)}),t();break;case l.default.EXPLORER_CLONE:var a=k.get(e.id);T({query:i.default.cloneDeep(a.query),metadata:{display_name:null,visualization:{chart_type:i.default.cloneDeep(a.metadata.visualization.chart_type)}}}),t();break;case l.default.EXPLORER_UPDATE:t(S(e.id,e.updates));break;case l.default.EXPLORER_REMOVE:var n=!0===v[e.id].active;if(function(e){delete v[e]}(e.id),n)P(T());t();break;case l.default.EXPLORER_SET_ACTIVE:P(e.id),t(e.id);break;case l.default.EXPLORER_REVERT_ACTIVE_CHANGES:t((r=i.default.find(v,{active:!0}),s=v[r.id].originalModel,v[r.id]=i.default.assign({},s,{originalModel:s,response:r.response}),r.id));break;case l.default.EXPLORER_CLEAR:!function(e){var t=v[e];v[e]=i.default.assign({},y(),i.default.pick(t,["id","query_name","active","metadata","originalModel"]))}(e.id),t();break;case l.default.EXPLORER_SAVING:S(e.id,{saving:!0}),t(e.id);break;case l.default.EXPLORER_SAVE_SUCCESS:case l.default.EXPLORER_SAVE_FAIL:S(e.id,{saving:!1}),t(e.id);break;case l.default.EXPLORER_ADD_FILTER:!function(e,t){t=t||{},v[e].query.filters.push(i.default.assign({property_name:null,property_value:null,operator:"eq",coercion_type:"String",isValid:!0,errors:[]},t))}(e.id,e.attrs),t(e.id);break;case l.default.EXPLORER_REMOVE_FILTER:!function(e,t){v[e].query.filters.splice(t,1)}(e.id,e.index),t(e.id);break;case l.default.EXPLORER_UPDATE_FILTER:!function(e,t,a){var n=v[e].query.filters[t];a=b(v[e],n,a),v[e].query.filters[t]=i.default.assign({},n,a),"Null"===v[e].query.filters[t].coercion_type&&(v[e].query.filters[t].property_value=null)}(e.id,e.index,e.attrs),t(e.id);break;case l.default.EXPLORER_ADD_STEP:!function(e,t){var a=v[e];if("funnel"!==a.query.analysis_type)throw new Error("Error: Attempting to add a step to a non-funnel query. Explorer id: "+a.id);var n=i.default.assign(g(),t||{});if(n.active=!0,a.query.steps.length>0){var r=a.query.steps[a.query.steps.length-1];n.time=r.time,n.timezone=r.timezone}a.query.steps.push(n),N(e,a.query.steps.length-1)}(e.id,e.attrs),t(e.id);break;case l.default.EXPLORER_REMOVE_STEP:!function(e,t){v[e].query.steps.splice(t,1),t>v[e].query.steps.length-1?N(e,v[e].query.steps.length-1):N(e,t)}(e.id,e.index),t(e.id);break;case l.default.EXPLORER_UPDATE_STEP:!function(e,t,a){var n=v[e].query.steps[t];v[e].query.steps[t]=i.default.assign({},n,a)}(e.id,e.index,e.attrs),t(e.id);break;case l.default.EXPLORER_SET_STEP_ACTIVE:N(e.id,e.index),t(e.id);break;case l.default.EXPLORER_MOVE_STEP:!function(e,t,a){var n=i.default.cloneDeep(v[e].query.steps);if("up"===a){if(0===t)return;var r=n[t-1],l=n[t];n[t-1]=l,n[t]=r}if("down"===a){if(t===n.length-1)return;r=n[t+1],l=n[t],n[t+1]=l,n[t]=r}v[e].query.steps=n}(e.id,e.index,e.direction),t(e.id);break;case l.default.EXPLORER_ADD_STEP_FILTER:!function(e,t,a){a=a||{},v[e].query.steps[t].filters.push(i.default.assign({property_name:null,property_value:null,operator:"eq",coercion_type:"String",isValid:!0,errors:[]},a))}(e.id,e.stepIndex,e.attrs),t(e.id);break;case l.default.EXPLORER_REMOVE_STEP_FILTER:!function(e,t,a){v[e].query.steps[t].filters.splice(a,1)}(e.id,e.stepIndex,e.filterIndex),t(e.id);break;case l.default.EXPLORER_UPDATE_STEP_FILTER:!function(e,t,a,n){var r=v[e].query.steps[t].filters[a];n=b(v[e],r,n),v[e].query.steps[t].filters[a]=i.default.assign({},r,n),"Null"===v[e].query.steps[t].filters[a].coercion_type&&(v[e].query.steps[t].filters[a].property_value=null)}(e.id,e.stepIndex,e.filterIndex,e.attrs),t(e.id);break;case l.default.EXPLORER_VALIDATE:E(e.id),t();break;case l.default.EXPLORER_FOUND_INVALID:!function(e){var t=v[e];"funnel"===t.query.analysis_type&&t.query.steps.forEach(function(t,a){t.isValid||N(e,a)})}(e.id),t()}var r,s;return!0}),t.default=k},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={run:function(e,t){var a=Object.keys(e);t.isValid=!0,t.errors=[];for(var n=0;n<a.length;n++){var r=e[a[n]];if(!r.shouldRun||r.shouldRun(t)){var i=r.validate(t);!0!==i&&(t.isValid=!1,t.errors.push({attribute:a[n],msg:!1===i?r.msg:i}))}}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(1));r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}var i=n.default.createClass({displayName:"InputComponent",_onChange:function(e){this.setState({value:e.target.value}),this.props.onChange(e)},getDefaultProps:function(){return{classes:"form-group",inputClasses:"",type:"text",placeholder:"",readonly:!1,onChange:function(){}}},getInitialState:function(){return{value:this.props.value||""}},componentWillReceiveProps:function(e){this.setState({value:e.value})},render:function(){var e=this.props.required?n.default.createElement("small",null,"(required)"):null,t=this.props.label?n.default.createElement("label",{htmlFor:this.props.name},this.props.label," ",e):null,a="form-control";return this.props.inputClasses&&(a=a+" "+this.props.inputClasses),n.default.createElement("div",{className:this.props.classes},t,n.default.createElement("input",{ref:"input",type:this.props.type,name:this.props.name,className:a,placeholder:this.props.placeholder,onChange:this._onChange,onBlur:this.props.onBlur,value:this.state.value,readOnly:this.props.readonly,autoComplete:"off"}))}});t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(6)),i=l(a(0));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"FieldsToggle",handleFieldsToggle:function(e){var t=this.props.attrsToStore,a={};i.default.isArray(t)||(t=[t]),i.default.each(t,function(t){if(e)this._storedAttrs[t]&&(a[t]=this._storedAttrs[t]);else{this._storedAttrs[t]=this.props.getFn(t);var n=this.props.resetValues[t]||null;a[t]=n}}.bind(this)),this.props.updateFn(a)},toggleButtonClick:function(e){e.preventDefault(),this.toggle()},toggle:function(){var e;null===this.props.fieldsCount&&(e=!this.state.open,this.setState({open:e}),this.handleFieldsToggle(e)),this.props.toggleCallback(e||null)},componentWillMount:function(){this._storedAttrs={}},getDefaultProps:function(){return{toggleCallback:function(){},initialOpenState:!1,fieldsCount:null,resetValues:{}}},getInitialState:function(){return{open:!!this.props.initialOpenState}},componentWillReceiveProps:function(e){!this.props.initialOpenState&&e.initialOpenState&&this.setState({open:!0})},render:function(){var e,t=this.props.fieldsCount?this.props.fieldsCount:null,a=(0,r.default)({"has-fields-count":t,open:this.state.open&&null===t,"fields-toggle":!0});return this.props.children&&(e=n.default.createElement("div",{className:"toggle-body"},this.props.children)),n.default.createElement("div",{className:a},n.default.createElement("a",{href:"#",className:"toggle-label",onClick:this.toggleButtonClick,ref:"toggle-label"},n.default.createElement("h5",{ref:"name"},this.props.name),n.default.createElement("button",{type:"button",className:"toggle-button"},n.default.createElement("span",{className:"icon",ref:"icon"},t))),e)}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(0));function i(e){return e&&e.__esModule?e:{default:e}}var l=n.default.createClass({displayName:"SelectComponent",buildOptions:function(){return this.state.options.length?this.state.options.map(function(e){return n.default.createElement("option",{value:e.value,key:e.value,disabled:e.disabled||!1},e.name)}):null},wrapValuesInObjects:function(e){return r.default.isObject(e[0])?e:r.default.map(e,function(e){return{name:e,value:e}})},sortOptions:function(e){return e.sort(function(e,t){var a=e.name.toLowerCase(),n=t.name.toLowerCase();return a<n?-1:a>n?1:0})},buildEmptyOption:function(){var e=this.props.emptyOption;return!0===e?n.default.createElement("option",{value:""}):e?n.default.createElement("option",{value:""},e):null},setupOptions:function(e){var t=this.wrapValuesInObjects(e);return this.props.sort&&(t=this.sortOptions(t)),t},getDefaultProps:function(){return{classes:"form-group",sort:!0,emptyOption:!0,reference:"select",handleSelection:function(){},handleBlur:function(){},options:[]}},componentWillReceiveProps:function(e){this.setState({options:this.setupOptions(e.options)})},getInitialState:function(){return{options:this.setupOptions(this.props.options)}},render:function(){var e=this.buildOptions(),t=this.props.label?n.default.createElement("label",{htmlFor:this.props.name},this.props.label):null,a=this.buildEmptyOption(),r=this.props.multiple?[]:"",i=this.props.selectedOption?this.props.selectedOption:r;return n.default.createElement("div",{className:this.props.classes},t,n.default.createElement("div",{className:"select-element"},n.default.createElement("select",{ref:this.props.reference,name:this.props.name,value:i,className:"form-control",multiple:this.props.multiple,onChange:this.props.handleSelection,onBlur:this.props.handleBlur,disabled:this.props.disabled},a,e)))}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(7)),r=a(21),i=o(a(0)),l=o(a(43)),s=(o(a(5)),o(a(2)));function o(e){return e&&e.__esModule?e:{default:e}}var u={};var c=i.default.assign({},r.EventEmitter.prototype,{unregisterWithDispatcher:function(){n.default.unregister(d)},clearAll:function(){u={}},getProject:function(){var e=Object.keys(u);if(e.length)return u[e[0]]},getAll:function(){return u},emitChange:function(){this.emit("change")},addChangeListener:function(e){this.on("change",e)},removeChangeListener:function(e){this.removeListener("change",e)}}),d=n.default.register(function(e){var t,a;switch(e.actionType){case l.default.PROJECT_CREATE:!function(e){var t=s.default.generateTempId();u[t]=i.default.assign({id:null,loading:!0,eventCollections:[],sortedEventCollections:{},schema:{}},{id:t},e)}(e.attrs),c.emitChange();break;case l.default.PROJECT_UPDATE:t=e.id,a=e.updates,u[t]=i.default.assign({},u[t],a),c.emitChange();break;case l.default.PROJECT_UPDATE_EVENT_COLLECTION:!function(e,t,a){var n=i.default.assign({},u[e].schema[t],a);u[e].schema[t]=n}(e.id,e.collectionName,e.updates),c.emitChange()}return!0});t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=s(a(0)),i=s(a(5)),l=s(a(2));function s(e){return e&&e.__esModule?e:{default:e}}var o={timeframeType:function(e){if(r.default.isUndefined(e))return null;if(r.default.isPlainObject(e)){if(r.default.has(e,"start")||r.default.has(e,"end"))return"absolute";if(r.default.has(e,"relativity")&&r.default.has(e,"amount")&&r.default.has(e,"sub_timeframe"))return"relative";throw new Error("Invalid timeframe type: invalid time value.")}throw new Error("Invalid timeframe type: not a plain object.")},getTimezoneOffset:function(e){var t=r.default.find(i.default.getConstant("TIMEZONES"),{value:e});return t?t.offset:"+00:00"},timeframeBuilders:{absolute:function(e){if(e&&e.start&&e.end)return{start:l.default.formatISOTimeNoTimezone(e.start),end:l.default.formatISOTimeNoTimezone(e.end)}},relative:function(e){if(e&&e.relativity&&e.amount&&e.sub_timeframe)return[e.relativity,e.amount,e.sub_timeframe].join("_")}},getTimeframe:function(e){var t=o.timeframeBuilders[o.timeframeType(e)];return void 0===t?"":t(e)},getTimeParameters:function(e,t){return{timeframe:e?o.getTimeframe(e):null,timezone:t||i.default.getConstant("DEFAULT_TIMEZONE")}},unpackTimeframeParam:function(e,t){return"object"===(void 0===e?"undefined":n(e))?o.unpackAbsoluteTimeframe(e,t):"string"==typeof e?o.unpackRelativeTimeframe(e,t):void 0},unpackAbsoluteTimeframe:function(e,t){var a={time:{},timezone:null};t&&i.default.getConstant("TIMEZONES").filter(function(e){return e.name===t}).length?a.timezone=t:a.timezone="UTC";var n=e.start?e.start.substring(0,19):"";a.time.start=l.default.formatISOTimeNoTimezone(n);var r=e.end?e.end.substring(0,19):"";return a.time.end=l.default.formatISOTimeNoTimezone(r),a},unpackRelativeTimeframe:function(e,t){var a=e.split("_");return{time:{relativity:a[0],amount:a[1],sub_timeframe:a[2]},timezone:t}}};t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(7)),r=i(a(37));function i(e){return e&&e.__esModule?e:{default:e}}var l={create:function(e){n.default.dispatch({actionType:r.default.NOTICE_CREATE,attrs:e})},clearAll:function(){n.default.dispatch({actionType:r.default.NOTICE_CLEAR_ALL})}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(20),i=(n=r)&&n.__esModule?n:{default:n};t.default=(0,i.default)({EXPLORER_CREATE:null,EXPLORER_CREATE_BATCH:null,EXPLORER_CLONE:null,EXPLORER_UPDATE:null,EXPLORER_REMOVE:null,EXPLORER_SET_ACTIVE:null,EXPLORER_REVERT_ACTIVE_CHANGES:null,EXPLORER_CLEAR:null,EXPLORER_VALIDATE:null,EXPLORER_FOUND_INVALID:null,EXPLORER_QUERY_SUCCESS:null,EXPLORER_QUERY_ERROR:null,EXPLORER_ADD_FILTER:null,EXPLORER_REMOVE_FILTER:null,EXPLORER_UPDATE_FILTER:null,EXPLORER_ADD_STEP:null,EXPLORER_REMOVE_STEP:null,EXPLORER_UPDATE_STEP:null,EXPLORER_SET_STEP_ACTIVE:null,EXPLORER_MOVE_STEP:null,EXPLORER_ADD_STEP_FILTER:null,EXPLORER_REMOVE_STEP_FILTER:null,EXPLORER_UPDATE_STEP_FILTER:null,EXPLORER_SAVE:null,EXPLORER_SAVE_NEW:null,EXPLORER_DESTROY:null,EXPLORER_SAVING:null,EXPLORER_SAVE_SUCCESS:null,EXPLORER_SAVE_FAIL:null,EXPLORER_DESTROYING:null,EXPLORER_DESTROY_SUCCESS:null,EXPLORER_DESTROY_FAIL:null})},function(e,t){e.exports=r},function(e,t){function a(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function r(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0,a.defaultMaxListeners=10,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},a.prototype.emit=function(e){var t,a,l,s,o,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(i(a=this._events[e]))return!1;if(n(a))switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),a.apply(this,s)}else if(r(a))for(s=Array.prototype.slice.call(arguments,1),l=(u=a.slice()).length,o=0;o<l;o++)u[o].apply(this,s);return!0},a.prototype.addListener=function(e,t){var l;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(l=i(this._maxListeners)?a.defaultMaxListeners:this._maxListeners)&&l>0&&this._events[e].length>l&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},a.prototype.on=a.prototype.addListener,a.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var a=!1;function r(){this.removeListener(e,r),a||(a=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},a.prototype.removeListener=function(e,t){var a,i,l,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(l=(a=this._events[e]).length,i=-1,a===t||n(a.listener)&&a.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(a)){for(s=l;s-- >0;)if(a[s]===t||a[s].listener&&a[s].listener===t){i=s;break}if(i<0)return this;1===a.length?(a.length=0,delete this._events[e]):a.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},a.prototype.removeAllListeners=function(e){var t,a;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(a=this._events[e]))this.removeListener(e,a);else if(a)for(;a.length;)this.removeListener(e,a[a.length-1]);return delete this._events[e],this},a.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},a.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},a.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){e.exports=i},function(e,t,a){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*!
 * pickadate.js v3.5.4, 2014/09/11
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */
!function(r){"object"==n(t)?e.exports=r(a(22)):this.Picker=r(jQuery)}(function(e){var t=e(window),a=e(document),n=e(document.documentElement);function r(t,s,o,u){if(!t)return r;var c=!1,d={id:t.id||"P"+Math.abs(~~(Math.random()*new Date))},p=o?e.extend(!0,{},o.defaults,u):u||{},f=e.extend({},r.klasses(),p.klass),h=e(t),m=function(){return this.start()},v=m.prototype={constructor:m,$node:h,start:function(){return d&&d.start?v:(d.methods={},d.start=!0,d.open=!1,d.type=t.type,t.autofocus=t==document.activeElement,t.readOnly=!p.editable,t.id=t.id||d.id,"text"!=t.type&&(t.type="text"),v.component=new o(v,p),v.$root=e(r._.node("div",y(),f.picker,'id="'+t.id+'_root"')),v.$root.on({focusin:function(e){v.$root.removeClass(f.focused),e.stopPropagation()},"mousedown click":function(a){var n=a.target;n!=v.$root.children()[0]&&(a.stopPropagation(),"mousedown"!=a.type||e(n).is(":input")||"OPTION"==n.nodeName||(a.preventDefault(),t.focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var a=e(this),n=a.data(),r=a.hasClass(f.navDisabled)||a.hasClass(f.disabled),i=document.activeElement;i=i&&(i.type||i.href)&&i,(r||i&&!e.contains(v.$root[0],i))&&t.focus(),!r&&n.nav?v.set("highlight",v.component.item.highlight,{nav:n.nav}):!r&&"pick"in n?v.set("select",n.pick).close(!0):n.clear?v.clear().close(!0):n.close&&v.close(!0)}),l(v.$root[0],"hidden",!0),p.formatSubmit&&function(){var a;!0===p.hiddenName?(a=t.name,t.name=""):a=(a=["string"==typeof p.hiddenPrefix?p.hiddenPrefix:"","string"==typeof p.hiddenSuffix?p.hiddenSuffix:"_submit"])[0]+t.name+a[1];v._hidden=e('<input type=hidden name="'+a+'"'+(h.data("value")||t.value?' value="'+v.get("select",p.formatSubmit)+'"':"")+">")[0],h.on("change."+d.id,function(){v._hidden.value=t.value?v.get("select",p.formatSubmit):""}).after(v._hidden)}(),function(){h.data(s,v).addClass(f.input).val(h.data("value")?v.get("select",p.format):t.value).on("focus."+d.id+" click."+d.id,g),p.editable||h.on("keydown."+d.id,function(e){var t=e.keyCode,a=/^(8|46)$/.test(t);if(27==t)return v.close(),!1;(32==t||a||!d.open&&v.component.key[t])&&(e.preventDefault(),e.stopPropagation(),a?v.clear().close():v.open())});l(t,{haspopup:!0,expanded:!1,readonly:!1,owns:t.id+"_root"+(v._hidden?" "+v._hidden.id:"")})}(),p.container?e(p.container).append(v.$root):h.after(v.$root),v.on({start:v.component.onStart,render:v.component.onRender,stop:v.component.onStop,open:v.component.onOpen,close:v.component.onClose,set:v.component.onSet}).on({start:p.onStart,render:p.onRender,stop:p.onStop,open:p.onOpen,close:p.onClose,set:p.onSet}),c=function(e){var t;e.currentStyle?t=e.currentStyle.position:window.getComputedStyle&&(t=getComputedStyle(e).position);return"fixed"==t}(v.$root.children()[0]),t.autofocus&&v.open(),v.trigger("start").trigger("render"))},render:function(e){return e?v.$root.html(y()):v.$root.find("."+f.box).html(v.component.nodes(d.open)),v.trigger("render")},stop:function(){return d.start?(v.close(),v._hidden&&v._hidden.parentNode.removeChild(v._hidden),v.$root.remove(),h.removeClass(f.input).removeData(s),setTimeout(function(){h.off("."+d.id)},0),t.type=d.type,t.readOnly=!1,v.trigger("stop"),d.methods={},d.start=!1,v):v},open:function(s){return d.open?v:(h.addClass(f.active),l(t,"expanded",!0),setTimeout(function(){v.$root.addClass(f.opened),l(v.$root[0],"hidden",!1)},0),!1!==s&&(d.open=!0,c&&n.css("overflow","hidden").css("padding-right","+="+i()),h.trigger("focus"),a.on("click."+d.id+" focusin."+d.id,function(e){var a=e.target;a!=t&&a!=document&&3!=e.which&&v.close(a===v.$root.children()[0])}).on("keydown."+d.id,function(a){var n=a.keyCode,i=v.component.key[n],l=a.target;27==n?v.close(!0):l!=t||!i&&13!=n?e.contains(v.$root[0],l)&&13==n&&(a.preventDefault(),l.click()):(a.preventDefault(),i?r._.trigger(v.component.key.go,v,[r._.trigger(i)]):v.$root.find("."+f.highlighted).hasClass(f.disabled)||v.set("select",v.component.item.highlight).close())})),v.trigger("open"))},close:function(e){return e&&(h.off("focus."+d.id).trigger("focus"),setTimeout(function(){h.on("focus."+d.id,g)},0)),h.removeClass(f.active),l(t,"expanded",!1),setTimeout(function(){v.$root.removeClass(f.opened+" "+f.focused),l(v.$root[0],"hidden",!0)},0),d.open?(d.open=!1,c&&n.css("overflow","").css("padding-right","-="+i()),a.off("."+d.id),v.trigger("close")):v},clear:function(e){return v.set("clear",null,e)},set:function(t,a,n){var r,i,l=e.isPlainObject(t),s=l?t:{};if(n=l&&e.isPlainObject(a)?a:n||{},t){for(r in l||(s[t]=a),s)i=s[r],r in v.component.item&&(void 0===i&&(i=null),v.component.set(r,i,n)),"select"!=r&&"clear"!=r||h.val("clear"==r?"":v.get(r,p.format)).trigger("change");v.render()}return n.muted?v:v.trigger("set",s)},get:function(e,a){if(null!=d[e=e||"value"])return d[e];if("value"==e)return t.value;if(e in v.component.item){if("string"==typeof a){var n=v.component.get(e);return n?r._.trigger(v.component.formats.toString,v.component,[a,n]):""}return v.component.get(e)}},on:function(t,a,n){var r,i,l=e.isPlainObject(t),s=l?t:{};if(t)for(r in l||(s[t]=a),s)i=s[r],n&&(r="_"+r),d.methods[r]=d.methods[r]||[],d.methods[r].push(i);return v},off:function(){var e,t,a=arguments;for(e=0,namesCount=a.length;e<namesCount;e+=1)(t=a[e])in d.methods&&delete d.methods[t];return v},trigger:function(e,t){var a=function(e){var a=d.methods[e];a&&a.map(function(e){r._.trigger(e,v,[t])})};return a("_"+e),a(e),v}};function y(){return r._.node("div",r._.node("div",r._.node("div",r._.node("div",v.component.nodes(d.open),f.box),f.wrap),f.frame),f.holder)}function g(e){e.stopPropagation(),"focus"==e.type&&v.$root.addClass(f.focused),v.open()}return new m}function i(){if(n.height()<=t.height())return 0;var a=e('<div style="visibility:hidden;width:100px" />').appendTo("body"),r=a[0].offsetWidth;a.css("overflow","scroll");var i=e('<div style="width:100%" />').appendTo(a)[0].offsetWidth;return a.remove(),r-i}function l(t,a,n){if(e.isPlainObject(a))for(var r in a)s(t,r,a[r]);else s(t,a,n)}function s(e,t,a){e.setAttribute(("role"==t?"":"aria-")+t,a)}return r.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},r._={group:function(e){for(var t,a="",n=r._.trigger(e.min,e);n<=r._.trigger(e.max,e,[n]);n+=e.i)t=r._.trigger(e.item,e,[n]),a+=r._.node(e.node,t[0],t[1],t[2]);return a},node:function(t,a,n,r){return a?(a=e.isArray(a)?a.join(""):a,"<"+t+(n=n?' class="'+n+'"':"")+(r=r?" "+r:"")+">"+a+"</"+t+">"):""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,a){return"function"==typeof e?e.apply(t,a||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getUTCDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1==0},ariaAttr:function(t,a){e.isPlainObject(t)||(t={attribute:a});for(var n in a="",t){var r=("role"==n?"":"aria-")+n,i=t[n];a+=null==i?"":r+'="'+t[n]+'"'}return a}},r.extend=function(t,a){e.fn[t]=function(n,i){var l=this.data(t);return"picker"==n?l:l&&"string"==typeof n?r._.trigger(l[n],l,[i]):this.each(function(){e(this).data(t)||new r(this,t,a,n)})},e.fn[t].defaults=a.defaults},r})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(7)),r=i(a(41));function i(e){return e&&e.__esModule?e:{default:e}}var l={update:function(e){n.default.dispatch({actionType:r.default.APP_STATE_UPDATE,updates:e})},reset:function(){n.default.dispatch({actionType:r.default.APP_STATE_RESET})}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s(a(0));var n=s(a(3)),r=s(a(39)),i=s(a(38)),l=s(a(12));function s(e){return e&&e.__esModule?e:{default:e}}function o(e){return"funnel"!==e.query.analysis_type}t.default={analysis_type:{msg:"Choose an Analysis Type.",validate:function(e){return"string"==typeof e.query.analysis_type&&e.query.analysis_type.length>0}},event_collection:{msg:"Choose an Event Collection.",shouldRun:o,validate:function(e){return"string"==typeof e.query.event_collection&&e.query.event_collection.length>0}},target_property:{msg:"Choose a Target Property.",shouldRun:function(e){return n.default.shouldHaveTarget(e)},validate:function(e){return"string"==typeof e.query.target_property&&e.query.target_property.length>0}},percentile_value:{msg:"Choose a Percentile Value.",shouldRun:function(e){return"percentile"===e.query.analysis_type},validate:function(e){return null!==e.query.percentile&&""!==e.query.percentile&&"number"==typeof e.query.percentile}},filters:{shouldRun:o,msg:"One of your filters is invalid.",validate:function(e){return r.default.filters(e.query.filters)}},steps:{msg:"One of your funnel steps is invalid.",shouldRun:function(e){return"funnel"===e.query.analysis_type},validate:function(e){if(!e.query.steps)return!1;for(var t=!0,a=0;a<e.query.steps.length;a++)l.default.run(i.default,e.query.steps[a]),e.query.steps[a].isValid||(t=!1);return t}},time:{shouldRun:o,validate:function(e){return r.default.time(e.query.time)}},query_name:{msg:"You must give your saved query a name.",shouldRun:function(e){return e.saving},validate:function(e){var t=e.query_name;return null!==t&&void 0!==t&&"string"==typeof t&&t.length>0}},refresh_rate:{msg:"Refresh rate must be between 4 and 24 hours.",validate:function(e){var t=e.refresh_rate;return"number"!=typeof t||t>=1440&&t<=86400||0==t}},email:{msg:"A valid email address is required.",shouldRun:n.default.isEmailExtraction,validate:function(e){return new RegExp(/.+@.+\..+/i).test(e.query.email)}},latest:{msg:"Latest must be a number.",shouldRun:n.default.isEmailExtraction,validate:function(e){var t=e.query.latest;if(!t)return!0;var a=~~Number(t);return String(a)===t&&a>=0}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(0),i=(n=r)&&n.__esModule?n:{default:n};var l={getQueryDataType:function(e){var t,a="string"==typeof e.interval,n="string"==typeof e.group_by||e.group_by instanceof Array&&1===e.group_by.length,r=e.group_by instanceof Array&&2===e.group_by.length;return"funnel"===e.analysis_type?t="cat-ordinal":"extraction"===e.analysis_type?t="extraction":"select_unique"===e.analysis_type?t="nominal":n||a||r?n&&!a?t="categorical":!a||n||r?a&&(n||r)?t="cat-chronological":!a&&r&&(t="categorical"):t="chronological":t="singular",t},getChartTypeOptions:function(e){return{singular:["metric"],categorical:["piechart","barchart","columnchart","table"],"cat-interval":["columnchart","barchart","table"],"cat-ordinal":["barchart","columnchart","areachart","linechart","table"],chronological:["areachart","linechart","table"],"cat-chronological":["linechart","columnchart","barchart","areachart","table"],nominal:["table"],extraction:["table"]}[l.getQueryDataType(e)].concat(["JSON"])},responseSupportsChartType:function(e,t){return i.default.includes(l.getChartTypeOptions(e),t)},isTableChartType:function(e){return"table"==e}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(0));function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return e&&!r.default.isEmpty(e)}var s=n.default.createClass({displayName:"NoticeComponent",close:function(e){e.preventDefault(),this.setState({open:!1}),this.props.closeCallback()},getDefaultProps:function(){return{notice:{},closeCallback:function(){},closable:!0}},getInitialState:function(){return{open:l(this.props.notice)}},componentWillReceiveProps:function(e){this.setState({open:l(e.notice)})},render:function(){var e,t,a="notice-component alert";if(this.state.open||(a+=" hide"),this.props.notice.type){var r=this.props.notice.type;"error"===r&&(r="danger"),a+=" alert-"+r}else a+=" alert-info";return this.props.notice.icon&&(e=n.default.createElement("span",{className:"icon glyphicon glyphicon-"+this.props.notice.icon})),this.props.closable&&(t=n.default.createElement("button",{className:"close",onClick:this.close},"×")),n.default.createElement("div",{className:a,key:"notice",ref:"notice"},t,n.default.createElement("p",null,e," ",n.default.createElement("strong",null,this.props.notice.text||"")))}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(0)),r=u(a(7)),i=u(a(43)),l=u(a(16)),s=(u(a(5)),u(a(3))),o=u(a(2));function u(e){return e&&e.__esModule?e:{default:e}}var c={create:function(e){r.default.dispatch({actionType:i.default.PROJECT_CREATE,attrs:e})},update:function(e,t){var a=l.default.getProject();r.default.dispatch({actionType:i.default.PROJECT_UPDATE,id:a.id,updates:t})},fetchProjectCollections:function(e){var t=l.default.getProject();return t||console.error("Cannot fetchProjectCollections: No project model has been created yet."),e.get(e.url("projectId")).auth(e.masterKey()).send().then(function(e){var a=n.default.assign({},t.schema);n.default.each(e.events,function(e){a[e.name]=n.default.assign(e,{properties:{},sortedProperties:[],loading:!1,recentEvents:null})}),c.update(t.id,{schema:a,eventCollections:o.default.sortItems(n.default.keys(a)),loading:!1})}).catch(function(e){console.error("Error fetching project collections: ",e.stack)})},fetchCollectionSchema:function(e,t){return!(l.default.getProject().eventCollections.indexOf(t)<0)&&(c.updateEventCollection(t,{loading:!0}),e.get(e.url("events",encodeURIComponent(t))).auth(e.masterKey()).send().then(function(e){c.updateEventCollection(t,{properties:e.properties,sortedProperties:o.default.sortItems(n.default.keys(e.properties)),loading:!1})}).catch(function(e){console.error("Error fetching project collections: ",e.stack)}))},updateEventCollection:function(e,t){var a=l.default.getProject();r.default.dispatch({actionType:i.default.PROJECT_UPDATE_EVENT_COLLECTION,id:a.id,collectionName:e,updates:t})},fetchRecentEventsForCollection:function(e,t){l.default.getProject();c.updateEventCollection(t,{loading:!0}),s.default.runQuery({client:e,query:{event_collection:t,analysis_type:"extraction",latest:10},success:function(e){c.updateEventCollection(t,{recentEvents:e.result})},error:function(e){console.error("Error requesting latest events for event collection: "+t,e.stack)},complete:function(){c.updateEventCollection(t,{loading:!1})}})}};t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(1));r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}var i=n.default.createClass({displayName:"LoaderComponent",toggle:function(e){this.props.visible=e,this.forceUpdate()},getDefaultProps:function(){return{visible:!1,additionalClasses:!1}},render:function(){var e="explorer-loader";return this.props.visible||(e+=" hide"),this.props.additionalClasses&&(e+=" "+this.props.additionalClasses),n.default.createElement("div",{className:e},n.default.createElement("div",{className:"msg"},n.default.createElement("div",{className:"explorer-spinner"},n.default.createElement("div",{className:"rect1"}),n.default.createElement("div",{className:"rect2"}),n.default.createElement("div",{className:"rect3"}),n.default.createElement("div",{className:"rect4"}),n.default.createElement("div",{className:"rect5"})),"Loading..."))}});t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(0)),r=i(a(2));function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return"Geo"===e.coercion_type}t.default={property_name:{msg:"Choose a property name",validate:function(e){return"string"==typeof e.property_name&&e.property_name.length>0}},operator:{msg:"Choose an operator",validate:function(e){return"string"==typeof e.operator&&e.operator.length>0}},property_value:{msg:"Choose a property value.",shouldRun:function(e){return!l(e)},validate:function(e){var t=e.property_value,a=e.coercion_type;return"List"==a?!!r.default.parseList(t):"Null"===a||"Boolean"===a||("Number"===a?n.default.isNumber(t):"String"===a||!!t)}},coercion_type:{msg:"Choose a coercion type",validate:function(e){return"string"==typeof e.coercion_type&&e.coercion_type.length>0}},coordinates:{msg:"Provide all coordinates.",shouldRun:l,validate:function(e){var t=e.property_value.coordinates,a=n.default.isArray(t)&&2===t.length;if(!a)return a;for(var r=0;r<t.length&&a;r++)a=n.default.isNumber(t[r]);return a}},max_distance_miles:{msg:"Provide a max distance in miles.",shouldRun:l,validate:function(e){var t=e.property_value.max_distance_miles;return t&&n.default.isNumber(t)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(45)),r=i(a(0));function i(e){return e&&e.__esModule?e:{default:e}}t.default={getSearchString:function(){return window.location.search},updateSearchString:function(e){var t;t=r.default.keys(e).length?"?"+n.default.stringify(e):window.location.origin+window.location.pathname,window.history.pushState({model:e},"",t)},getQueryAttributes:function(){return n.default.parse(this.getSearchString().replace("?",""),{depth:7})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(0)),r=u(a(1)),i=u(a(54)),l=u(a(40)),s=u(a(5)),o=u(a(8));function u(e){return e&&e.__esModule?e:{default:e}}var c=r.default.createClass({displayName:"FilterManager",propTypes:{eventCollection:r.default.PropTypes.string,propertyNames:r.default.PropTypes.array,filters:r.default.PropTypes.array,addFilter:r.default.PropTypes.func.isRequired,removeFilter:r.default.PropTypes.func.isRequired,handleChange:r.default.PropTypes.func.isRequired,getPropertyType:r.default.PropTypes.func.isRequired},open:function(){this.refs.modal.open()},addFilter:function(e){e.preventDefault(),this.props.addFilter()},removeFilter:function(e){this.props.removeFilter(e)},handleChange:function(e,t,a){var r=n.default.cloneDeep(this.props.filters[e]);if(n.default.isNull(t.match("coordinates")))"max_distance_miles"===t&&"Geo"===r.coercion_type?r.property_value[t]=o.default.coerceGeoValue(a):r[t]=a;else{var i=parseInt(t.split(".")[1]);r.property_value.coordinates[i]=o.default.coerceGeoValue(a)}this.props.handleChange(e,r)},buildFilterNodes:function(){var e=this.props.filters.map(function(e,t){return r.default.createElement(i.default,{key:t,index:t,filter:e,propertyType:this.props.getPropertyType(this.props.eventCollection,e.property_name),eventCollection:this.props.eventCollection,propertyNames:this.props.propertyNames,handleChange:this.handleChange,removeFilter:this.removeFilter,filterOperators:s.default.getConstant("FILTER_OPERATORS")})}.bind(this));return r.default.createElement("div",null,e,r.default.createElement("div",{className:"filter-buttons"},r.default.createElement("a",{href:"#",className:"add-filter btn btn-primary",onClick:this.addFilter},r.default.createElement("i",{className:"icon glyphicon glyphicon-plus margin-right-tiny"}),"Add another filter")))},noFiltersMarkup:function(){return r.default.createElement("div",{className:"row"},r.default.createElement("div",{className:"col-md-10 col-md-offset-1"},r.default.createElement("div",{className:"no-filters-msg callout"},r.default.createElement("p",{className:"lead"},r.default.createElement("i",{className:"icon glyphicon glyphicon-info-sign margin-right-tiny"}),"Please select an Event Collection before making a filter."))))},render:function(){var e=this.props.eventCollection?this.buildFilterNodes():this.noFiltersMarkup();return r.default.createElement(l.default,{ref:"modal",title:"Filters",size:"large",onClose:this.modalClosed,modalClasses:"filters-modal",footerBtns:[{text:"Done",classes:"btn-success",iconName:"ok-circle"}]},r.default.createElement("div",{className:"filters"},e))}});t.default=c},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});i(a(0));var n=i(a(1)),r=i(a(10));function i(e){return e&&e.__esModule?e:{default:e}}var l=["12:00 AM","12:15 AM","12:30 AM","12:45 AM","01:00 AM","01:15 AM","01:30 AM","01:45 AM","02:00 AM","02:15 AM","02:30 AM","02:45 AM","03:00 AM","03:15 AM","03:30 AM","03:45 AM","04:00 AM","04:15 AM","04:30 AM","04:45 AM","05:00 AM","05:15 AM","05:30 AM","05:45 AM","06:00 AM","06:15 AM","06:30 AM","06:45 AM","07:00 AM","07:15 AM","07:30 AM","07:45 AM","08:00 AM","08:15 AM","08:30 AM","08:45 AM","09:00 AM","09:15 AM","09:30 AM","09:45 AM","10:00 AM","10:15 AM","10:30 AM","10:45 AM","11:00 AM","11:15 AM","11:30 AM","11:45 AM","12:00 PM","12:15 PM","12:30 PM","12:45 PM","01:00 PM","01:15 PM","01:30 PM","01:45 PM","02:00 PM","02:15 PM","02:30 PM","02:45 PM","03:00 PM","03:15 PM","03:30 PM","03:45 PM","04:00 PM","04:15 PM","04:30 PM","04:45 PM","05:00 PM","05:15 PM","05:30 PM","05:45 PM","06:00 PM","06:15 PM","06:30 PM","06:45 PM","07:00 PM","07:15 PM","07:30 PM","07:45 PM","08:00 PM","08:15 PM","08:30 PM","08:45 PM","09:00 PM","09:15 PM","09:30 PM","09:45 PM","10:00 PM","10:15 PM","10:30 PM","10:45 PM","11:00 PM","11:15 PM","11:30 PM","11:45 PM"];function s(e,t){t||(t=new Date);var a=e.match(/(\d+)(?::(\d\d))?\s*(p?)/i);if(!a)return NaN;var n=parseInt(a[1],10);return 12!=n||a[3]?n+=n<12&&a[3]?12:0:n=0,t.setHours(n),t.setMinutes(parseInt(a[2],10)||0),t.setSeconds(0,0),t}var o=n.default.createClass({displayName:"Timepicker",validateTime:function(e){return s(e)instanceof Date?(this.setState({errorMsg:!1}),!0):(this.setState({errorMsg:"Invalid time"}),!1)},handleBlur:function(e){this.validateTime(e.target.value)&&this.props.handleBlur(e.target.name,s(e.target.value).getTime())},handleSelection:function(e,t){this.validateTime(t)&&this.props.handleSelection(e,s(t).getTime())},handleChange:function(e,t){this.setState({value:t}),this.props.handleChange(e,t)},getInitialState:function(){return{errorMsg:!1,value:this.props.value}},getDefaultProps:function(){return{refValue:"timepicker",label:!1,handleBlur:function(){},handleChange:function(){},handleSelection:function(){},placeholder:"",classes:"timepicker-wrapper form-group"}},componentWillReceiveProps:function(e){e.value!=this.state.value&&this.setState({value:e.value})},render:function(){var e=this.props.label?n.default.createElement("label",{htmlFor:this.props.name},this.props.label):null,t=this.state.errorMsg?n.default.createElement("p",null,this.state.errorMsg):null;return n.default.createElement("div",{className:this.props.classes},e,n.default.createElement(r.default,{ref:this.props.refValue,name:this.props.name,inputClasses:"form-control",items:l,handleBlur:this.handleBlur,handleChange:this.handleChange,handleSelection:this.handleSelection,value:this.state.value,title:this.props.name,sort:!0}),t)}});t.default=o},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(0)),r=l(a(1)),i=l(a(9));l(a(23));function l(e){return e&&e.__esModule?e:{default:e}}a(58),a(57);var s=r.default.createClass({displayName:"Datepicker",handleOnBlur:function(e){this.destroyPicker();var t=e.target.value,a=(0,i.default)(new Date(t)).isValid();a?(this.props.onBlur(e),this.setState({errorMsg:!1})):t&&!a&&this.setState({errorMsg:"Invalid"})},onFocus:function(){var e=this.props.minimum;$(this.refs[this.props.refValue]).pickadate({format:"mmm d, yyyy",editable:!0,min:e,onSet:n.default.bind(function(e){this.props.onSet(this.props.name,new Date(this.refs.datepicker.value))},this)})},destroyPicker:function(){var e=$(this.refs[this.props.refValue]).pickadate("picker");e&&e.stop()},getInitialState:function(){return{errorMsg:!1}},getDefaultProps:function(){return{refValue:"datepicker",label:!1,onChange:function(){},placeholder:"",classes:"datepicker-wrapper form-group",onSet:function(){}}},render:function(){var e=this.props.label?r.default.createElement("label",{htmlFor:this.props.name},this.props.label):null,t=this.state.errorMsg?r.default.createElement("p",null,this.state.errorMsg):"";return r.default.createElement("div",{className:this.props.classes},e,r.default.createElement("input",{type:"text",ref:this.props.refValue,name:this.props.name,className:"form-control",value:this.props.value,onChange:this.props.onChange,onBlur:this.handleOnBlur,onFocus:this.onFocus,placeholder:this.props.placeholder,autoComplete:"off"}),t)}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});c(a(0));var n=c(a(9)),r=c(a(1)),i=c(a(59)),l=c(a(56)),s=(c(a(14)),c(a(10)),c(a(55))),o=(c(a(4)),c(a(17))),u=c(a(5));function c(e){return e&&e.__esModule?e:{default:e}}var d=r.default.createClass({displayName:"Timeframe",toggleTimeframeType:function(e){e.preventDefault();var t=e.currentTarget.dataset.type;this.props.handleChange("time","absolute"===t?{start:new Date((0,n.default)().subtract(1,"days").startOf("day").format()),end:new Date((0,n.default)().startOf("day").format())}:{relativity:"this",amount:"14",sub_timeframe:"days"})},isAbsolute:function(){return"absolute"===o.default.timeframeType(this.props.time)},isRelative:function(){return"relative"===o.default.timeframeType(this.props.time)},render:function(){this.props.timezone||u.default.getConstant("DEFAULT_TIMEZONE");if(this.isAbsolute())var e=r.default.createElement(i.default,{time:this.props.time,handleChange:this.props.handleChange});else e=r.default.createElement(l.default,{relativeIntervalTypes:u.default.getConstant("RELATIVE_INTERVAL_TYPES"),time:this.props.time,handleChange:this.props.handleChange});return r.default.createElement("div",{className:"timeframe"},r.default.createElement("div",{className:"field-component"},r.default.createElement("label",null,"Timeframe"),r.default.createElement("ul",{className:"nav nav-pills",role:"tablist"},r.default.createElement("li",{className:this.isRelative()?"active":""},r.default.createElement("a",{href:"#",className:"relative-tab","data-type":"relative",onClick:this.toggleTimeframeType},"Relative")),r.default.createElement("li",{className:this.isAbsolute()?"active":""},r.default.createElement("a",{href:"#",className:"absolute-tab","data-type":"absolute",onClick:this.toggleTimeframeType},"Absolute"))),e,r.default.createElement(s.default,{timezone:this.props.timezone,timeframe_type:o.default.timeframeType(this.props.time),handleChange:this.props.handleChange})))}});t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=(i(a(0)),i(a(10)));function i(e){return e&&e.__esModule?e:{default:e}}var l=n.default.createClass({displayName:"SelectField",getDefaultProps:function(){return{sort:!1,inputClasses:[]}},buildBrowseEventsLink:function(){if(this.props.onBrowseEvents)return n.default.createElement("button",{className:"btn btn-link field-secondary-control",title:"Browse event collections",type:"button",onClick:this.props.onBrowseEvents,id:"browse-event-collections"},n.default.createElement("span",{className:"icon glyphicon glyphicon-search"})," Preview collections")},render:function(){var e=this.props.requiredLabel?n.default.createElement("small",null,"(required)"):null;return n.default.createElement("div",{className:"field-component"},n.default.createElement("label",{htmlFor:this.props.name},this.props.label," ",e),n.default.createElement(r.default,{ref:"select",name:this.props.name,inputClasses:this.props.inputClasses.join(" ")+" form-control",items:this.props.options,handleChange:this.props.handleChange,value:this.props.value,sort:this.props.sort}),this.buildBrowseEventsLink())}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(20),i=(n=r)&&n.__esModule?n:{default:n};t.default=(0,i.default)({NOTICE_CREATE:null,NOTICE_CLEAR_ALL:null})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i(a(0));var n=i(a(2)),r=i(a(39));function i(e){return e&&e.__esModule?e:{default:e}}t.default={event_collection:{msg:"Choose an Event Collection.",validate:function(e){return"string"==typeof e.event_collection&&e.event_collection.length>0}},actor_property:{msg:"You must select an actor property",validate:function(e){return"string"==typeof e.actor_property&&e.actor_property.length>0}},time:{validate:function(e){return r.default.time(e.time)}},filters:{msg:"One of your filters is invalid.",validate:function(e){return r.default.filters(e.filters)}},optional:{msg:"You must select whether this step is optional.",validate:function(e){return!n.default.isNullOrUndefined(e.optional)&&"boolean"==typeof e.optional}},inverted:{msg:"You must select whether this step is inverted.",validate:function(e){return!n.default.isNullOrUndefined(e.inverted)&&"boolean"==typeof e.inverted}},with_actors:{msg:'"with_actors" must be set to either true or false',validate:function(e){return!n.default.isNullOrUndefined(e.with_actors)&&"boolean"==typeof e.with_actors}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(0)),r=o(a(12)),i=o(a(30)),l=o(a(17)),s=o(a(8));function o(e){return e&&e.__esModule?e:{default:e}}t.default={filters:function(e){if(!e||n.default.isArray(e)&&!e.length)return!0;for(var t=!0,a=0;a<e.length;a++)s.default.isComplete(e[a])&&(r.default.run(i.default,e[a]),e[a].isValid||(t=!1));return t},time:function(e){return e?"relative"===l.default.timeframeType(e)?!!(e.relativity&&e.amount&&e.sub_timeframe)||"You must choose all 3 options for relative timeframes.":"absolute"===l.default.timeframeType(e)?!(!e.start||!e.end)||"You must provide a start and end time for absolute timeframes.":"You must provide a timeframe.":"You must provide a timeframe."}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(0)),i=l(a(6));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"Modal",closeClick:function(e){e.preventDefault(),this.close()},backdropClick:function(e){$(e.target).closest(".modal-dialog").length||this.close()},close:function(){this.state.open&&(this.removeBackdrop(),this.setState({open:!1}),this.props.onClose())},open:function(){this.state.open||(this.addBackdrop(),this.setState({open:!0}),this.props.onOpen())},setLoading:function(e){"boolean"==typeof e&&this.setState({loading:e})},addBackdrop:function(){$("body").addClass("modal-open");var e=document.createElement("div");e.id="modal-backdrop",e.className="modal-backdrop in",document.body.appendChild(e)},removeBackdrop:function(){$("body").removeClass("modal-open"),$(".modal-backdrop").remove()},buildFooter:function(){if(this.props.footerBtns.length){var e=r.default.map(this.props.footerBtns,r.default.bind(function(e,t){var a=e.text,r="btn";if(e.classes?r=r+" "+e.classes:r+=" btn-default",e.iconName)var i="icon glyphicon glyphicon-"+e.iconName,l=n.default.createElement("span",{className:i});return n.default.createElement("button",{type:"button",ref:e.ref||"",className:r,onClick:e.onClick||this.close,key:t},l,a)},this));return n.default.createElement("div",{className:"modal-footer"},e)}},getInitialState:function(){return{open:!1,loading:!1}},getDefaultProps:function(){return{size:"small",modalClasses:"",footerBtns:[],onOpen:function(){},onClose:function(){}}},componentDidMount:function(){$(document).on("click",".modal.block",r.default.bind(this.backdropClick,this)),$(document).on("keyup",r.default.bind(function(e){27===e.keyCode&&e.target.className.indexOf("react-select-input")<0&&this.close()},this))},componentWillUnmount:function(){$(document).off("click",".modal-backdrop")},render:function(){var e=this.props.modalClasses+" modal";this.state.open&&(e+=" block");var t,a=(0,i.default)({"modal-dialog":!0,"modal-lg":"large"===this.props.size});if(this.props.titleIcon){var r="icon glyphicon glyphicon-"+this.props.titleIcon;this.props.title||(r+=" big no-margin"),this.props.iconClasses&&(r=r+" "+this.props.iconClasses),t=n.default.createElement("span",{className:r})}return n.default.createElement("div",{className:e},n.default.createElement("div",{className:a},n.default.createElement("div",{className:"modal-content"},n.default.createElement("div",{className:"modal-header"},n.default.createElement("button",{type:"button",className:"close",onClick:this.closeClick},n.default.createElement("span",{"aria-hidden":"true"},"×"),n.default.createElement("span",{className:"sr-only"},"Close")),n.default.createElement("h3",{className:"modal-title"},t,this.props.title)),n.default.createElement("div",{className:"modal-body"},this.props.children),this.buildFooter())))}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(20),i=(n=r)&&n.__esModule?n:{default:n};t.default=(0,i.default)({APP_STATE_UPDATE:null,APP_STATE_RESET:null})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),r=s(a(7)),i=a(21),l=s(a(41));function s(e){return e&&e.__esModule?e:{default:e}}var o={fetchingPersistedExplorers:!1,codeSampleHidden:!0,ready:!1};function u(){o={fetchingPersistedExplorers:!1,codeSampleHidden:!0,ready:!1}}var c=n.default.assign({},i.EventEmitter.prototype,{unregisterWithDispatcher:function(){r.default.unregister(this.dispatchToken)},getState:function(){return o},reset:function(){u()},emitChange:function(){this.emit("change")},addChangeListener:function(e){this.on("change",e)},removeChangeListener:function(e){this.removeListener("change",e)}});c.dispatchToken=r.default.register(function(e){switch(e.actionType){case l.default.APP_STATE_UPDATE:t=e.updates,o=n.default.assign({},o,t),c.emitChange();break;case l.default.APP_STATE_RESET:u(),c.emitChange()}var t;return!0}),t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(20),i=(n=r)&&n.__esModule?n:{default:n};t.default=(0,i.default)({PROJECT_CREATE:null,PROJECT_UPDATE:null,PROJECT_UPDATE_EVENT_COLLECTION:null})},function(e,t){e.exports=l},function(e,t){e.exports=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(0)),r=u(a(7)),i=a(21),l=u(a(37)),s=u(a(19)),o=u(a(11));function u(e){return e&&e.__esModule?e:{default:e}}var c={};function d(e){e.location&&"global"!==e.location||n.default.each(c,function(e,t){"global"===e.location&&delete c[t]});var t="TEMP-"+(+new Date+Math.floor(999999*Math.random())).toString(36);c[t]=n.default.assign({location:"global",text:null,type:null},e)}function p(){c={}}var f=n.default.assign({},i.EventEmitter.prototype,{unregisterWithDispatcher:function(){r.default.unregister(this.dispatchToken)},getGlobalNotice:function(){return n.default.find(c,{location:"global"})},getStepNotices:function(){return n.default.filter(c,function(e){if("step"===e.location)return e})},clearAll:function(){p()},emitChange:function(){this.emit("change")},addChangeListener:function(e){this.on("change",e)},removeChangeListener:function(e){this.removeListener("change",e)}});f.dispatchToken=r.default.register(function(e){switch(r.default.waitFor([o.default.dispatchToken]),e.actionType){case l.default.NOTICE_CREATE:d(e.attrs),f.emitChange();break;case l.default.NOTICE_CLEAR_ALL:p(),f.emitChange();break;case s.default.EXPLORER_SAVING:d({type:"info",text:a="save"===e.saveType?"Saving query...":"Updating query...",icon:"info-sign"}),f.emitChange();break;case s.default.EXPLORER_SAVE_SUCCESS:d({type:"success",text:(a="save"===e.saveType?"Query saved":"Query updated")+".",icon:"ok"}),f.emitChange();break;case s.default.EXPLORER_SAVE_FAIL:var t,a="save"===e.saveType?"saving":"updating";e.errorMsg?t="Problem "+a+": "+e.errorMsg:e.errorResp&&"OverCachedQueryLimitError"===JSON.parse(e.errorResp.text).error_code?t="Oops! Looks like you’ve reached your caching limit. Need more cached queries? Contact us at team@keen.io":e.errorResp&&(t="Problem "+a+": "+JSON.parse(e.errorResp.text).message),d({type:"error",text:t,icon:"remove-sign"}),f.emitChange();break;case s.default.EXPLORER_DESTROYING:d({type:"info",text:"Deleting query...",icon:"info-sign"}),f.emitChange();break;case s.default.EXPLORER_DESTROY_SUCCESS:d({type:"success",text:"Query deleted.",icon:"ok"}),f.emitChange();break;case s.default.EXPLORER_DESTROY_FAIL:d({type:"error",text:"There was a problem deleting your query: "+e.errorMsg,icon:"remove-sign"}),f.emitChange();break;case s.default.EXPLORER_FOUND_INVALID:var i=o.default.get(e.id);d({text:"There was a problem: "+i.errors[0].msg,type:"error",icon:"remove-sign"}),"funnel"===i.query.analysis_type&&(n.default.each(c,function(e,t){"step"===e.location&&delete c[t]}),i.query.steps.forEach(function(e,t){e.isValid||d({id:i.id,location:"step",stepIndex:t,text:e.errors[0].msg,type:"error",icon:"remove-sign"})})),f.emitChange()}return!0}),t.default=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(6)),i=(l(a(0)),l(a(3)));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"QueryActions",runBtnStates:{default:{inactive:"Run Query",active:"Running..."},immediateExtraction:{inactive:"Run Extraction",active:"Running..."},emailExtraction:{inactive:"Send Email Extraction",active:"Sending..."}},runButtonText:function(){var e=this.runBtnStates.default;return i.default.isEmailExtraction(this.props.model)?e=this.runBtnStates.emailExtraction:i.default.isImmediateExtraction(this.props.model)&&(e=this.runBtnStates.immediateExtraction),this.props.model.loading?e.active:e.inactive},render:function(){var e,t,a,l,s=!0,o=(0,r.default)({disabled:this.props.model.loading,"btn btn-primary run-query":!0}),u=(0,r.default)({"btn btn-default code-sample-toggle pull-right":!0,open:!this.props.codeSampleHidden}),c=i.default.isEmailExtraction(this.props.model),d=i.default.isPersisted(this.props.model);this.props.model.query.analysis_type;return this.props.persistence&&(c&&(s=!1,e=n.default.createElement("p",{className:"no-margin margin-top-tiny"},n.default.createElement("small",null,"The Keen IO API currently does not support saving email extraction."))),t=n.default.createElement("button",{type:"button",className:"btn btn-success save-query",onClick:s?this.props.saveQueryClick:function(){},role:"save-query",disabled:this.props.model.loading||!s},d?"Update":"Save"),l=n.default.createElement("button",{type:"button",role:"delete-query",className:"btn btn-link",onClick:s?this.props.removeClick:function(){},disabled:!s},"Delete"),d&&(a=n.default.createElement("button",{type:"button",className:"btn btn-default",onClick:s?this.props.cloneQueryClick:function(){},role:"clone-query",disabled:this.props.model.loading||!s},"Clone"))),n.default.createElement("div",{className:"query-actions clearfix"},n.default.createElement("div",{className:"row"},n.default.createElement("div",{className:"col-md-10 clearfix"},n.default.createElement("div",{className:"run-group pull-left"},n.default.createElement("button",{type:"submit",role:"run-query",className:o,id:"run-query",onClick:this.props.handleQuerySubmit},this.runButtonText())),n.default.createElement("div",{className:"manage-group pull-left"},t,a,l)),n.default.createElement("div",{className:"col-md-2"},n.default.createElement("button",{className:u,role:"toggle-code-sample",onClick:this.props.toggleCodeSample},n.default.createElement("span",null,"</> Embed")))),e)}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(1)),r=o(a(0)),i=o(a(6)),l=o(a(9)),s=o(a(4));function o(e){return e&&e.__esModule?e:{default:e}}var u=n.default.createClass({displayName:"CacheToggle",setCached:function(e){var t=r.default.clone(this.props.model);this._isCached()?t.refresh_rate=0:t.refresh_rate=14400,s.default.update(this.props.model.id,t),this.setState({settingsOpen:0!=t.refresh_rate&&this.state.settingsOpen})},setSettingsOpen:function(e){e.preventDefault(),this.setState({settingsOpen:!this.state.settingsOpen})},setRefreshRate:function(e){this.setState({refresh_rate:e.target.value})},setRefreshRateBlur:function(e){var t=Math.round(3600*e.target.value),a=r.default.clone(this.props.model);a.refresh_rate=t,s.default.update(this.props.model.id,a),this.forceUpdate()},getInitialState:function(){return{refresh_rate:this._refreshRateInHours(this.props.model),cached:!1,settingsOpen:!1}},componentWillReceiveProps:function(e){this.setState({refresh_rate:this._refreshRateInHours(e.model)})},render:function(){var e=this._isCached(),t=(0,i.default)({"cache-toggle":!0,inactive:!e}),a=(0,i.default)({"cache-details":!0,hide:!e}),r=(0,i.default)({"cache-settings":!0,hide:!this.state.settingsOpen}),l=e?"Caching enabled":"Enable caching";return n.default.createElement("div",{className:t},n.default.createElement("label",{htmlFor:"cache"},n.default.createElement("input",{type:"checkbox",name:"cache",id:"cache",onChange:this.setCached,checked:e}),l,n.default.createElement("a",{href:"https://keen.io/docs/api/#saved-queries",target:"_blank"},n.default.createElement("i",{className:"icon glyphicon glyphicon-question-sign"}))),n.default.createElement("span",{className:a},this._minutesAgo(),n.default.createElement("a",{href:"#",onClick:this.setSettingsOpen,className:"margin-left-tiny"},n.default.createElement("span",{className:"icon icon-cog glyphicon-cog glyphicon"}))),n.default.createElement("span",{className:r},"Refresh every ",n.default.createElement("input",{type:"text",name:"refresh_rate",value:this.state.refresh_rate,className:"form-control",onChange:this.setRefreshRate,onBlur:this.setRefreshRateBlur})," hours (","min 4 / max 24",")"))},_isCached:function(){return 0!=this.props.model.refresh_rate},_minutesAgo:function(){var e=this.props.model.run_information;if(null!=e&&200==e.last_run_status){var t=(0,l.default)(e.last_run_date).utcOffset(0);return"Last updated "+l.default.duration(t.diff((0,l.default)())).humanize()+" ago."}},_refreshRateInHours:function(e){return e.refresh_rate/3600*100/100}});t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=l(a(0)),i=l(a(9));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"BrowseQueries",clickCallback:function(e){this.props.clickCallback(e)},buildList:function(){var e=this.props.listItems.map(r.default.bind(function(e,t){var a,r;this.props.selectedIndex===t&&(a="active");var l=function(e){if(e.created_date){var t=(0,i.default)(new Date(e.created_date.replace(" ","T")));return t.isValid()?t.format("ll h:mm A"):null}}(e);l&&(r=n.default.createElement("p",{className:"date pull-right"},n.default.createElement("span",{className:"icon glyphicon glyphicon-time"}),l));var s=e.refresh_rate>0?"Cached":"",o=null;return o=e.metadata&&e.metadata.display_name?e.metadata.display_name:e.query_name?e.query_name:"Query not named",n.default.createElement("li",{className:a,key:t,"data-id":e.id,onClick:this.clickCallback},n.default.createElement("h5",{className:"name"},o),n.default.createElement("div",{className:"metadata clearfix"},n.default.createElement("p",{className:"date pull-left"},s),r))},this));return n.default.createElement("ul",{ref:"list",className:"interactive-list"},e)},fieldChanged:function(e){var t={};t[e.target.name]=e.target.value,this.setState(t)},getDefaultProps:function(){return{listItems:[],clickCallback:null,selectedIndex:null,notice:null,emptyContent:null}},render:function(){var e=this.props.listItems.length?null:this.props.emptyContent,t=this.buildList();return n.default.createElement("section",{className:"query-pane-section browse-queries"},this.props.notice,t,e)}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(1),i=(n=r)&&n.__esModule?n:{default:n};var l=i.default.createClass({displayName:"ApiUrl",getInitialState:function(){return{active:!1}},handleClick:function(){var e=this;e.setState({active:!e.state.active}),e.state.active||setTimeout(function(){e.refs.input.focus()},50)},handleInputSelect:function(e){e.target.setSelectionRange(0,9999)},handleInputChange:function(e){e.preventDefault()},render:function(){return i.default.createElement("div",{className:"explorer-api-url"},i.default.createElement("button",{className:"btn btn-link field-secondary-control",title:"API URL",type:"button",onClick:this.handleClick},i.default.createElement("span",{className:"icon glyphicon glyphicon-chevron-"+(this.state.active?"down":"right")+" icon-chevron-"+(this.state.active?"down":"right")})," API Query URL"),i.default.createElement("div",{className:this.state.active?"show":"hide"},i.default.createElement("input",{ref:"input",name:"api-query",className:"form-control input-sm",placeholder:"API Query URL will appear here...",value:this.props.isValid?this.props.url:"",onClick:this.handleInputSelect,onFocus:this.handleInputSelect,onChange:this.handleInputChange})))}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s(a(0)),s(a(9));var n=s(a(1)),r=s(a(15)),i=s(a(14)),l=(s(a(4)),s(a(3)),s(a(5)));function s(e){return e&&e.__esModule?e:{default:e}}var o=n.default.createClass({displayName:"Interval",setInterval:function(e){this.props.handleChange("interval",e.target.value)},intervalFieldsToggled:function(e){e&&!this.props.interval&&this.props.handleChange("interval","daily")},intervalUpdateFn:function(e){this.props.handleChange("interval",e.interval)},intervalGetFn:function(e){if("interval"===e)return this.props.interval;throw new Error("Interval component is only aware of interval attributes")},render:function(){return n.default.createElement("div",{className:"field-component"},n.default.createElement(i.default,{ref:"interval-toggle",name:"Interval",initialOpenState:this.props.interval,attrsToStore:"interval",getFn:this.intervalGetFn,updateFn:this.intervalUpdateFn,toggleCallback:this.intervalFieldsToggled},n.default.createElement(r.default,{label:!1,name:"interval",classes:"interval-type",options:l.default.getConstant("ABSOLUTE_INTERVAL_TYPES"),emptyOption:!1,handleSelection:this.setInterval,selectedOption:this.props.interval,sort:!1})))}});t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r(a(0));var n=r(a(1));function r(e){return e&&e.__esModule?e:{default:e}}var i=n.default.createClass({displayName:"Geo",render:function(){return n.default.createElement("div",null,n.default.createElement("div",{className:"col-md-12"},n.default.createElement("label",{htmlFor:"amount"},"Longitude"),n.default.createElement("input",{type:"text",name:"coordinates.0",className:"form-control",value:this.props.filter.property_value.coordinates[0]||"",onChange:this.props.handleChange,autoComplete:"off"})),n.default.createElement("div",{className:"col-md-12"},n.default.createElement("label",{htmlFor:"amount"},"Latitude"),n.default.createElement("input",{type:"text",name:"coordinates.1",className:"form-control",value:this.props.filter.property_value.coordinates[1]||"",onChange:this.props.handleChange,autoComplete:"off"})),n.default.createElement("div",{className:"col-md-12"},n.default.createElement("label",{htmlFor:"amount"},"Radius in Miles"),n.default.createElement("input",{type:"text",name:"max_distance_miles",className:"form-control",value:this.props.filter.property_value.max_distance_miles||"",onChange:this.props.handleChange,autoComplete:"off"})))}});t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(0)),r=d(a(9)),i=d(a(1)),l=d(a(15)),s=d(a(34)),o=d(a(33)),u=d(a(52)),c=d(a(2));d(a(8));function d(e){return e&&e.__esModule?e:{default:e}}var p="ll",f="h:mm A";function h(e,t){var a=(0,r.default)(new Date(e)).format(p),n=(0,r.default)(new Date(t)).format(f);return new Date(a+" "+n).toString()}var m=i.default.createClass({displayName:"FilterValueFields",handleChangeWithEvent:function(e){this.props.handleChange(e.target.name,e.target.value)},setValueState:function(e){var t={};t[e.target.name]=e.target.value,this.setState(t)},setDate:function(e,t){this.props.handleChange(e,h(t,this.props.filter.property_value))},setTime:function(e,t){this.props.handleChange(e,h(this.props.filter.property_value,t))},handleDateBlur:function(e){this.setDate(e.target.name,e.target.value)},handleChange:function(e){this.props.handleChange(e.target.name,e.target.value)},getCoercionOptions:function(){var e=this.props.filter.operator;return e?n.default.find(this.props.filterOperators,{value:e}).canBeCoeredTo:[]},getInputPlaceholder:function(){var e=this.props.filter.coercion_type;return"List"===e?"Comma sep list":e},getInitialState:function(){return{property_value:this.props.filter.property_value}},componentWillReceiveProps:function(e){this.setState({property_value:e.filter.property_value})},render:function(){var e;return e="geo"===this.propertyType||"within"===this.props.filter.operator?i.default.createElement(u.default,{handleChange:this.handleChangeWithEvent,filter:this.props.filter}):"exists"===this.props.filter.operator||"Boolean"===this.props.filter.coercion_type?i.default.createElement(l.default,{name:"property_value",classes:"property-value",ref:"boolean-value-set",options:["true","false"],handleBlur:this.handleChangeWithEvent,handleSelection:this.setValueState,selectedOption:c.default.booleanMap(this.state.property_value)||"true",emptyOption:!1}):"Datetime"===this.props.filter.coercion_type?i.default.createElement("div",{className:"row property-value"},i.default.createElement("div",{className:"col-md-6 form-collapse-right"},i.default.createElement(s.default,{ref:"date-value-input",value:(0,r.default)(new Date(this.state.property_value)).format(p),label:!1,name:"property_value",placeholder:"Date",classes:"datepicker-wrapper",onSet:this.setDate,onBlur:this.handleDateBlur})),i.default.createElement("div",{className:"col-md-6 form-collapse-left"},i.default.createElement(o.default,{ref:"time-value-input",value:(0,r.default)(new Date(this.state.property_value)).format(f),label:!1,name:"property_value",placeholder:"Time",classes:"timepicker-wrapper",handleSelection:this.setTime,handleBlur:this.setTime}))):i.default.createElement("input",{type:"text",ref:"value-input",name:"property_value",className:"form-control property-value",value:this.state.property_value,onChange:this.setValueState,onBlur:this.handleChangeWithEvent,placeholder:this.getInputPlaceholder(),readOnly:"Null"===this.props.filter.coercion_type,autoComplete:"off"}),i.default.createElement("div",{className:"row"},i.default.createElement("div",{className:"col-md-3 form-collapse-right"},i.default.createElement(l.default,{label:!1,ref:"type-set",name:"coercion_type",classes:"coercion-type",sort:!1,options:this.getCoercionOptions(),handleSelection:this.handleChangeWithEvent,selectedOption:this.props.filter.coercion_type,emptyOption:!1})),i.default.createElement("div",{className:"col-md-9 form-collapse-left"},e))}});t.default=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});u(a(0));var n=u(a(1)),r=u(a(15)),i=u(a(6)),l=u(a(10)),s=u(a(53)),o=u(a(8));function u(e){return e&&e.__esModule?e:{default:e}}var c=n.default.createClass({displayName:"Filter",removeFilter:function(e){e.preventDefault(),this.props.removeFilter(this.props.index)},handleChange:function(e,t){this.props.handleChange(this.props.index,e,t)},handleChangeWithEvent:function(e){this.props.handleChange(this.props.index,e.target.name,e.target.value)},buildValueFormGroup:function(){return n.default.createElement(s.default,{filter:this.props.filter,filterOperators:this.props.filterOperators,handleChange:this.handleChange})},buildOperatorSelect:function(){return n.default.createElement(r.default,{label:!1,name:"operator",classes:"operator",options:this.props.filterOperators,emptyOption:!1,sort:!1,handleSelection:this.handleChangeWithEvent,selectedOption:this.props.filter.operator})},buildPropertyNameSelect:function(){return n.default.createElement(l.default,{name:"property_name",inputClasses:"property-name form-control",items:this.props.propertyNames,handleChange:this.handleChange,placeholder:"Select a property name",value:this.props.filter.property_name,sort:!0})},getListSyntaxInfo:function(){if("List"===this.props.filter.coercion_type)return n.default.createElement("p",{className:"filter-instructions help-block"},"Wrap strings in ",n.default.createElement("b",null,"double")," quotes & numbers in ",n.default.createElement("b",null,"single")," quotes.")},buildValidationError:function(){if(this.filterCompleteAndInvalid())return n.default.createElement("div",{className:"row"},n.default.createElement("div",{className:"col-md-12"},n.default.createElement("p",{className:"invalid"},"Invalid: ",this.props.filter.errors[0].msg)))},filterCompleteAndInvalid:function(){var e=o.default.isComplete(this.props.filter),t=this.props.filter.isValid;return e&&!t},render:function(){var e=(0,i.default)({"filter-row":!0,"filter-complete":!o.default.isComplete(this.props.filter)||this.props.filter.isValid,"filter-incomplete":this.filterCompleteAndInvalid()});return n.default.createElement("div",{className:e},n.default.createElement("div",{className:"row"},n.default.createElement("div",{className:"col-md-4 filter-property-col"},this.buildPropertyNameSelect()),n.default.createElement("div",{className:"col-md-2 filter-operator-col"},this.buildOperatorSelect()),n.default.createElement("div",{className:"col-md-5 filter-value-col"},this.buildValueFormGroup(),this.getListSyntaxInfo()),n.default.createElement("div",{className:"col-md-1 filter-close-col"},n.default.createElement("a",{href:"#",className:"remove-filter",onClick:this.removeFilter,"data-index":this.props.index},n.default.createElement("span",{className:"icon no-margin"},"×")))),this.buildValidationError())}});t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});l(a(0));var n=l(a(1)),r=l(a(10)),i=l(a(5));l(a(4));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"Timezone",handleTimezoneBlur:function(){this.setState({active:!1}),this.refs["timezone-display"].focus()},handleTimezoneActivated:function(){var e=this;this.setState({active:!0}),setTimeout(function(){e.refs.timezone.refs.input.focus(),e.refs.timezone.setState({visible:!0})},100)},handleTimezoneChange:function(e,t){var a=i.default.getConstant("TIMEZONES").filter(function(e){return e.name===t})[0];this.props.handleChange("timezone",a?a.name:t)},getInitialState:function(){return{active:!1}},componentDidMount:function(){this.props.timezone||this.props.handleChange("timezone",i.default.getConstant("DEFAULT_TIMEZONE")),this.refs.timezone.setState({visible:!1})},render:function(){return n.default.createElement("div",{className:"timezone-toggle"+(this.state.active?" active":"")},n.default.createElement("div",{className:"toggle-display"},n.default.createElement("button",{ref:"timezone-display",className:"btn btn-link field-secondary-control",title:"Selectd timezone: "+this.props.timezone,type:"button",onClick:this.handleTimezoneActivated},n.default.createElement("span",{className:"icon glyphicon glyphicon-globe"})," Timezone: ",this.props.timezone)),n.default.createElement("div",{className:"toggle-options"},n.default.createElement(r.default,{ref:"timezone",name:"timezone",classes:"timezone form-control",value:this.props.timezone,items:i.default.getConstant("TIMEZONES").map(function(e){return e.name}),handleChange:this.handleTimezoneChange,handleBlur:this.handleTimezoneBlur})))}});t.default=s},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(1)),r=o(a(0)),i=o(a(13)),l=o(a(15)),s=(o(a(3)),o(a(4)),o(a(2)));function o(e){return e&&e.__esModule?e:{default:e}}var u=["this","previous"];var c=n.default.createClass({displayName:"RelativePicker",setRelativeTime:function(e){var t=e.target.name,a=e.target.value,n=r.default.cloneDeep(this.props.time);n[t]=a,this.props.handleChange("time",n)},buildDescriptionCopy:function(){var e=this.props.time;if(function(e){return(e=e||{}).relativity&&e.amount&&e.sub_timeframe}(this.props.time)){var t=s.default.singularize(e.sub_timeframe,e.amount),a=e.amount>1?"s":"",r="this"==e.relativity?"including":"excluding",i=s.default.singularize(t);return n.default.createElement("p",{className:"help-block"},"The last ",e.amount," ",t,a," ",n.default.createElement("b",null,r)," the current ",i,".")}},render:function(){var e=this.buildDescriptionCopy();return n.default.createElement("div",{className:"relative-timeframe-picker"},n.default.createElement("div",{className:"row"},n.default.createElement("div",{className:"col-xs-4 form-collapse-right",id:"relative-type"},n.default.createElement("div",{className:"btn-group"},n.default.createElement(l.default,{label:!1,name:"relativity",classes:"relativity",options:u,emptyOption:!1,handleSelection:this.setRelativeTime,selectedOption:this.props.time.relativity}))),n.default.createElement("div",{className:"col-xs-3 form-collapse-left form-collapse-right",id:"interval-amount"},n.default.createElement(i.default,{label:!1,name:"amount",classes:"amount",onChange:this.setRelativeTime,placeholder:"e.g. 1",value:this.props.time.amount||"",autoComplete:"off"})),n.default.createElement("div",{className:"col-xs-5 form-collapse-left",id:"sub-interval-type"},n.default.createElement(l.default,{label:!1,name:"sub_timeframe",classes:"sub-timeframe",options:this.props.relativeIntervalTypes,emptyOption:!1,handleSelection:this.setRelativeTime,selectedOption:this.props.time.sub_timeframe,sort:!1}))),e)}});t.default=c},function(e,t,a){var n,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*!
 * Time picker for pickadate.js v3.5.4
 * http://amsul.github.io/pickadate.js/time.htm
 */
n=function(e,t){var a,n=e._;function r(e,t){var a,n=this,r=e.$node[0].value,i=e.$node.data("value"),l=i||r,s=i?t.formatSubmit:t.format;n.settings=t,n.$node=e.$node,n.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},n.item={},n.item.clear=null,n.item.interval=t.interval||30,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-(!0===(a=n.item.disable)[0]?a.shift():-1),n.set("min",t.min).set("max",t.max).set("now"),l?n.set("select",l,{format:s,fromValue:!!r}):n.set("select",null).set("highlight",n.item.now),n.key={40:1,38:-1,39:1,37:-1,go:function(e){n.set("highlight",n.item.highlight.pick+e*n.item.interval,{interval:e*n.item.interval}),this.render()}},e.on("render",function(){var a=e.$root.children(),n=a.find("."+t.klass.viewset),r=function(e){return["webkit","moz","ms","o",""].map(function(t){return(t?"-"+t+"-":"")+e})},i=function(e,t){r("transform").map(function(a){e.css(a,t)}),r("transition").map(function(a){e.css(a,t)})};n.length&&(i(a,"none"),a[0].scrollTop=~~n.position().top-2*n[0].clientHeight,i(a,""))},1).on("open",function(){e.$root.find("button").attr("disabled",!1)},1).on("close",function(){e.$root.find("button").attr("disabled",!0)},1)}r.prototype.set=function(e,t,a){var n=this,r=n.item;return null===t?("clear"==e&&(e="select"),r[e]=t,n):(r["enable"==e?"disable":"flip"==e?"enable":e]=n.queue[e].split(" ").map(function(r){return t=n[r](e,t,a)}).pop(),"select"==e?n.set("highlight",r.select,a):"highlight"==e?n.set("view",r.highlight,a):"interval"==e?n.set("min",r.min,a).set("max",r.max,a):e.match(/^(flip|min|max|disable|enable)$/)&&("min"==e&&n.set("max",r.max,a),r.select&&n.disabled(r.select)&&n.set("select",r.select,a),r.highlight&&n.disabled(r.highlight)&&n.set("highlight",r.highlight,a)),n)},r.prototype.get=function(e){return this.item[e]},r.prototype.create=function(e,a,r){return a=void 0===a?e:a,n.isDate(a)&&(a=[a.getHours(),a.getMinutes()]),t.isPlainObject(a)&&n.isInteger(a.pick)?a=a.pick:t.isArray(a)?a=60*+a[0]+ +a[1]:n.isInteger(a)||(a=this.now(e,a,r)),"max"==e&&a<this.item.min.pick&&(a+=1440),"min"!=e&&"max"!=e&&(a-this.item.min.pick)%this.item.interval!=0&&(a+=this.item.interval),{hour:~~(24+(a=this.normalize(e,a,r))/60)%24,mins:(60+a%60)%60,time:(1440+a)%1440,pick:a}},r.prototype.createRange=function(e,a){var r=this,i=function(e){return!0===e||t.isArray(e)||n.isDate(e)?r.create(e):e};return n.isInteger(e)||(e=i(e)),n.isInteger(a)||(a=i(a)),n.isInteger(e)&&t.isPlainObject(a)?e=[a.hour,a.mins+e*r.settings.interval]:n.isInteger(a)&&t.isPlainObject(e)&&(a=[e.hour,e.mins+a*r.settings.interval]),{from:i(e),to:i(a)}},r.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},r.prototype.overlapRanges=function(e,t){return e=this.createRange(e.from,e.to),t=this.createRange(t.from,t.to),this.withinRange(e,t.from)||this.withinRange(e,t.to)||this.withinRange(t,e.from)||this.withinRange(t,e.to)},r.prototype.now=function(e,t){var a,r=this.item.interval,i=new Date,l=60*i.getHours()+i.getMinutes(),s=n.isInteger(t);return l-=l%r,a=t<0&&r*t+l<=-r,l+="min"==e&&a?0:r,s&&(l+=r*(a&&"max"!=e?t+1:t)),l},r.prototype.normalize=function(e,t){var a=this.item.interval,n=this.item.min&&this.item.min.pick||0;return t-="min"==e?0:(t-n)%a},r.prototype.measure=function(e,a,r){return a||(a="min"==e?[0,0]:[23,59]),"string"==typeof a?a=this.parse(e,a):!0===a||n.isInteger(a)?a=this.now(e,a,r):t.isPlainObject(a)&&n.isInteger(a.pick)&&(a=this.normalize(e,a.pick,r)),a},r.prototype.validate=function(e,t,a){var n=a&&a.interval?a.interval:this.item.interval;return this.disabled(t)&&(t=this.shift(t,n)),t=this.scope(t),this.disabled(t)&&(t=this.shift(t,-1*n)),t},r.prototype.disabled=function(e){var a=this,r=a.item.disable.filter(function(r){return n.isInteger(r)?e.hour==r:t.isArray(r)||n.isDate(r)?e.pick==a.create(r).pick:t.isPlainObject(r)?a.withinRange(r,e):void 0});return r=r.length&&!r.filter(function(e){return t.isArray(e)&&"inverted"==e[2]||t.isPlainObject(e)&&e.inverted}).length,-1===a.item.enable?!r:r||e.pick<a.item.min.pick||e.pick>a.item.max.pick},r.prototype.shift=function(e,t){var a=this.item.min.pick,n=this.item.max.pick;for(t=t||this.item.interval;this.disabled(e)&&!((e=this.create(e.pick+=t)).pick<=a||e.pick>=n););return e},r.prototype.scope=function(e){var t=this.item.min.pick,a=this.item.max.pick;return this.create(e.pick>a?a:e.pick<t?t:e)},r.prototype.parse=function(e,t,a){var r,i,l,s,o,u=this,c={};if(!t||"string"!=typeof t)return t;for(s in a&&a.format||((a=a||{}).format=u.settings.format),u.formats.toArray(a.format).map(function(e){var a,r=u.formats[e],i=r?n.trigger(r,u,[t,c]):e.replace(/^!/,"").length;r&&(a=t.substr(0,i),c[e]=a.match(/^\d+$/)?+a:a),t=t.substr(i)}),c)o=c[s],n.isInteger(o)?s.match(/^(h|hh)$/i)?(r=o,"h"!=s&&"hh"!=s||(r%=12)):"i"==s&&(i=o):s.match(/^a$/i)&&o.match(/^p/i)&&("h"in c||"hh"in c)&&(l=!0);return 60*(l?r+12:r)+i},r.prototype.formats={h:function(e,t){return e?n.digits(e):t.hour%12||12},hh:function(e,t){return e?2:n.lead(t.hour%12||12)},H:function(e,t){return e?n.digits(e):""+t.hour%24},HH:function(e,t){return e?n.digits(e):n.lead(t.hour%24)},i:function(e,t){return e?2:n.lead(t.mins)},a:function(e,t){return e?4:720>t.time%1440?"a.m.":"p.m."},A:function(e,t){return e?2:720>t.time%1440?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var a=this;return a.formats.toArray(e).map(function(e){return n.trigger(a.formats[e],a,[0,t])||e.replace(/^!/,"")}).join("")}},r.prototype.isTimeExact=function(e,a){return n.isInteger(e)&&n.isInteger(a)||"boolean"==typeof e&&"boolean"==typeof a?e===a:(n.isDate(e)||t.isArray(e))&&(n.isDate(a)||t.isArray(a))?this.create(e).pick===this.create(a).pick:!(!t.isPlainObject(e)||!t.isPlainObject(a))&&(this.isTimeExact(e.from,a.from)&&this.isTimeExact(e.to,a.to))},r.prototype.isTimeOverlap=function(e,a){return n.isInteger(e)&&(n.isDate(a)||t.isArray(a))?e===this.create(a).hour:n.isInteger(a)&&(n.isDate(e)||t.isArray(e))?a===this.create(e).hour:!(!t.isPlainObject(e)||!t.isPlainObject(a))&&this.overlapRanges(e,a)},r.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},r.prototype.deactivate=function(e,a){var r=this,i=r.item.disable.slice(0);return"flip"==a?r.flipEnable():!1===a?(r.flipEnable(1),i=[]):!0===a?(r.flipEnable(-1),i=[]):a.map(function(e){for(var a,l=0;l<i.length;l+=1)if(r.isTimeExact(e,i[l])){a=!0;break}a||(n.isInteger(e)||n.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&i.push(e)}),i},r.prototype.activate=function(e,a){var r=this,i=r.item.disable,l=i.length;return"flip"==a?r.flipEnable():!0===a?(r.flipEnable(1),i=[]):!1===a?(r.flipEnable(-1),i=[]):a.map(function(e){var a,s,o,u;for(o=0;o<l;o+=1){if(s=i[o],r.isTimeExact(s,e)){a=i[o]=null,u=!0;break}if(r.isTimeOverlap(s,e)){t.isPlainObject(e)?(e.inverted=!0,a=e):t.isArray(e)?(a=e)[2]||a.push("inverted"):n.isDate(e)&&(a=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(a)for(o=0;o<l;o+=1)if(r.isTimeExact(i[o],e)){i[o]=null;break}if(u)for(o=0;o<l;o+=1)if(r.isTimeOverlap(i[o],e)){i[o]=null;break}a&&i.push(a)}),i.filter(function(e){return null!=e})},r.prototype.i=function(e,t){return n.isInteger(t)&&t>0?t:this.item.interval},r.prototype.nodes=function(e){var t=this,a=t.settings,r=t.item.select,i=t.item.highlight,l=t.item.view,s=t.item.disable;return n.node("ul",n.group({min:t.item.min.pick,max:t.item.max.pick,i:t.item.interval,node:"li",item:function(e){var o,u=(e=t.create(e)).pick,c=r&&r.pick==u,d=i&&i.pick==u,p=s&&t.disabled(e);return[n.trigger(t.formats.toString,t,[n.trigger(a.formatLabel,t,[e])||a.format,e]),(o=[a.klass.listItem],c&&o.push(a.klass.selected),d&&o.push(a.klass.highlighted),l&&l.pick==u&&o.push(a.klass.viewset),p&&o.push(a.klass.disabled),o.join(" ")),"data-pick="+e.pick+" "+n.ariaAttr({role:"option",selected:!(!c||t.$node.val()!==n.trigger(t.formats.toString,t,[a.format,e]))||null,activedescendant:!!d||null,disabled:!!p||null})]}})+n.node("li",n.node("button",a.clear,a.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+n.ariaAttr({controls:t.$node[0].id})),"",n.ariaAttr({role:"presentation"})),a.klass.list,n.ariaAttr({role:"listbox",controls:t.$node[0].id}))},r.defaults={clear:"Clear",format:"h:i A",interval:30,klass:{picker:(a=e.klasses().picker)+" "+a+"--time",holder:a+"__holder",list:a+"__list",listItem:a+"__list-item",disabled:a+"__list-item--disabled",selected:a+"__list-item--selected",highlighted:a+"__list-item--highlighted",viewset:a+"__list-item--viewset",now:a+"__list-item--now",buttonClear:a+"__button--clear"}},e.extend("pickatime",r)},"object"==r(t)?e.exports=n(a(23),a(22)):n(Picker,jQuery)},function(e,t,a){var n,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*!
 * Date picker for pickadate.js v3.5.4
 * http://amsul.github.io/pickadate.js/date.htm
 */
n=function(e,t){var a,n=e._;function r(e,t){var a,n=this,r=e.$node[0],i=r.value,l=e.$node.data("value"),s=l||i,o=l?t.formatSubmit:t.format,u=function(){return r.currentStyle?"rtl"==r.currentStyle.direction:"rtl"==getComputedStyle(e.$root[0]).direction};n.settings=t,n.$node=e.$node,n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},n.item={},n.item.clear=null,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-(!0===(a=n.item.disable)[0]?a.shift():-1),n.set("min",t.min).set("max",t.max).set("now"),s?n.set("select",s,{format:o}):n.set("select",null).set("highlight",n.item.now),n.key={40:7,38:-7,39:function(){return u()?-1:1},37:function(){return u()?1:-1},go:function(e){var t=n.item.highlight,a=new Date(Date.UTC(t.year,t.month,t.date+e));n.set("highlight",a,{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){var a=this.value;a&&(e.set("highlight",[e.get("view").year,a,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus"))}),e.$root.find("."+t.klass.selectYear).on("change",function(){var a=this.value;a&&(e.set("highlight",[a,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus"))})},1).on("open",function(){var a="";n.disabled(n.get("now"))&&(a=":not(."+t.klass.buttonToday+")"),e.$root.find("button"+a+", select").attr("disabled",!1)},1).on("close",function(){e.$root.find("button, select").attr("disabled",!0)},1)}r.prototype.set=function(e,t,a){var n=this,r=n.item;return null===t?("clear"==e&&(e="select"),r[e]=t,n):(r["enable"==e?"disable":"flip"==e?"enable":e]=n.queue[e].split(" ").map(function(r){return t=n[r](e,t,a)}).pop(),"select"==e?n.set("highlight",r.select,a):"highlight"==e?n.set("view",r.highlight,a):e.match(/^(flip|min|max|disable|enable)$/)&&(r.select&&n.disabled(r.select)&&n.set("select",r.select,a),r.highlight&&n.disabled(r.highlight)&&n.set("highlight",r.highlight,a)),n)},r.prototype.get=function(e){return this.item[e]},r.prototype.create=function(e,a,r){var i;return(a=void 0===a?e:a)==-1/0||a==1/0?i=a:t.isPlainObject(a)&&n.isInteger(a.pick)?a=a.obj:t.isArray(a)?(a=new Date(Date.UTC(a[0],a[1],a[2])),a=n.isDate(a)?a:this.create().obj):a=n.isInteger(a)?this.normalize(new Date(a),r):n.isDate(a)?this.normalize(a,r):this.now(e,a,r),{year:i||a.getUTCFullYear(),month:i||a.getUTCMonth(),date:i||a.getUTCDate(),day:i||a.getUTCDay(),obj:i||a,pick:i||a.getTime()}},r.prototype.createRange=function(e,a){var r=this,i=function(e){return!0===e||t.isArray(e)||n.isDate(e)?r.create(e):e};return n.isInteger(e)||(e=i(e)),n.isInteger(a)||(a=i(a)),n.isInteger(e)&&t.isPlainObject(a)?e=[a.year,a.month,a.date+e]:n.isInteger(a)&&t.isPlainObject(e)&&(a=[e.year,e.month,e.date+a]),{from:i(e),to:i(a)}},r.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},r.prototype.overlapRanges=function(e,t){return e=this.createRange(e.from,e.to),t=this.createRange(t.from,t.to),this.withinRange(e,t.from)||this.withinRange(e,t.to)||this.withinRange(t,e.from)||this.withinRange(t,e.to)},r.prototype.now=function(e,t,a){return t=new Date,a&&a.rel&&t.setUTCDate(t.getUTCDate()+a.rel),this.normalize(t,a)},r.prototype.navigate=function(e,a,n){var r,i,l,s,o=t.isArray(a),u=t.isPlainObject(a),c=this.item.view;if(o||u){for(u?(i=a.year,l=a.month,s=a.date):(i=+a[0],l=+a[1],s=+a[2]),n&&n.nav&&c&&c.month!==l&&(i=c.year,l=c.month),i=(r=new Date(Date.UTC(i,l+(n&&n.nav?n.nav:0),1))).getUTCFullYear(),l=r.getUTCMonth();new Date(Date.UTC(i,l,s)).getUTCMonth()!==l;)s-=1;a=[i,l,s]}return a},r.prototype.normalize=function(e){return e.setUTCHours(0,0,0,0),e},r.prototype.measure=function(e,t){return t?"string"==typeof t?t=this.parse(e,t):n.isInteger(t)&&(t=this.now(e,t,{rel:t})):t="min"==e?-1/0:1/0,t},r.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},r.prototype.validate=function(e,a,r){var i,l,s,o,u=this,c=a,d=r&&r.interval?r.interval:1,p=-1===u.item.enable,f=u.item.min,h=u.item.max,m=p&&u.item.disable.filter(function(e){if(t.isArray(e)){var r=u.create(e).pick;r<a.pick?i=!0:r>a.pick&&(l=!0)}return n.isInteger(e)}).length;if((!r||!r.nav)&&(!p&&u.disabled(a)||p&&u.disabled(a)&&(m||i||l)||!p&&(a.pick<=f.pick||a.pick>=h.pick)))for(p&&!m&&(!l&&d>0||!i&&d<0)&&(d*=-1);u.disabled(a)&&(Math.abs(d)>1&&(a.month<c.month||a.month>c.month)&&(a=c,d=d>0?1:-1),a.pick<=f.pick?(s=!0,d=1,a=u.create([f.year,f.month,f.date+(a.pick===f.pick?0:-1)])):a.pick>=h.pick&&(o=!0,d=-1,a=u.create([h.year,h.month,h.date+(a.pick===h.pick?0:1)])),!s||!o);)a=u.create([a.year,a.month,a.date+d]);return a},r.prototype.disabled=function(e){var a=this,r=a.item.disable.filter(function(r){return n.isInteger(r)?e.day===(a.settings.firstDay?r:r-1)%7:t.isArray(r)||n.isDate(r)?e.pick===a.create(r).pick:t.isPlainObject(r)?a.withinRange(r,e):void 0});return r=r.length&&!r.filter(function(e){return t.isArray(e)&&"inverted"==e[3]||t.isPlainObject(e)&&e.inverted}).length,-1===a.item.enable?!r:r||e.pick<a.item.min.pick||e.pick>a.item.max.pick},r.prototype.parse=function(e,t,a){var r=this,i={};return t&&"string"==typeof t?(a&&a.format||((a=a||{}).format=r.settings.format),r.formats.toArray(a.format).map(function(e){var a=r.formats[e],l=a?n.trigger(a,r,[t,i]):e.replace(/^!/,"").length;a&&(i[e]=t.substr(0,l)),t=t.substr(l)}),[i.yyyy||i.yy,+(i.mm||i.m)-1,i.dd||i.d]):t},r.prototype.formats=function(){function e(e,t,a){var n=e.match(/\w+/)[0];return a.mm||a.m||(a.m=t.indexOf(n)+1),n.length}function t(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?n.digits(e):t.date},dd:function(e,t){return e?2:n.lead(t.date)},ddd:function(e,a){return e?t(e):this.settings.weekdaysShort[a.day]},dddd:function(e,a){return e?t(e):this.settings.weekdaysFull[a.day]},m:function(e,t){return e?n.digits(e):t.month+1},mm:function(e,t){return e?2:n.lead(t.month+1)},mmm:function(t,a){var n=this.settings.monthsShort;return t?e(t,n,a):n[a.month]},mmmm:function(t,a){var n=this.settings.monthsFull;return t?e(t,n,a):n[a.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var a=this;return a.formats.toArray(e).map(function(e){return n.trigger(a.formats[e],a,[0,t])||e.replace(/^!/,"")}).join("")}}}(),r.prototype.isDateExact=function(e,a){return n.isInteger(e)&&n.isInteger(a)||"boolean"==typeof e&&"boolean"==typeof a?e===a:(n.isDate(e)||t.isArray(e))&&(n.isDate(a)||t.isArray(a))?this.create(e).pick===this.create(a).pick:!(!t.isPlainObject(e)||!t.isPlainObject(a))&&(this.isDateExact(e.from,a.from)&&this.isDateExact(e.to,a.to))},r.prototype.isDateOverlap=function(e,a){var r=this.settings.firstDay?1:0;return n.isInteger(e)&&(n.isDate(a)||t.isArray(a))?(e=e%7+r)===this.create(a).day+1:n.isInteger(a)&&(n.isDate(e)||t.isArray(e))?(a=a%7+r)===this.create(e).day+1:!(!t.isPlainObject(e)||!t.isPlainObject(a))&&this.overlapRanges(e,a)},r.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},r.prototype.deactivate=function(e,a){var r=this,i=r.item.disable.slice(0);return"flip"==a?r.flipEnable():!1===a?(r.flipEnable(1),i=[]):!0===a?(r.flipEnable(-1),i=[]):a.map(function(e){for(var a,l=0;l<i.length;l+=1)if(r.isDateExact(e,i[l])){a=!0;break}a||(n.isInteger(e)||n.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&i.push(e)}),i},r.prototype.activate=function(e,a){var r=this,i=r.item.disable,l=i.length;return"flip"==a?r.flipEnable():!0===a?(r.flipEnable(1),i=[]):!1===a?(r.flipEnable(-1),i=[]):a.map(function(e){var a,s,o,u;for(o=0;o<l;o+=1){if(s=i[o],r.isDateExact(s,e)){a=i[o]=null,u=!0;break}if(r.isDateOverlap(s,e)){t.isPlainObject(e)?(e.inverted=!0,a=e):t.isArray(e)?(a=e)[3]||a.push("inverted"):n.isDate(e)&&(a=[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),"inverted"]);break}}if(a)for(o=0;o<l;o+=1)if(r.isDateExact(i[o],e)){i[o]=null;break}if(u)for(o=0;o<l;o+=1)if(r.isDateOverlap(i[o],e)){i[o]=null;break}a&&i.push(a)}),i.filter(function(e){return null!=e})},r.prototype.nodes=function(e){var t,a,r=this,i=r.settings,l=r.item,s=l.now,o=l.select,u=l.highlight,c=l.view,d=l.disable,p=l.min,f=l.max,h=(t=(i.showWeekdaysFull?i.weekdaysFull:i.weekdaysShort).slice(0),a=i.weekdaysFull.slice(0),i.firstDay&&(t.push(t.shift()),a.push(a.shift())),n.node("thead",n.node("tr",n.group({min:0,max:6,i:1,node:"th",item:function(e){return[t[e],i.klass.weekdays,'scope=col title="'+a[e]+'"']}})))),m=function(e){return n.node("div"," ",i.klass["nav"+(e?"Next":"Prev")]+(e&&c.year>=f.year&&c.month>=f.month||!e&&c.year<=p.year&&c.month<=p.month?" "+i.klass.navDisabled:""),"data-nav="+(e||-1)+" "+n.ariaAttr({role:"button",controls:r.$node[0].id+"_table"})+' title="'+(e?i.labelMonthNext:i.labelMonthPrev)+'"')},v=function(){var t=i.showMonthsShort?i.monthsShort:i.monthsFull;return i.selectMonths?n.node("select",n.group({min:0,max:11,i:1,node:"option",item:function(e){return[t[e],0,"value="+e+(c.month==e?" selected":"")+(c.year==p.year&&e<p.month||c.year==f.year&&e>f.month?" disabled":"")]}}),i.klass.selectMonth,(e?"":"disabled")+" "+n.ariaAttr({controls:r.$node[0].id+"_table"})+' title="'+i.labelMonthSelect+'"'):n.node("div",t[c.month],i.klass.month)},y=function(){var t=c.year,a=!0===i.selectYears?5:~~(i.selectYears/2);if(a){var l=p.year,s=f.year,o=t-a,u=t+a;if(l>o&&(u+=l-o,o=l),s<u){var d=o-l,h=u-s;o-=d>h?h:d,u=s}return n.node("select",n.group({min:o,max:u,i:1,node:"option",item:function(e){return[e,0,"value="+e+(t==e?" selected":"")]}}),i.klass.selectYear,(e?"":"disabled")+" "+n.ariaAttr({controls:r.$node[0].id+"_table"})+' title="'+i.labelYearSelect+'"')}return n.node("div",t,i.klass.year)};return n.node("div",(i.selectYears?y()+v():v()+y())+m()+m(1),i.klass.header)+n.node("table",h+n.node("tbody",n.group({min:0,max:5,i:1,node:"tr",item:function(e){var t=i.firstDay&&0===r.create([c.year,c.month,1]).day?-7:0;return[n.group({min:7*e-c.day+t+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(e){e=r.create([c.year,c.month,e+(i.firstDay?1:0)]);var t,a=o&&o.pick==e.pick,l=u&&u.pick==e.pick,h=d&&r.disabled(e)||e.pick<p.pick||e.pick>f.pick;return[n.node("div",e.date,(t=[i.klass.day],t.push(c.month==e.month?i.klass.infocus:i.klass.outfocus),s.pick==e.pick&&t.push(i.klass.now),a&&t.push(i.klass.selected),l&&t.push(i.klass.highlighted),h&&t.push(i.klass.disabled),t.join(" ")),"data-pick="+e.pick+" "+n.ariaAttr({role:"gridcell",selected:!(!a||r.$node.val()!==n.trigger(r.formats.toString,r,[i.format,e]))||null,activedescendant:!!l||null,disabled:!!h||null})),"",n.ariaAttr({role:"presentation"})]}})]}})),i.klass.table,'id="'+r.$node[0].id+'_table" '+n.ariaAttr({role:"grid",controls:r.$node[0].id,readonly:!0}))+n.node("div",n.node("button",i.today,i.klass.buttonToday,"type=button data-pick="+s.pick+(e&&!r.disabled(s)?"":" disabled")+" "+n.ariaAttr({controls:r.$node[0].id}))+n.node("button",i.clear,i.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+n.ariaAttr({controls:r.$node[0].id}))+n.node("button",i.close,i.klass.buttonClose,"type=button data-close=true "+(e?"":" disabled")+" "+n.ariaAttr({controls:r.$node[0].id})),i.klass.footer)},r.defaults={labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",format:"d mmmm, yyyy",klass:{table:(a=e.klasses().picker+"__")+"table",header:a+"header",navPrev:a+"nav--prev",navNext:a+"nav--next",navDisabled:a+"nav--disabled",month:a+"month",year:a+"year",selectMonth:a+"select--month",selectYear:a+"select--year",weekdays:a+"weekday",day:a+"day",disabled:a+"day--disabled",selected:a+"day--selected",highlighted:a+"day--highlighted",now:a+"day--today",infocus:a+"day--infocus",outfocus:a+"day--outfocus",footer:a+"footer",buttonClear:a+"button--clear",buttonToday:a+"button--today",buttonClose:a+"button--close"}},e.extend("pickadate",r)},"object"==r(t)?e.exports=n(a(23),a(22)):n(Picker,jQuery)},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(1)),r=o(a(0)),i=o(a(9)),l=o(a(34)),s=o(a(33));o(a(3)),o(a(4));function o(e){return e&&e.__esModule?e:{default:e}}var u=n.default.createClass({displayName:"AbsolutePicker",setDate:function(e,t){var a=this.props.time,n=new Date(a.end),l=r.default.cloneDeep(a);"start_date"===e&&t>n&&(l.end=""),l[e]=new Date((0,i.default)(new Date(t)).format("ll")+" "+(0,i.default)(a[e]).format("h:mm A")),this.props.handleChange("time",l)},handleDateBlur:function(e){var t=e.target.name,a=e.target.value;this.setDate(t,a)},setTime:function(e,t){var a=this.props.time,n=r.default.cloneDeep(a);n[e]=new Date((0,i.default)(a[e]).format("ll")+" "+(0,i.default)(new Date(t)).format("h:mm A")),this.props.handleChange("time",n)},render:function(){var e=this.props.time;return n.default.createElement("div",{className:"absolute-timeframe-picker"},n.default.createElement("div",{className:"row"},n.default.createElement("div",{className:"col-xs-2"},n.default.createElement("label",null,"Start")),n.default.createElement("div",{className:"col-xs-5 form-collapse-right"},n.default.createElement(l.default,{ref:"start-date",value:(0,i.default)(e.start).format("ll"),name:"start",placeholder:"Date",onBlur:this.handleDateBlur,onSet:this.setDate})),n.default.createElement("div",{className:"col-xs-5 form-collapse-left"},n.default.createElement(s.default,{ref:"start-time",value:(0,i.default)(e.start).format("h:mm A"),name:"start",placeholder:"Time",handleBlur:this.setTime,handleSelection:this.setTime}))),n.default.createElement("div",{className:"row"},n.default.createElement("div",{className:"col-xs-2"},n.default.createElement("label",null,"End")),n.default.createElement("div",{className:"col-xs-5 form-collapse-right"},n.default.createElement(l.default,{ref:"end-date",value:(0,i.default)(e.end).format("ll"),minimum:(0,i.default)(e.start).format("ll"),name:"end",placeholder:"Date",onBlur:this.handleDateBlur,onSet:this.setDate})),n.default.createElement("div",{className:"col-xs-5 form-collapse-left"},n.default.createElement(s.default,{ref:"end-time",value:(0,i.default)(e.end).format("h:mm A"),name:"end",placeholder:"Time",handleBlur:this.setTime,handleSelection:this.setTime}))))}});t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(1)),r=(d(a(0)),d(a(36))),i=d(a(35)),l=d(a(14)),s=d(a(27)),o=d(a(32)),u=d(a(8)),c=d(a(6));function d(e){return e&&e.__esModule?e:{default:e}}var p=n.default.createClass({displayName:"FunnelStep",propTypes:{index:n.default.PropTypes.number.isRequired,step:n.default.PropTypes.object.isRequired,eventCollections:n.default.PropTypes.array.isRequired,propertyNames:n.default.PropTypes.array.isRequired,onBrowseEvents:n.default.PropTypes.func.isRequired,getPropertyType:n.default.PropTypes.func.isRequired,moveStep:n.default.PropTypes.func.isRequired,removeStep:n.default.PropTypes.func.isRequired,handleChange:n.default.PropTypes.func.isRequired,toggleStepActive:n.default.PropTypes.func.isRequired,handleFilterChange:n.default.PropTypes.func.isRequired,handleAddFilter:n.default.PropTypes.func.isRequired,handleRemoveFilter:n.default.PropTypes.func.isRequired},removeStep:function(e){e.preventDefault(),this.props.canRemove&&confirm("Are you sure you want to delete this funnel step?")&&this.props.removeStep(this.props.index)},handleChange:function(e,t){this.props.handleChange(this.props.index,e,t)},handleChangeWithEvent:function(e){e.preventDefault(),this.props.handleChange(this.props.index,e.target.name,e.target.value)},handleCheckboxChange:function(e){this.props.handleChange(this.props.index,e.target.name,e.target.checked)},toggleStepActive:function(e){this.props.toggleStepActive(this.props.index,!this.props.step.active)},handleFiltersToggle:function(){this.refs["filter-manager"].open()},handleAddFilter:function(){this.props.handleAddFilter(this.props.index)},handleRemoveFilter:function(e){this.props.handleRemoveFilter(this.props.index,e)},handleFilterChange:function(e,t){this.props.handleFilterChange(this.props.index,e,t)},moveStepUp:function(e){e.preventDefault(),e.stopPropagation(),this.props.moveStep(this.props.index,"up")},moveStepDown:function(e){e.preventDefault(),e.stopPropagation(),this.props.moveStep(this.props.index,"down")},buildStepBody:function(){var e,t;if(this.props.canRemove&&(e=n.default.createElement("a",{href:"#",className:"remove-step",onClick:this.removeStep},n.default.createElement("i",{className:"icon glyphicon glyphicon-remove-circle margin-right-tiny"}),"Remove Step")),this.props.notice&&(t=n.default.createElement(s.default,{notice:this.props.notice,closable:!1})),!0===this.props.step.active)return n.default.createElement("div",{className:"step-body margin-top-small margin-bottom-small"},t,n.default.createElement(r.default,{name:"event_collection",label:"Event Collection",value:this.props.step.event_collection,options:this.props.eventCollections,requiredLabel:!0,onBrowseEvents:this.props.onBrowseEvents,handleChange:this.handleChange}),n.default.createElement(r.default,{name:"actor_property",label:"Actor Property",value:this.props.step.actor_property,options:this.props.propertyNames,requiredLabel:!0,handleChange:this.handleChange}),n.default.createElement(i.default,{ref:"timeframe",time:this.props.step.time,timezone:this.props.step.timezone,handleChange:this.handleChange}),n.default.createElement("div",{className:"field-component"},n.default.createElement(l.default,{ref:"filters-fields-toggle",name:"Filters",toggleCallback:this.handleFiltersToggle,fieldsCount:u.default.validFilters(this.props.step.filters).length})),n.default.createElement(o.default,{ref:"filter-manager",eventCollection:this.props.step.event_collection,filters:this.props.step.filters,handleChange:this.handleFilterChange,removeFilter:this.handleRemoveFilter,addFilter:this.handleAddFilter,getPropertyType:this.props.getPropertyType,propertyNames:this.props.propertyNames}),n.default.createElement("label",{className:"block-label margin-top-small"},n.default.createElement("input",{name:"optional",type:"checkbox",checked:this.props.step.optional,onChange:this.handleCheckboxChange})," Optional Step"),n.default.createElement("label",{className:"block-label"},n.default.createElement("input",{name:"inverted",type:"checkbox",checked:this.props.step.inverted,onChange:this.handleCheckboxChange})," Inverted Step"),n.default.createElement("label",{className:"block-label"},n.default.createElement("input",{name:"with_actors",type:"checkbox",checked:this.props.step.with_actors,onChange:this.handleCheckboxChange})," With Actors"),n.default.createElement("hr",null),e)},render:function(){var e=(0,c.default)({"funnel-step":!0,active:this.props.step.active});return n.default.createElement("div",{className:e},n.default.createElement("div",{className:"step-header clearfix",onClick:this.toggleStepActive,role:"step-header"},n.default.createElement("div",{className:"step-move-btns"},n.default.createElement("a",{href:"#",className:"up",onClick:this.moveStepUp,role:"move-step"},n.default.createElement("span",{className:"arrow"})),n.default.createElement("a",{href:"#",className:"down",onClick:this.moveStepDown,role:"move-step"},n.default.createElement("span",{className:"arrow"}))),n.default.createElement("div",{className:"step-number"},this.props.index+1),n.default.createElement("div",{className:"step-name"},"Step ",this.props.index+1)),this.buildStepBody())}});t.default=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(1)),r=s(a(0)),i=s(a(60)),l=s(a(4));function s(e){return e&&e.__esModule?e:{default:e}}var o=n.default.createClass({displayName:"FunnelsBuilder",propTypes:{modelId:n.default.PropTypes.string.isRequired,eventCollections:n.default.PropTypes.array.isRequired,steps:n.default.PropTypes.array.isRequired,stepNotices:n.default.PropTypes.array.isRequired,onBrowseEvents:n.default.PropTypes.func.isRequired,getEventPropertyNames:n.default.PropTypes.func.isRequired,getPropertyType:n.default.PropTypes.func.isRequired},handleChange:function(e,t,a){var n={};n[t]=a,l.default.updateStep(this.props.modelId,e,n)},addStep:function(e){e.preventDefault(),l.default.addStep(this.props.modelId)},removeStep:function(e){l.default.removeStep(this.props.modelId,e)},handleAddFilter:function(e){l.default.addStepFilter(this.props.modelId,e)},handleRemoveFilter:function(e,t){l.default.removeStepFilter(this.props.modelId,e,t)},handleFilterChange:function(e,t,a){l.default.updateStepFilter(this.props.modelId,e,t,a)},toggleStepActive:function(e,t){t?l.default.setStepActive(this.props.modelId,e):l.default.updateStep(this.props.modelId,e,{active:!1})},moveStep:function(e,t){l.default.moveStep(this.props.modelId,e,t)},buildSteps:function(){return this.props.steps.map(function(e,t){var a=r.default.find(this.props.stepNotices,{stepIndex:t});return n.default.createElement("li",{key:t},n.default.createElement(i.default,{index:t,step:e,notice:a,removeStep:this.removeStep,canRemove:this.props.steps.length>1,eventCollections:this.props.eventCollections,propertyNames:this.props.getEventPropertyNames(e.event_collection),onBrowseEvents:this.props.onBrowseEvents,toggleStepActive:this.toggleStepActive,handleChange:this.handleChange,handleAddFilter:this.handleAddFilter,handleRemoveFilter:this.handleRemoveFilter,handleFilterChange:this.handleFilterChange,getPropertyType:this.props.getPropertyType,handleFiltersToggle:this.handleFiltersToggle,moveStep:this.moveStep}))}.bind(this))},render:function(){return n.default.createElement("div",{className:"funnel-builder margin-top-small"},n.default.createElement("h4",null,"Steps"),n.default.createElement("ul",{className:"steps"},this.buildSteps()),n.default.createElement("a",{href:"#",className:"add-step",onClick:this.addStep},n.default.createElement("i",{className:"icon glyphicon glyphicon-plus-sign margin-right-tiny"}),"Add a step"))}});t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(13));i(a(3));function i(e){return e&&e.__esModule?e:{default:e}}var l=n.default.createClass({displayName:"LatestField",render:function(){return n.default.createElement("div",{className:"form-group"},n.default.createElement(r.default,{type:"text",name:"latest",label:"Limit number of events to extract",value:this.props.latest,placeholder:"Eg: 1000",onChange:this.props.handleChange}),n.default.createElement("small",{className:"text-muted"},n.default.createElement("span",{className:"icon glyphicon glyphicon-info-sign"}),n.default.createElement("span",null,"Results are limited to 10 million events")))}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),l=(n=i)&&n.__esModule?n:{default:n};var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={open:!1,id:"react-multi-select",focusedIndex:0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),r(t,[{key:"interceptEvent",value:function(e){e&&(e.preventDefault(),e.stopPropagation())}},{key:"_toggleOpenClose",value:function(e){if(this.interceptEvent(e),this.state.open)return this.setState({open:!1});this.setState({open:!0})}},{key:"_isSelected",value:function(e){return this.props.items.filter(function(t){return!(t.value!==e||!t.selected)}).length>0}},{key:"_handleOptionChange",value:function(e){this.interceptEvent(e),this.props.handleChange(this.props.name,e.target.text,!this._isSelected(e.target.text))}},{key:"_renderOption",value:function(e,t){var a="react-select-box-option";return t===this.state.focusedIndex&&(a+=" react-select-box-option-focused"),e.selected&&(a+=" react-select-box-option-selected"),l.default.createElement("a",{id:this.state.id+"-"+t,className:a,href:"#",onClick:this._handleOptionChange.bind(this),title:e.label,key:t+"_"+e.label},e.label)}},{key:"_renderOptionMenu",value:function(){var e=this,t="react-select-box-options";this.state.open||(t+=" react-select-box-hidden");var a=this.props.items.map(function(t,a){return e._renderOption({value:t.value,selected:t.selected,label:t.value},a)});return l.default.createElement("div",{className:t,ref:"menu"},a)}},{key:"render",value:function(){var e=this.props.items.filter(function(e){return e.selected}),t=e.length>0?e.map(function(e){return e.value}).join(", "):this.props.label;return l.default.createElement("div",{className:"react-select-box-container react-select-box-multi"},l.default.createElement("button",{id:this.state.id,onClick:this._toggleOpenClose.bind(this),className:"react-select-box"},l.default.createElement("div",{className:"react-select-box-label"},t)),this._renderOptionMenu())}}]),t}();t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=u(a(1)),i=u(a(3)),l=u(a(13)),s=u(a(63)),o=u(a(62));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),n(t,[{key:"_getExtractionKeys",value:function(){var e=this;if(void 0===this.props.projectSchema)return!1;var t=this.props.projectSchema[this.props.event_collection];return void 0!==t&&(!(!t.sortedProperties||!t.sortedProperties.length)&&t.sortedProperties.map(function(t){return{value:t,selected:e.props.property_names.indexOf(t)>-1}}))}},{key:"_handlePropertyNamesChange",value:function(e,t,a){var n=this.props.property_names.slice(0);a?n.push(t):n=n.filter(function(e){return e!==t}),this.props.handleChange(e,n)}},{key:"render",value:function(){var e=void 0,t=void 0,a=void 0;return this.props.isEmail&&(e=r.default.createElement(l.default,{type:"text",name:"email",label:"Recipient email address",placeholder:"your@email.com",required:"true",value:this.props.email,onChange:this.props.handleChangeWithEvent}),t=r.default.createElement(o.default,{latest:this.props.latest,handleChange:this.props.handleChangeWithEvent})),this._getExtractionKeys()&&(a=r.default.createElement(s.default,{name:"property_names",label:"Filter extraction properties",handleChange:this._handlePropertyNamesChange.bind(this),items:this._getExtractionKeys()})),r.default.createElement("div",{className:"field-component"},r.default.createElement("div",{className:"extraction-options"},r.default.createElement("label",null,r.default.createElement("input",{type:"radio",name:"extraction_type",value:"immediate",onChange:this.props.setExtractionType,checked:!this.props.isEmail})," Preview latest ",i.default.EXRACTION_EVENT_LIMIT," events now"),r.default.createElement("label",null,r.default.createElement("input",{type:"radio",name:"extraction_type",value:"email",onChange:this.props.setExtractionType,checked:this.props.isEmail})," Bulk CSV extraction by email"),e,t,a))}}]),t}();t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),r=(l(a(0)),l(a(14))),i=l(a(10));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"GroupByField",focusOnReactSelect:function(e){if(e&&!this.props.value){var t=this;setTimeout(function(){t.refs.select.refs.input.focus()},100)}},multiGroupToggle:function(){var e=this.props.value.length>1?"remove":"plus",t=this.props.value.length>1?"Remove second property":"Group by a second property";return n.default.createElement("a",{className:"double-groupby-toggle",href:"#",onClick:this.toggleMultiGroupBy},n.default.createElement("i",{className:"margin-right-bump icon glyphicon glyphicon-"+e}),t)},secondField:function(){if(this.props.value.length>1)return n.default.createElement(i.default,{ref:"select",inputClasses:"group-by form-control margin-bottom-tiny",wrapClasses:"margin-top-tiny",name:"group_by.1",items:this.props.options,handleChange:this.handleChange,value:this.props.value[1]||"",sort:!0})},getGroupBy:function(){return this.props.value},handleChange:function(e,t){var a=this.props.value.slice();a[e.split(".")[1]]=t,this.props.handleChange("group_by",a)},toggleMultiGroupBy:function(e){var t;switch(e.preventDefault(),this.props.value.length){case 0:t=["",""];break;case 1:t=this.props.value.concat([""]);break;case 2:t=this.props.value.slice(0,1)}this.props.handleChange("group_by",t)},shouldBeOpen:function(){return this.props.value&&this.props.value[0]},render:function(){return n.default.createElement("div",{className:"field-component"},n.default.createElement(r.default,{ref:"toggle",name:"Group By",initialOpenState:this.shouldBeOpen(),updateFn:this.props.updateGroupBy,getFn:this.getGroupBy,attrsToStore:"group_by",resetValues:{group_by:[]},toggleCallback:this.focusOnReactSelect},n.default.createElement(i.default,{ref:"select",inputClasses:"group-by form-control margin-bottom-tiny",name:"group_by.0",items:this.props.options,handleChange:this.handleChange,value:this.props.value[0]||"",sort:!0}),this.secondField(),this.multiGroupToggle()))}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=(i(a(0)),i(a(13)));function i(e){return e&&e.__esModule?e:{default:e}}var l=n.default.createClass({displayName:"PercentileField",render:function(){return n.default.createElement("div",{className:"field-component"},n.default.createElement(r.default,{ref:"input",label:"Percentile Value",classes:"percentile",name:"percentile",required:"true",placeholder:"Ex: 50",onChange:this.props.onChange,value:this.props.value||""}))}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(a(0)),r=y(a(1)),i=y(a(14)),l=y(a(36)),s=y(a(66)),o=y(a(65)),u=y(a(64)),c=y(a(61)),d=y(a(35)),p=y(a(51)),f=(y(a(13)),y(a(50))),h=(y(a(11)),y(a(3))),m=y(a(8)),v=y(a(4));function y(e){return e&&e.__esModule?e:{default:e}}var g=r.default.createClass({displayName:"QueryBuilder",handleSelectionWithEvent:function(e){this.handleChange(e.target.name,e.target.value)},handleChange:function(e,t){var a={query:{}};if(n.default.isPlainObject(e))for(key in e)a.query[key]=e[key];else a.query[e]=t;v.default.update(this.props.model.id,a)},updateGroupBy:function(e){v.default.update(this.props.model.id,{query:e})},handleRevertChanges:function(e){e.preventDefault(),v.default.revertActiveChanges()},shouldShowRevertButton:function(){return h.default.isPersisted(this.props.model)&&this.props.model.originalModel&&this.props.model.originalModel.query&&!n.default.isEqual(this.props.model.query,this.props.model.originalModel.query)},buildEventCollectionField:function(){if("funnel"!==this.props.model.query.analysis_type)return r.default.createElement(l.default,{name:"event_collection",label:"Event Collection",value:this.props.model.query.event_collection,requiredLabel:!0,onBrowseEvents:this.props.onBrowseEvents,handleChange:this.handleChange,options:this.props.project.eventCollections})},buildExtractionOptions:function(){if("extraction"===this.props.model.query.analysis_type)return r.default.createElement(u.default,{latest:this.props.model.query.latest,email:this.props.model.query.email,property_names:this.props.model.query.property_names,event_collection:this.props.model.query.event_collection,projectSchema:this.props.project.schema,isEmail:h.default.isEmailExtraction(this.props.model),handleChangeWithEvent:this.handleSelectionWithEvent,handleChange:this.handleChange,setExtractionType:this.props.setExtractionType})},buildGroupByField:function(){if(-1===["extraction","funnel"].indexOf(this.props.model.query.analysis_type))return r.default.createElement(o.default,{ref:"group-by-field",value:this.props.model.query.group_by,updateGroupBy:this.updateGroupBy,options:this.props.getEventPropertyNames(this.props.model.query.event_collection),handleChange:this.handleChange})},buildTargetPropertyField:function(){if(null!==this.props.model.query.analysis_type&&h.default.shouldHaveTarget(this.props.model))return r.default.createElement(l.default,{name:"target_property",label:"Target Property",inputClasses:["target-property"],requiredLabel:!0,handleChange:this.handleChange,options:this.props.getEventPropertyNames(this.props.model.query.event_collection),value:this.props.model.query.target_property,sort:!0})},buildPercentileField:function(){if("percentile"===this.props.model.query.analysis_type)return r.default.createElement(s.default,{ref:"percentile-field",value:this.props.model.query.percentile,onChange:this.handleSelectionWithEvent})},buildIntervalField:function(){if(-1===["extraction","funnel"].indexOf(this.props.model.query.analysis_type))return r.default.createElement(p.default,{interval:this.props.model.query.interval,handleChange:this.handleChange})},buildFilters:function(){if("funnel"!==this.props.model.query.analysis_type)return r.default.createElement("div",{className:"field-component"},r.default.createElement(i.default,{ref:"filters-fields-toggle",name:"Filters",toggleCallback:this.props.handleFiltersToggle,fieldsCount:m.default.validFilters(this.props.model.query.filters).length}))},buildGlobalTimeframePicker:function(){if("funnel"!==this.props.model.query.analysis_type)return r.default.createElement("div",null,r.default.createElement(d.default,{ref:"timeframe",time:this.props.model.query.time,timezone:this.props.model.query.timezone,handleChange:this.handleChange}),r.default.createElement("hr",{className:"fieldset-divider"}))},buildFunnelBuilder:function(){if("funnel"===this.props.model.query.analysis_type)return r.default.createElement(c.default,{modelId:this.props.model.id,steps:this.props.model.query.steps,stepNotices:this.props.stepNotices||[],onBrowseEvents:this.props.onBrowseEvents,eventCollections:this.props.project.eventCollections,getEventPropertyNames:this.props.getEventPropertyNames,getPropertyType:this.props.getPropertyType})},buildClearButton:function(){return this.shouldShowRevertButton()?r.default.createElement("button",{className:"btn btn-default btn-block",onClick:this.handleRevertChanges,role:"revert-query"},"Revert to original"):r.default.createElement("button",{type:"reset",role:"clear-query",className:"btn btn-default btn-block",id:"clear-explorer-query",onClick:this.props.handleClearQuery},"Clear")},render:function(){var e;return this.props.model.isValid&&(e=h.default.getApiQueryUrl(this.props.client,this.props.model)),r.default.createElement("section",{className:"query-pane-section query-builder"},r.default.createElement("form",{className:"form query-builder-form",onSubmit:this.props.handleQuerySubmit},r.default.createElement(l.default,{name:"analysis_type",label:"Analysis Type",inputClasses:["analysis-type"],options:this.props.analysisTypes,value:this.props.model.query.analysis_type,handleChange:this.handleChange,requiredLabel:!0}),this.buildEventCollectionField(),this.buildFunnelBuilder(),this.buildExtractionOptions(),this.buildTargetPropertyField(),this.buildPercentileField(),this.buildGlobalTimeframePicker(),this.buildGroupByField(),this.buildFilters(),this.buildIntervalField(),r.default.createElement("div",{className:"button-set-clear-toggle"},this.buildClearButton()),r.default.createElement(f.default,{url:e,isValid:this.props.model.isValid})))}});t.default=g},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(6));function i(e){return e&&e.__esModule?e:{default:e}}var l=n.default.createClass({displayName:"QueryPaneTabs",toggled:function(e){this.props.toggleCallback(e)},render:function(){var e,t=(0,r.default)({"query-pane-tabs clearfix":!0,"query-pane-persisted":this.props.persisted,"query-pane-new":!this.props.persisted});return this.props.persisted&&(e=n.default.createElement("li",{role:"presentation",className:"tab-new-query"},n.default.createElement("a",{ref:"new-query",href:"#",title:"Create a new query",onClick:this.props.createNewQuery},n.default.createElement("span",{className:"icon glyphicon icon-plus glyphicon-plus"})))),n.default.createElement("div",{className:t},n.default.createElement("ul",{className:"nav nav-tabs"},e,n.default.createElement("li",{role:"presentation",className:"build"===this.props.activePane?"tab-build-query active":"tab-build-query"},n.default.createElement("a",{ref:"build-tab",href:"#",id:"build-query",title:this.props.persisted?"Edit query":"Create a new query",onClick:this.toggled.bind(this,"build")},this.props.persisted?"Edit query":"Create a new query")),n.default.createElement("li",{role:"presentation",className:"browse"===this.props.activePane?"tab-browse-queries active":"tab-browse-queries"},n.default.createElement("a",{ref:"browse-tab",href:"#",id:"browse",title:"Browse saved queries",onClick:this.toggled.bind(this,"browse")},n.default.createElement("span",{className:"icon glyphicon icon-th-list glyphicon-th-list"}),"Browse"))))}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={exportToCsv:function(e,t){var a,n="data:text/csv;charset=utf-8,";e.forEach(function(t,a){t.forEach(function(e,a){n+=String(e).replace(/,/g,""),t.length>a+1&&(n+=",")}),e.length>a+1&&(n+="\n")}),(a=document.createElement("a")).setAttribute("href",encodeURI(n)),a.setAttribute("download",t),document.body.appendChild(a),a.click()}}},function(e,t){e.exports=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});l(a(0));var n=l(a(1)),r=l(a(6)),i=l(a(70));function l(e){return e&&e.__esModule?e:{default:e}}var s=n.default.createClass({displayName:"CodeSample",render:function(){var e,t=(0,r.default)({"code-sample-panel":!0,hide:this.props.hidden});return e=this.props.isValid?this.props.codeSample:"Your query is not valid right now, so we can't show you a code sample.",n.default.createElement("div",{className:t},n.default.createElement("a",{href:"#",className:"close-btn",onClick:this.props.onCloseClick},n.default.createElement("span",{className:"icon glyphicon glyphicon glyphicon-remove-circle no-margin"})),n.default.createElement("div",{className:"sample"},n.default.createElement(i.default,{className:"html"},e)))}});t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),r=i(a(26));i(a(2));function i(e){return e&&e.__esModule?e:{default:e}}var l=n.default.createClass({displayName:"KeenViz",lastDataTimestamp:null,lastChartType:null,showVisualization:function(){this.props.dataviz.destroy(),this.props.dataviz.data(this.props.model.response).el(this.refs["keen-viz"]).height(300).title(null).type(this.props.model.metadata.visualization.chart_type),"funnel"!==this.props.model.query.analysis_type&&this.props.dataviz.sortGroups("desc"),this.props.dataviz.render(),this.lastDataTimestamp=this.props.model.dataTimestamp,this.lastChartType=this.props.model.metadata.visualization.chart_type},shouldComponentUpdate:function(e,t){return this.lastChartType!==e.model.metadata.visualization.chart_type||(!this.lastDataTimestamp||this.lastDataTimestamp!==e.model.dataTimestamp)},componentDidUpdate:function(){this.showVisualization()},componentDidMount:function(){this.showVisualization()},render:function(){var e;return r.default.isTableChartType(this.props.model.metadata.visualization.chart_type)&&(e=n.default.createElement("button",{className:"btn btn-default btn-download-csv",role:"export-table",type:"button",onClick:this.props.exportToCsv},"Download CSV")),n.default.createElement("div",{ref:"keen-viz-wrapper"},n.default.createElement("div",{ref:"keen-viz"}),e)}});t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(a(0));var n=o(a(1)),r=o(a(29)),i=o(a(72)),l=o(a(3)),s=a(2);function o(e){return e&&e.__esModule?e:{default:e}}var u=n.default.createClass({displayName:"Chart",buildVizContent:function(){return this.props.model.response?l.default.isEmailExtraction(this.props.model)?n.default.createElement("div",{ref:"notice",className:"big-notice"},n.default.createElement("div",{className:"alert alert-info"},"Email extractions don't have visualizations.")):l.default.resultCanBeVisualized(this.props.model)?l.default.resultCanBeVisualized(this.props.model)?this.buildViz():void this.props.dataviz.destroy():n.default.createElement("div",{ref:"notice",className:"big-notice"},n.default.createElement("div",{className:"alert alert-danger"},n.default.createElement("span",{className:"icon glyphicon glyphicon-info-sign error"}),"Your query returned no results.")):n.default.createElement("div",{ref:"notice",className:"big-notice"},n.default.createElement("div",{className:"alert alert-info"},"Let's go exploring!"))},buildViz:function(){var e,t=this.props.model.query.analysis_type+"-viz";if(l.default.isJSONViz(this.props.model)){var a={result:this.props.model.response.result};this.props.model.response.actors&&(a.actors=this.props.model.response.actors),e=n.default.createElement("textarea",{ref:"jsonViz",className:"json-view",value:(0,s.prettyPrintJSON)(a),readOnly:!0})}else e=n.default.createElement(i.default,{model:this.props.model,dataviz:this.props.dataviz,exportToCsv:this.props.exportToCsv});return n.default.createElement("div",{className:t},e)},render:function(){var e=this.buildVizContent();return n.default.createElement("div",{className:"chart-area"},n.default.createElement(r.default,{visible:this.props.model.loading}),e)}});t.default=u},function(e,t){e.exports=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(a(0)),r=g(a(1)),i=g(a(6)),l=g(a(74)),s=g(a(15)),o=g(a(27)),u=g(a(73)),c=g(a(71)),d=g(a(7)),p=(g(a(19)),g(a(4))),f=(g(a(11)),g(a(18))),h=g(a(3)),m=g(a(26)),v=g(a(2)),y=g(a(69));function g(e){return e&&e.__esModule?e:{default:e}}var E=r.default.createClass({displayName:"Visualization",getInitialState:function(){return{focusDisplayName:!1,focusQueryName:!1,blurTimeout:100}},handleDisplayNameFocus:function(){this.setState({focusDisplayName:!0})},handleDisplayNameBlur:function(){setTimeout(function(){this.setState({focusDisplayName:!1})}.bind(this),this.state.blurTimeout)},handleQueryNameFocus:function(){this.setState({focusQueryName:!0})},handleQueryNameBlur:function(){setTimeout(function(){this.setState({focusQueryName:!1})}.bind(this),this.state.blurTimeout)},noticeClosed:function(){f.default.clearAll()},changeChartType:function(e){var t={metadata:{visualization:{chart_type:n.default.find(this.formatChartTypes(),function(t){return t.value===e.target.value}).value}}};p.default.update(this.props.model.id,t)},formatChartTypes:function(){return n.default.map(m.default.getChartTypeOptions(this.props.model.query),function(e){return{name:"JSON"!==e?v.default.toTitleCase(e).replace("chart",""):e,value:e}})},chartType:function(){return this.props.model.metadata.visualization&&this.props.model.metadata.visualization.chart_type?this.props.model.metadata.visualization.chart_type:n.default.first(m.default.getChartTypeOptions(this.props.model.query))},componentWillMount:function(){this.dataviz=new l.default},componentWillUnmount:function(){d.default.unregister(this.dispatcherToken)},exportToCsv:function(){var e=this.dataviz.dataset.matrix,t=this.props.model.query_name||"untitled-query";y.default.exportToCsv(e,t)},render:function(){var e,t,a=(0,i.default)({"chart-detail-bar":!0,"chart-detail-bar-focus":(this.state.focusDisplayName||this.state.focusQueryName)&&null!==this.props.model.response&&!this.props.model.loading,"chart-detail-active":null!==this.props.model.response&&!this.props.model.loading});return this.props.model.isValid&&(t=h.default.getSdkExample(this.props.model,this.props.client)),this.props.persistence&&(e=r.default.createElement("div",{className:"chart-title-component"},r.default.createElement("input",{className:"chart-display-name",type:"text",onChange:this.props.onDisplayNameChange,onBlur:this.handleDisplayNameBlur,onFocus:this.handleDisplayNameFocus,spellCheck:"false",value:this.props.model.metadata.display_name,placeholder:"Give your query a name..."}),r.default.createElement("div",{className:"chart-query-name"},r.default.createElement("label",null,"Saved Query Resource Name  ",r.default.createElement("a",{href:"https://keen.io/docs/api/#saved-queries",target:"_blank"},r.default.createElement("i",{className:"icon glyphicon glyphicon-question-sign"}))),r.default.createElement("input",{className:"chart-query-name",type:"text",onChange:this.props.onQueryNameChange,onBlur:this.handleQueryNameBlur,onFocus:this.handleQueryNameFocus,spellCheck:"false",value:this.props.model.query_name})))),r.default.createElement("div",{className:"visualization"},r.default.createElement(o.default,{notice:this.props.notice,closeCallback:this.noticeClosed}),r.default.createElement("div",{className:"visualization-wrapper"},r.default.createElement("div",{className:a},e,r.default.createElement("div",{className:"chart-type-component"},r.default.createElement(s.default,{label:!1,ref:"chart-type",name:"chart_type",classes:"chart-type",options:this.formatChartTypes(),handleSelection:this.changeChartType,selectedOption:this.chartType(),emptyOption:!1,disabled:this.props.model.loading}))),r.default.createElement("div",{className:"chart-component"},r.default.createElement(u.default,{model:this.props.model,dataviz:this.dataviz,exportToCsv:this.exportToCsv})),r.default.createElement(c.default,{ref:"codesample",codeSample:t,hidden:this.props.appState.codeSampleHidden,onCloseClick:this.props.toggleCodeSample,isValid:this.props.model.isValid})))}});t.default=E},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(1)),r=c(a(0)),i=c(a(6)),l=c(a(29)),s=c(a(2)),o=(c(a(5)),c(a(28))),u=c(a(40));function c(e){return e&&e.__esModule?e:{default:e}}var d=n.default.createClass({displayName:"EventBrowser",onKeyUp:function(e){13===e.keyCode&&this.selectEventCollection()},shouldFetchCollectionSchema:function(e){return!!this.props.project.schema[e]&&r.default.keys(this.props.project.schema[e].properties).length<1},selectEventCollectionClick:function(e){e.preventDefault(),this.props.selectEventCollection(this.state.activeEventCollection)},setActiveEventCollectionClick:function(e){this.setActiveEventCollection(e.target.innerText)},setActiveEventCollection:function(e){e!==this.state.activeEventCollection&&(this.setState({activeEventCollection:e}),"recentEvents"===this.state.activeView?this.fetchRecentEvents(e):this.shouldFetchCollectionSchema(e)&&o.default.fetchCollectionSchema(this.props.client,e))},modalOpened:function(){"recentEvents"===this.state.activeView?this.fetchRecentEvents():this.shouldFetchCollectionSchema(this.state.activeEventCollection)&&o.default.fetchCollectionSchema(this.props.client,this.state.activeEventCollection)},fetchRecentEvents:function(e){var t=e||this.state.activeEventCollection,a=this.props.project.schema;r.default.isEmpty(a)||!a[t]||a[t].recentEvents||a[t].loading||o.default.fetchRecentEventsForCollection(this.props.client,t)},setSearchText:function(e){this.setState({searchtext:e.target.value})},buildEventCollectionNodes:function(){return r.default.map(this.props.project.eventCollections,r.default.bind(function(e){var t=new RegExp(this.state.searchtext,"i"),a=(0,i.default)({active:this.state.activeEventCollection===e,hide:!t.test(e)});return n.default.createElement("li",{className:a,key:e},n.default.createElement("a",{href:"#",onClick:this.setActiveEventCollectionClick},e))},this))},getNavClasses:function(e){return this.state.activeView===e?"active":""},shouldShowLoader:function(){return!!this.props.project.schema[this.state.activeEventCollection]&&this.props.project.schema[this.state.activeEventCollection].loading},getRecentEvents:function(){if(!this.props.project.schema[this.state.activeEventCollection])return"";var e=this.props.project.schema[this.state.activeEventCollection].recentEvents;return e?s.default.prettyPrintJSON(e):""},getSchema:function(){var e=this.props.project.schema,t=this.state.activeEventCollection,a=e[t]?e[t].properties:{},n={};return a&&r.default.each(Object.keys(a).sort(),function(e,t){n[e]=a[e]}),s.default.prettyPrintJSON(n)||""},changeActiveView:function(e){e.preventDefault();var t=e.target.name;this.setState({activeView:t}),"recentEvents"===t&&this.fetchRecentEvents()},getInitialState:function(){return{activeView:"schema",activeEventCollection:null,searchtext:""}},componentDidMount:function(){this.state.activeEventCollection||r.default.isEmpty(this.props.project.schema)||this.setActiveEventCollection(this.props.currentEventCollection||this.props.project.eventCollections[0])},componentWillReceiveProps:function(e){r.default.isEmpty(e.project.schema)||this.state.activeEventCollection||this.setState({activeEventCollection:e.project.eventCollections[0]}),e.currentEventCollection&&e.currentEventCollection!=this.props.currentEventCollection&&this.setState({activeEventCollection:e.currentEventCollection})},render:function(){var e;e="recentEvents"===this.state.activeView?this.getRecentEvents():this.getSchema();var t=n.default.createElement("div",{className:"event-browser",onKeyUp:this.handleKeyUp},n.default.createElement("div",{className:"event-names"},n.default.createElement("div",{className:"search-box"},n.default.createElement("input",{type:"text",name:"search",ref:"search-box",placeholder:"Search...",onChange:this.setSearchText,autoComplete:"off"}),n.default.createElement("span",{className:"glyphicon glyphicon-search icon"})),n.default.createElement("ul",{className:"nav nav-pills nav-stacked event-names-list",ref:"event-names-list"},this.buildEventCollectionNodes())),n.default.createElement("div",{className:"event-browser-content"},n.default.createElement("ul",{className:"nav nav-tabs view-options"},n.default.createElement("li",{className:this.getNavClasses("schema")},n.default.createElement("a",{href:"#",name:"schema",onClick:this.changeActiveView},"Schema")),n.default.createElement("li",{className:this.getNavClasses("recentEvents")},n.default.createElement("a",{href:"#",name:"recentEvents",onClick:this.changeActiveView},"Recent Events"))),n.default.createElement("div",{ref:"event-data-wrapper",className:"event-data-wrapper"},n.default.createElement(l.default,{ref:"loader",visible:this.shouldShowLoader()}),n.default.createElement("textarea",{className:"json-view",value:e,readOnly:!0})))),a=n.default.createElement("div",{className:"alert alert-info no-margin no-collections-alert"},"There is no data to preview. This project does not have any event collections."),r=[{text:"Close"}],i=this.props.project.eventCollections.length>0?"event-browser-modal":"";return this.props.project.eventCollections.length>0&&r.push({text:"Use this Event Collection",iconName:"ok",classes:"btn-primary",onClick:this.selectEventCollectionClick}),n.default.createElement(u.default,{ref:"modal",title:"Project Event Collections",size:"large",modalClasses:i,onOpen:this.modalOpened,footerBtns:r},this.props.project.eventCollections.length>0?t:a)}});t.default=d},function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var r=S(a(1)),i=S(a(0)),l=S(a(76)),s=S(a(75)),o=S(a(68)),u=S(a(67)),c=S(a(49)),d=S(a(48)),p=S(a(47)),f=S(a(27)),h=S(a(32)),m=S(a(11)),v=S(a(4)),y=S(a(18)),g=S(a(24)),E=S(a(46)),_=S(a(42)),b=S(a(3)),C=(S(a(8)),S(a(5))),T=S(a(31));function S(e){return e&&e.__esModule?e:{default:e}}function P(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function N(){return{allPersistedExplorers:m.default.getAllPersisted(),activeExplorer:m.default.getActive(),notice:E.default.getGlobalNotice(),stepNotices:E.default.getStepNotices(),appState:_.default.getState()}}var k=r.default.createClass((P(n={displayName:"Explorer",toggleFields:function(){i.default.each(this.getFieldsToggleComponents(),function(e){if(e.component){var t=!i.default.isUndefined(e.value)&&!i.default.isNull(e.value);e.component.setState({open:t})}})},selectEventCollection:function(e){var t={query:{event_collection:e}};v.default.update(this.state.activeExplorer.id,t),this.refs["event-browser"].refs.modal.close()},savedQueryClicked:function(e){if(e.preventDefault(),this.state.activeExplorer.loading)y.default.create({icon:"info-sign",type:"warning",text:"There is already a query in progress. Wait for it to finish loading before selecting a query."});else{v.default.revertActiveChanges();var t=e.currentTarget.dataset.id;v.default.setActive(t),v.default.exec(this.props.client,t)}},removeSavedQueryClicked:function(){confirm("Are you sure you want to delete this saved query?")&&v.default.destroy(this.props.persistence,this.state.activeExplorer.id)},saveQueryClick:function(e){e.preventDefault(),v.default.save(this.props.persistence,this.state.activeExplorer.id)},cloneQueryClick:function(e){e.preventDefault(),v.default.clone(this.state.activeExplorer.id);var t=m.default.getLast();v.default.setActive(t.id),this.setState({activeQueryPane:"build"})},createNewQuery:function(e){e.preventDefault(),v.default.create();var t=m.default.getLast();v.default.setActive(t.id),this.setState({activeQueryPane:"build"})},onBrowseEvents:function(e){e.preventDefault(),this.refs["event-browser"].refs.modal.open()},handleFiltersToggle:function(){this.refs["filter-manager"].open()},onDisplayNameChange:function(e){var t={query_name:b.default.slugify(e.target.value),metadata:{display_name:e.target.value}};v.default.update(this.state.activeExplorer.id,t)},onQueryNameChange:function(e){var t=e.target.value.replace(/[^\w-]/g,"");v.default.update(this.state.activeExplorer.id,{query_name:t})},handleRevertChanges:function(e){e.preventDefault(),v.default.revertActiveChanges()},handleQuerySubmit:function(e){e.preventDefault(),b.default.isEmailExtraction(this.state.activeExplorer)?v.default.runEmailExtraction(this.props.client,this.state.activeExplorer.id):v.default.exec(this.props.client,this.state.activeExplorer.id)},setExtractionType:function(e){var t={query:{email:"email"===e.target.value?"":null}};v.default.update(this.state.activeExplorer.id,t)},handleClearQuery:function(){var e=this;setTimeout(function(){v.default.clear(e.state.activeExplorer.id)},0)},handleAddFilter:function(){v.default.addFilter(this.state.activeExplorer.id)},handleRemoveFilter:function(e){v.default.removeFilter(this.state.activeExplorer.id,e)},handleFilterChange:function(e,t){v.default.updateFilter(this.state.activeExplorer.id,e,t)},setVizWrapTop:function(e){this.refs["viz-area"].style.top=e+"px"},getSelectedIndex:function(){return this.state.activeExplorer&&b.default.isPersisted(this.state.activeExplorer)?i.default.findIndex(this.state.allPersistedExplorers,{id:this.state.activeExplorer.id}):null},toggleQueryPane:function(e){this.setState({activeQueryPane:e})}},"getSelectedIndex",function(){for(var e,t=0;t<this.state.allPersistedExplorers.length;t++)if(this.state.allPersistedExplorers[t].active){e=t;break}return e}),P(n,"toggleCodeSample",function(e){e.preventDefault(),g.default.update({codeSampleHidden:!this.state.appState.codeSampleHidden})}),P(n,"getEventPropertyNames",function(e){return C.default.getEventCollectionPropertyNames(this.props.project,e)}),P(n,"getPropertyType",function(e,t){return C.default.getPropertyType(this.props.project,e,t)}),P(n,"componentDidMount",function(){m.default.addChangeListener(this._onChange),E.default.addChangeListener(this._onChange),_.default.addChangeListener(this._onChange)}),P(n,"componentWillUnmount",function(){m.default.removeChangeListener(this._onChange),E.default.removeChangeListener(this._onChange),_.default.removeChangeListener(this._onChange),this.state.activeExplorer.query.filters.length||v.default.addFilter(this.state.activeExplorer.id)}),P(n,"getInitialState",function(){return i.default.assign(N(),{activeQueryPane:"build"})}),P(n,"render",function(){var e,t,a,n,i;return this.props.persistence&&(a=r.default.createElement(o.default,{ref:"query-pane-tabs",activePane:this.state.activeQueryPane,toggleCallback:this.toggleQueryPane,createNewQuery:this.createNewQuery,persisted:b.default.isPersisted(this.state.activeExplorer)}),-1===["extraction"].indexOf(this.state.activeExplorer.query.analysis_type)&&(e=r.default.createElement(d.default,{model:this.state.activeExplorer})),this.state.appState.fetchingPersistedExplorers?n=r.default.createElement(f.default,{notice:{icon:"info-sign",text:"Loading saved queries...",type:"info"},closable:!1}):i=r.default.createElement("h4",{className:"text-center"},"You don't have any saved queries yet.")),t=this.props.persistence&&"build"!==this.state.activeQueryPane?r.default.createElement(c.default,{ref:"query-browser",listItems:this.state.allPersistedExplorers,emptyContent:i,notice:n,clickCallback:this.savedQueryClicked,selectedIndex:this.getSelectedIndex()}):r.default.createElement(u.default,{ref:"query-builder",model:this.state.activeExplorer,originalModel:this.state.activeExplorerOriginal,client:this.props.client,project:this.props.project,onBrowseEvents:this.onBrowseEvents,handleFiltersToggle:this.handleFiltersToggle,handleRevertChanges:this.handleRevertChanges,handleQuerySubmit:this.handleQuerySubmit,setExtractionType:this.setExtractionType,handleClearQuery:this.handleClearQuery,getEventPropertyNames:this.getEventPropertyNames,getPropertyType:this.getPropertyType,analysisTypes:C.default.getConstant("ANALYSIS_TYPES"),stepNotices:this.state.stepNotices}),r.default.createElement("div",{ref:"root"},r.default.createElement("div",{className:"row"},r.default.createElement("div",{className:"col-sm-5 col-md-4 explorer-query-builder"},a,t),r.default.createElement("div",{ref:"viz-area",className:"col-sm-7 col-md-8 explorer-visualization"},r.default.createElement(s.default,{notice:this.state.notice,model:this.state.activeExplorer,client:this.props.client,project:this.props.project,persistence:this.props.persistence,onNameChange:this.onNameChange,appState:this.state.appState,toggleCodeSample:this.toggleCodeSample,onQueryNameChange:this.onQueryNameChange,onDisplayNameChange:this.onDisplayNameChange}),e,r.default.createElement(p.default,{model:this.state.activeExplorer,handleRevertChanges:this.handleRevertChanges,handleQuerySubmit:this.handleQuerySubmit,saveQueryClick:this.saveQueryClick,removeClick:this.removeSavedQueryClicked,cloneQueryClick:this.cloneQueryClick,persistence:this.props.persistence,codeSampleHidden:this.state.appState.codeSampleHidden,toggleCodeSample:this.toggleCodeSample}))),r.default.createElement(l.default,{ref:"event-browser",client:this.props.client,project:this.props.project,currentEventCollection:this.state.activeExplorer.query.event_collection,selectEventCollection:this.selectEventCollection}),r.default.createElement(h.default,{ref:"filter-manager",eventCollection:this.state.activeExplorer.query.event_collection,filters:this.state.activeExplorer.query.filters,handleChange:this.handleFilterChange,removeFilter:this.handleRemoveFilter,addFilter:this.handleAddFilter,getPropertyType:this.getPropertyType,propertyNames:this.getEventPropertyNames(this.state.activeExplorer.query.event_collection)}))}),P(n,"_onChange",function(){var e=N();this.setState(e),b.default.isPersisted(e.activeExplorer)?window.history.pushState({model:e.activeExplorer},"","?saved_query="+e.activeExplorer.id):T.default.updateSearchString(b.default.paramsForURL(e.activeExplorer))}),n));t.default=k},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(1)),r=o(a(29)),i=o(a(16)),l=o(a(42)),s=o(a(77));function o(e){return e&&e.__esModule?e:{default:e}}function u(){return{project:i.default.getProject(),app:l.default.getState()}}var c=n.default.createClass({displayName:"App",componentDidMount:function(){i.default.addChangeListener(this._onChange),l.default.addChangeListener(this._onChange)},componentWillUnmount:function(){i.default.removeChangeListener(this._onChange),l.default.addChangeListener(this._onChange)},getInitialState:function(){return u()},render:function(){return n.default.createElement("div",{id:"keen-explorer"},n.default.createElement(r.default,{visible:this.state.project.loading||!this.state.app.ready,additionalClasses:"app-loader"}),n.default.createElement(s.default,{project:this.state.project,client:this.props.client,persistence:this.props.persistence}))},_onChange:function(){this.setState(u())}});t.default=c},function(e,t){e.exports=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={isDST:function(){var e=new Date,t=new Date(e.getFullYear(),0,1),a=new Date(e.getFullYear(),6,1),n=Math.max(t.getTimezoneOffset(),a.getTimezoneOffset());return e.getTimezoneOffset()<n}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),r=s(a(2)),i=s(a(8)),l=s(a(17));function s(e){return e&&e.__esModule?e:{default:e}}var o=["event_collection","actor_property","timeframe","interval","timezone","filters","optional","inverted","with_actors"];t.default={stepJSON:function(e){var t=n.default.cloneDeep(e);return n.default.assign(t,l.default.getTimeParameters(e.time,e.timezone)),t.filters&&(t.filters=n.default.map(t.filters,function(e){return i.default.queryJSON(e,l.default.getTimezoneOffset(t.timezone))}),n.default.remove(t.filters,n.default.isEmpty)),n.default.each(t,function(e,a){r.default.isValidQueryValue(e)&&n.default.includes(o,a)||delete t[a]}),t},formatQueryParams:function(e){if(e.timeframe){var t=l.default.unpackTimeframeParam(e.timeframe,e.timezone);e.time=t.time,e.timezone=t.timezone}return e.filters&&(e.filters=n.default.compact(n.default.map(e.filters,i.default.formatFilterParams))),e.inverted=!0===e.inverted||"true"===e.inverted,e.optional=!0===e.optional||"true"===e.optional,e.with_actors=!0===e.with_actors||"true"===e.with_actors,e}}},function(e,t){e.exports=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(0));r(a(3));function r(e){return e&&e.__esModule?e:{default:e}}function i(e){this.config=e}i.prototype.create=function(e,t){var a=n.default.omit(e,["id"]);this.config.client.put(this.config.client.url("queries","saved",e.query_name)).auth(this.config.client.masterKey()).send(a).then(function(e){t(null,e)}).catch(t)},i.prototype.update=function(e,t){var a=n.default.omit(e,["id"]);this.config.client.put(this.config.client.url("queries","saved",e.id)).auth(this.config.client.masterKey()).send(a).then(function(e){t(null,e)}).catch(t)},i.prototype.destroy=function(e,t){this.config.client.del(this.config.client.url("queries","saved",e.id)).auth(this.config.client.masterKey()).send().then(function(e){t(null,e)}).catch(function(e){204===e.status?t(null,void 0):t(e,null)})},i.prototype.get=function(e,t){e?this.config.client.get(this.config.client.url("queries","saved",e.id)).auth(this.config.client.masterKey()).send().then(function(e){t(null,e)}).catch(t):this.config.client.get(this.config.client.url("queries","saved")).auth(this.config.client.masterKey()).send().then(function(e){t(null,e)}).catch(t)},t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=a(83),i=(n=r)&&n.__esModule?n:{default:n};t.default={KeenSavedQueries:i.default}},function(e,t){e.exports=p},function(e,t){e.exports=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeenExplorer=void 0;var n=_(a(0)),r=_(a(86)),i=_(a(1)),l=_(a(85)),s=_(a(84)),o=_(a(7)),u=_(a(78)),c=_(a(28)),d=_(a(4)),p=_(a(24)),f=_(a(18)),h=_(a(3)),m=_(a(2)),v=_(a(12)),y=_(a(25)),g=_(a(11)),E=(_(a(16)),_(a(31)));function _(e){return e&&e.__esModule?e:{default:e}}var b=t.KeenExplorer=function(e){var t=m.default.generateTempId();this.appDispatcher=o.default,this.config={params:E.default.getQueryAttributes(),persistence:null},this.el(e),d.default.create(n.default.assign(h.default.formatQueryParams(this.config.params)||{},{id:t})),d.default.setActive(t),d.default.validate(t)};b.prototype.client=function(e){return arguments.length?(this.config.client=new r.default(e),this.config.client.resources({events:"{protocol}://{host}/3.0/projects/{projectId}/events"}),c.default.create({client:this.config.client}),c.default.fetchProjectCollections(this.config.client),this):this.config.client},b.prototype.el=function(e){return arguments.length?(e.nodeName?this.config.el=e:document.querySelector?this.config.el=document.querySelector(e):this.config.el=void 0,this):this.config.el},b.prototype.fetch=function(){if(this.config.persistence)if(d.default.fetchAllPersisted(this.config.persistence,function(e){e&&console.error("There was an error fetching the persisted explorers: ",e.stack)}),this.config.params.saved_query)d.default.fetchPersisted(this.config.persistence,{id:this.config.params.saved_query},this.doneFetchingSavedQuery.bind(this,this.config.params.saved_query));else{p.default.update({ready:!0});var e=h.default.isEmailExtraction(g.default.getActive());v.default.run(y.default,g.default.getActive()),!e&&g.default.getActive().isValid&&d.default.exec(this.config.client,g.default.getActive().id)}return this.render(),this},b.prototype.persistence=function(e){return arguments.length?("boolean"==typeof e&&e&&(this.config.client&&this.config.client.masterKey()||console.error("This feature requires a client instance with a masterKey value"),this.config.persistence=new s.default.KeenSavedQueries({baseUrl:this.config.client.url("queries","saved"),client:this.config.client}),this.config.persistence.config.masterKey=this.config.client.masterKey()),this):this.config.persistence},b.prototype.doneFetchingSavedQuery=function(e,t){if(t)if(404===t.status){f.default.create({text:"The saved query "+e+" could not be found.",type:"error",icon:"remove-sign"});var a=m.default.generateTempId();d.default.create({id:a}),d.default.setActive(a),p.default.update({ready:!0})}else console.error("There was a problem fetching a saved query: ",t.stack);else d.default.setActive(e),d.default.exec(this.config.client,e),p.default.update({ready:!0})},b.prototype.render=function(){var e=i.default.createFactory(u.default);l.default.render(e({persistence:this.config.persistence,client:this.config.client}),this.config.el)},b.Persistence=s.default,t.default=b},function(e,t,a){e.exports=a(87)}])});
//# sourceMappingURL=keen-explorer.umd.min.js.map