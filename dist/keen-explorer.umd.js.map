{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external \"lodash\"","webpack:///external \"react\"","webpack:///./lib/js/app/utils/FormatUtils.js","webpack:///./lib/js/app/utils/ExplorerUtils.js","webpack:///./lib/js/app/utils/ProjectUtils.js","webpack:///./lib/js/app/actions/ExplorerActions.js","webpack:///external \"moment\"","webpack:///./lib/js/app/utils/FilterUtils.js","webpack:///./lib/js/app/dispatcher/AppDispatcher.js","webpack:///external \"classnames\"","webpack:///./lib/js/app/utils/RunValidations.js","webpack:///./lib/js/app/stores/ProjectStore.js","webpack:///./lib/js/app/stores/ExplorerStore.js","webpack:///./lib/js/app/components/common/react_select.js","webpack:///./lib/js/app/utils/TimeframeUtils.js","webpack:///./lib/js/app/components/common/select.js","webpack:///./lib/js/app/components/common/fields_toggle.js","webpack:///./lib/js/app/components/common/input.js","webpack:///./node_modules/node-libs-browser/node_modules/events/events.js","webpack:///external \"keymirror\"","webpack:///./lib/js/app/constants/ExplorerConstants.js","webpack:///./lib/js/app/actions/NoticeActions.js","webpack:///./lib/js/app/actions/AppStateActions.js","webpack:///./lib/js/app/validations/FilterValidations.js","webpack:///./lib/js/app/components/common/loader.js","webpack:///./lib/js/app/actions/ProjectActions.js","webpack:///./lib/js/app/components/common/notice.js","webpack:///./lib/js/app/utils/ChartTypeUtils.js","webpack:///./lib/js/app/validations/ExplorerValidations.js","webpack:///./lib/js/vendor/picker.js","webpack:///external \"jQuery\"","webpack:///external \"qs\"","webpack:///external \"string\"","webpack:///./lib/js/app/constants/ProjectConstants.js","webpack:///./lib/js/app/stores/AppStateStore.js","webpack:///./lib/js/app/constants/AppStateConstants.js","webpack:///./lib/js/app/components/common/modal.js","webpack:///./lib/js/app/validations/SharedValidators.js","webpack:///./lib/js/app/validations/StepValidations.js","webpack:///./lib/js/app/constants/NoticeConstants.js","webpack:///./lib/js/app/utils/CashedQueryUtils.js","webpack:///./lib/js/app/components/explorer/query_actions.js","webpack:///./lib/js/app/components/explorer/query_builder/select_field.js","webpack:///./lib/js/app/components/common/timeframe.js","webpack:///./lib/js/app/components/common/datepicker.js","webpack:///./lib/js/app/components/common/timepicker.js","webpack:///./lib/js/app/components/common/filter_manager.js","webpack:///./lib/js/app/utils/QueryStringUtils.js","webpack:///./lib/js/app/app.js","webpack:///external \"keen-analysis\"","webpack:///external \"react-dom\"","webpack:///./lib/js/app/modules/persistence/persistence.js","webpack:///./lib/js/app/modules/persistence/KeenSavedQueries.js","webpack:///external \"json-stable-stringify\"","webpack:///./lib/js/app/utils/FunnelUtils.js","webpack:///./lib/js/app/utils/DateUtils.js","webpack:///external \"flux\"","webpack:///./lib/js/app/components/app.js","webpack:///./lib/js/app/components/explorer/index.js","webpack:///./lib/js/app/components/common/event_browser.js","webpack:///./lib/js/app/components/explorer/visualization/index.js","webpack:///external \"keen-dataviz\"","webpack:///./lib/js/app/components/explorer/visualization/chart.js","webpack:///./lib/js/app/components/explorer/visualization/keen_viz.js","webpack:///./lib/js/app/components/explorer/visualization/code_sample.js","webpack:///external \"react-highlight\"","webpack:///./lib/js/app/utils/DataUtils.js","webpack:///./lib/js/app/components/explorer/query_pane_tabs.js","webpack:///./lib/js/app/components/explorer/query_builder/index.js","webpack:///./lib/js/app/components/explorer/query_builder/percentile_field.js","webpack:///./lib/js/app/components/explorer/query_builder/group_by_field.js","webpack:///./lib/js/app/components/explorer/query_builder/extraction_options.js","webpack:///./lib/js/app/components/common/react_multi_select.js","webpack:///./lib/js/app/components/explorer/query_builder/latest_field.js","webpack:///./lib/js/app/components/explorer/query_builder/funnels/funnel_builder.js","webpack:///./lib/js/app/components/explorer/query_builder/funnels/funnel_step.js","webpack:///./lib/js/app/components/common/absolute_picker.js","webpack:///./lib/js/vendor/picker.date.js","webpack:///./lib/js/vendor/picker.time.js","webpack:///./lib/js/app/components/common/relative_picker.js","webpack:///./lib/js/app/components/common/timezone.js","webpack:///./lib/js/app/components/common/filter.js","webpack:///./lib/js/app/components/common/filter_value_fields.js","webpack:///./lib/js/app/components/common/geo.js","webpack:///./lib/js/app/components/common/interval.js","webpack:///./lib/js/app/components/explorer/query_builder/api_url.js","webpack:///./lib/js/app/components/explorer/saved_queries/browse_queries.js","webpack:///./lib/js/app/components/explorer/cache_toggle.js","webpack:///./lib/js/app/components/common/info_icon.js","webpack:///./lib/js/app/stores/NoticeStore.js"],"names":["toTitleCase","singularize","prettyPrintJSON","coercionTypeForPropertyType","booleanMap","sortItems","isDateInStrictFormat","convertDateToUTC","formatISOTimeNoTimezone","generateRandomId","generateTempId","isValidQueryValue","parseList","isList","isNullOrUndefined","padLeft","ISO_DATE_FORMAT","_isWrappedInSingleQuotes","value","substring","length","_isWrappedInDoubleQuotes","text","replace","txt","charAt","toUpperCase","substr","toLowerCase","json","JSON","stringify","undefined","type","coercionTypeMap","items","keyFunc","formatString","str","mapped","map","el","i","index","sort","a","b","localeCompare","dateString","isValid","date","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","time","format","prefix","Math","floor","random","toString","_","isArray","isPlainObject","isEmpty","parsedList","parseCSV","val","quotelessVal","parseFloat","strVal","String","match","trim","isNull","isUndefined","FormatUtils","QUERY_PARAMS","EXRACTION_EVENT_LIMIT","ANALYSIS_TYPES_WITHOUT_TARGET","toCamelcaseName","name","p1","toUnderscoreName","SKIP","mapSkip","collection","fn","without","echoIf","valueMaybe","append","ExplorerUtils","isPersisted","explorer","id","saveType","shouldHaveTarget","query","analysis_type","indexOf","isEmailExtraction","email","isImmediateExtraction","mergeResponseWithExplorer","response","newModel","defaultsDeep","formatQueryParams","originalModel","query_name","cloneDeep","queryJSON","params","latest","property_names","assign","TimeframeUtils","getTimeParameters","timezone","filters","filter","FilterUtils","steps","FunnelUtils","stepJSON","each","key","remove","element","isNumber","includes","toJSON","pick","refresh_rate","cleanJSONforSave","paramsForURL","attrs","omit","runQuery","config","client","then","res","err","error","success","complete","catch","timeframe","unpackedTime","unpackTimeframeParam","group_by","compact","formatFilterParams","active","metadata","display_name","visualization","chart_type","interval","encodeAttribute","attr","encodeURIComponent","getApiQueryUrl","url","analysisType","queryAttrs","Qs","timeframeType","authKey","masterKey","readKey","resultCanBeVisualized","result","isJSONViz","isTableViz","getSdkExample","defaultKeenAnalysisOpts","host","protocol","requestType","s","dynamicCriteria","paramNames","dynamicConstructorNames","funnelRootParams","dynamicConstructorValues","chartTitle","chartType","step","join","param","space","projectId","slugify","CONSTANTS","DEFAULT_TIMEZONE","ANALYSIS_TYPES","ABSOLUTE_INTERVAL_TYPES","RELATIVE_INTERVAL_TYPES","TIMEZONES","offset","dst_offset","FILTER_OPERATORS","canBeCoeredTo","projectUtils","getConstant","eventsUrl","api_key","getEventCollectionPropertyNames","project","schema","sortedProperties","getPropertyType","propertyName","properties","getLocalTimezoneOffset","getTimezoneOffset","getLocalTimezone","isDST","DateUtils","localOffset","zones","zone","ExplorerActions","create","AppDispatcher","dispatch","actionType","ExplorerConstants","EXPLORER_CREATE","createBatch","models","EXPLORER_CREATE_BATCH","clone","sourceId","EXPLORER_CLONE","NoticeActions","icon","update","updates","updated_query","ProjectStore","getProject","EXPLORER_UPDATE","event_collection","ProjectActions","fetchCollectionSchema","EXPLORER_REMOVE","setActive","EXPLORER_SET_ACTIVE","revertActiveChanges","EXPLORER_REVERT_ACTIVE_CHANGES","clear","EXPLORER_CLEAR","validate","EXPLORER_VALIDATE","addFilter","EXPLORER_ADD_FILTER","removeFilter","EXPLORER_REMOVE_FILTER","updateFilter","EXPLORER_UPDATE_FILTER","addStep","EXPLORER_ADD_STEP","removeStep","EXPLORER_REMOVE_STEP","setStepActive","EXPLORER_SET_STEP_ACTIVE","updateStep","EXPLORER_UPDATE_STEP","moveStep","direction","EXPLORER_MOVE_STEP","addStepFilter","stepIndex","EXPLORER_ADD_STEP_FILTER","removeStepFilter","filterIndex","EXPLORER_REMOVE_STEP_FILTER","updateStepFilter","EXPLORER_UPDATE_STEP_FILTER","exec","ExplorerStore","get","loading","Error","EXPLORER_FOUND_INVALID","clearAll","execError","bind","execSuccess","EXPLORER_QUERY_ERROR","message","EXPLORER_QUERY_SUCCESS","isSaved","ChartTypeUtils","responseSupportsChartType","getChartTypeOptions","dataTimestamp","now","runEmailExtraction","runEmailExtractionSuccess","runEmailExtractionError","fetchAllPersisted","persistence","callback","AppStateActions","fetchingPersistedExplorers","resp","forEach","model","formattedModel","RunValidations","run","ExplorerValidations","console","warn","log","errors","push","fetchPersisted","save","persistenceFunction","EXPLORER_SAVING","saving","explorerJSON","error_code","isLimited","EXPLORER_SAVE_FAIL","errorResp","saveSuccess","updatedModel","CashedQueryUtils","checkLimits","EXPLORER_SAVE_SUCCESS","destroy","EXPLORER_DESTROYING","EXPLORER_DESTROY_FAIL","errorMsg","EXPLORER_DESTROY_SUCCESS","exists","toType","obj","call","isNumeric","num","isNaN","filterUtils","coercionFunctions","property_value","coercedDate","defaultDate","newVal","isFalse","yesterday","subtract","startOf","Number","getCoercedValue","coercion_type","getCoercionType","operator","isComplete","isObject","FilterValidations","initList","item","isString","coerceGeoValue","trailingDecimals","validFilters","Dispatcher","validatorSet","keys","Object","validator","shouldRun","attribute","msg","CHANGE_EVENT","_projects","defaultAttrs","eventCollections","sortedEventCollections","_create","_update","_updateEventCollection","collectionName","newCollection","EventEmitter","prototype","unregisterWithDispatcher","unregister","_dispatcherToken","getAll","emitChange","emit","addChangeListener","on","removeChangeListener","removeListener","register","action","ProjectConstants","PROJECT_CREATE","PROJECT_UPDATE","PROJECT_UPDATE_EVENT_COLLECTION","SHARED_FUNNEL_STEP_PROPERTIES","_explorers","_defaultAttrs","target_property","percentile","ProjectUtils","relativity","amount","sub_timeframe","_defaultMetadata","_defaultFilter","property_name","_defaultGeoFilter","coordinates","max_distance_miles","_defaultStep","actor_property","optional","inverted","with_actors","_validate","_getDefaultFilterCoercionType","propertyType","targetCoercionType","_prepareUpdates","customizer","objValue","srcValue","mergeWith","_migrateToFunnel","_migrateFromFunnel","_removeInvalidFields","firstStep","activeStep","find","_prepareFilterUpdates","merge","newOp","coercionOptions","_wrapGroupBy","pull","newAttrs","_markFirstInvalidStepActive","_setStepActive","_remove","_setActive","_revertActiveChanges","original","_addFilter","_removeFilter","splice","_updateFilter","_addStep","lastStep","_removeStep","_updateStep","_moveStep","stepToDisplace","_addStepFilter","_removeStepFilter","_updateStepFilter","_clear","dispatchToken","set","getActive","getLast","getAllPersisted","finishAction","source","wasActive","ReactSelect","React","createClass","getDefaultProps","wrapClasses","inputClasses","placeholder","handleBlur","handleChange","handleSelection","getInitialState","focusedItem","limit","initialFocus","selectedItem","visible","visibleItems","resetState","setState","handleClick","e","handleItemFocus","newState","state","refs","scrollpane","scrollTop","props","input","handleFocus","relatedTarget","preventDefault","resetTimeout","setTimeout","blurTimeout","clearTimeout","handleItemSelection","selection","focus","handleKeyDown","itemHeight","itemOffset","list","children","scrollHeight","keyDownCallbacks","innerHTML","childNode","getAttribute","handleScroll","pane","diff","appendListItems","arr","self","opt","forceUpdate","insertListItems","apply","concat","removeListItems","getItems","count","inputString","search","escapeRegExp","getScrollPane","render","title","timeframeUtils","has","timeframeBuilders","absolute","start","end","relative","getTimeframe","timeframeBuilder","unpackAbsoluteTimeframe","unpackRelativeTimeframe","formattedValue","z","startVal","endVal","split","SelectComponent","buildOptions","options","option","disabled","wrapValuesInObjects","sortOptions","A","B","buildEmptyOption","emptyOption","setupOptions","newOptions","classes","reference","componentWillReceiveProps","nextProps","optionNodes","label","emptyVal","multiple","selectedValue","selectedOption","FieldsToggle","handleFieldsToggle","toggledState","attrNames","attrsToStore","attrName","_storedAttrs","getFn","resetVal","resetValues","updateFn","toggleButtonClick","event","toggle","openState","fieldsCount","open","toggleCallback","componentWillMount","initialOpenState","bodyContent","InputComponent","_onChange","target","onChange","readonly","required","onBlur","EXPLORER_SAVE","EXPLORER_SAVE_NEW","EXPLORER_DESTROY","NoticeConstants","NOTICE_CREATE","NOTICE_CLEAR_ALL","AppStateConstants","APP_STATE_UPDATE","reset","APP_STATE_RESET","isGeoCoercionType","coercionType","valid","LoaderComponent","additionalClasses","fetchProjectCollections","auth","send","events","recentEvents","stack","updateEventCollection","fetchRecentEventsForCollection","eventCollection","noticeExists","notice","NoticeComponent","close","closeCallback","closable","closeBtn","getQueryDataType","isInterval","isGroupBy","Array","is2xGroupBy","dataType","dataTypes","queryDataType","isTableChartType","isNotFunnel","percentile_value","SharedValidators","StepValidations","rate","RegExp","test","n","factory","define","amd","exports","module","require","Picker","jQuery","$","$window","window","$document","document","$html","documentElement","PickerConstructor","ELEMENT","NAME","COMPONENT","OPTIONS","IS_DEFAULT_THEME","STATE","abs","SETTINGS","extend","defaults","CLASSES","klasses","klass","$ELEMENT","PickerInstance","P","constructor","$node","methods","autofocus","activeElement","readOnly","editable","component","$root","node","createWrappedComponent","picker","prepareElementRoot","formatSubmit","prepareElementHidden","prepareElement","container","after","onStart","onRender","stop","onStop","onOpen","onClose","onSet","isUsingDefaultTheme","trigger","entireComponent","html","box","nodes","_hidden","parentNode","removeChild","removeClass","removeData","off","dontGiveFocus","addClass","aria","opened","css","getScrollbarWidth","which","keycode","keyCode","keycodeToMove","go","highlighted","hasClass","highlight","contains","click","giveFocus","focusToOpen","focused","thing","thingItem","thingValue","thingIsObject","thingObject","muted","formats","method","internal","thingName","thingMethod","names","arguments","namesCount","data","_trigger","methodList","wrap","frame","holder","isKeycodeDelete","stopPropagation","haspopup","expanded","owns","focusin","is","nodeName","$target","targetData","targetDisabled","navDisabled","href","nav","hiddenName","hiddenPrefix","hiddenSuffix","theme","prop","currentStyle","getComputedStyle","height","$outer","appendTo","widthWithoutScroll","offsetWidth","$inner","widthWithScroll","group","groupObject","loopObjectScope","nodesList","counter","min","max","wrapper","lead","number","scope","args","digits","string","isDate","isInteger","ariaAttr","Component","componentData","$this","ariaSet","setAttribute","attrVal","defaultState","codeSampleHidden","ready","_appState","_reset","AppStateStore","getState","getLimit","Modal","closeClick","backdropClick","closest","removeBackdrop","addBackdrop","setLoading","backdropEl","createElement","className","body","appendChild","buildFooter","footerBtns","btnConfig","iconName","iconClass","ref","onClick","size","modalClasses","componentDidMount","componentWillUnmount","modalDialogClasses","titleIcon","titleIconClasses","iconClasses","defaultError","fetch","cached_queries","limited","current_usage","QueryActions","runBtnStates","default","inactive","immediateExtraction","emailExtraction","runButtonText","btnStates","saveMsg","saveBtn","cloneBtn","deleteBtn","actionsSupported","runButtonClasses","codeSampleBtnClasses","isFunnel","saveQueryClick","removeClick","cloneQueryClick","handleQuerySubmit","toggleCodeSample","SelectField","buildBrowseEventsLink","onBrowseEvents","requiredNote","requiredLabel","relativeDefaults","absoluteDefaults","Timeframe","toggleTimeframeType","currentTarget","dataset","isAbsolute","isRelative","timeframePicker","Datepicker","handleOnBlur","destroyPicker","onFocus","minimum","refValue","pickadate","datepicker","premadeTimes","parseTime","timeStr","dt","NaN","hours","parseInt","setHours","setMinutes","setSeconds","Timepicker","validateTime","parsed","getTime","FilterManager","propTypes","PropTypes","propertyNames","array","func","isRequired","modal","coordinateIndex","buildFilterNodes","filterNodes","noFiltersMarkup","filterContent","modalClosed","getSearchString","location","updateSearchString","queryStringData","urlPath","origin","pathname","history","pushState","getQueryAttributes","parse","depth","KeenExplorer","tempId","appDispatcher","QueryStringUtils","KeenAnalysis","resources","querySelector","saved_query","doneFetchingSavedQuery","bool","Persistence","KeenSavedQueries","baseUrl","savedQueryName","status","createFactory","AppComponent","ReactDOM","put","del","STEP_PARAMS","jan","getFullYear","jul","stdOffset","getProjectState","app","App","getStoresState","allPersistedExplorers","activeExplorer","NoticeStore","getGlobalNotice","stepNotices","getStepNotices","appState","Explorer","toggleFields","getFieldsToggleComponents","toggleObj","hasValue","selectEventCollection","savedQueryClicked","modelId","removeSavedQueryClicked","confirm","newExplorer","activeQueryPane","createNewQuery","handleFiltersToggle","onDisplayNameChange","onQueryNameChange","handleRevertChanges","setExtractionType","handleClearQuery","handleAddFilter","handleRemoveFilter","handleFilterChange","setVizWrapTop","top","style","getSelectedIndex","findIndex","toggleQueryPane","cacheToggle","queryPane","queryPaneTabs","browseListNotice","browseEmptyContent","activeExplorerOriginal","getEventPropertyNames","onNameChange","EventBrowser","onKeyUp","enterKeyCode","shouldFetchCollectionSchema","selectEventCollectionClick","activeEventCollection","setActiveEventCollectionClick","setActiveEventCollection","innerText","activeView","fetchRecentEvents","modalOpened","collectionToUse","setSearchText","searchtext","buildEventCollectionNodes","re","getNavClasses","shouldShowLoader","getRecentEvents","getSchema","ordered","changeActiveView","tabName","currentEventCollection","previewData","browseContent","handleKeyUp","alertContent","Visualization","focusDisplayName","focusQueryName","handleDisplayNameFocus","handleDisplayNameBlur","handleQueryNameFocus","handleQueryNameBlur","noticeClosed","changeChartType","formatChartTypes","first","dataviz","KeenDataviz","dispatcherToken","exportToCsv","matrix","filename","DataUtils","codeSample","chartDetailBarClasses","Chart","buildVizContent","buildViz","chartContent","msgContent","content","actors","vizContent","KeenViz","lastDataTimestamp","lastChartType","showVisualization","sortGroups","shouldComponentUpdate","nextState","componentDidUpdate","exportBtn","CodeSample","panelClasses","hidden","onCloseClick","csvContent","htmlElement","row","cell","j","encodedData","URL","blob","Blob","createObjectURL","encodeURI","QueryPaneTabs","toggled","tab","btnNewQuery","queryPaneClasses","persisted","activePane","QueryBuilder","handleSelectionWithEvent","updateGroupBy","shouldShowRevertButton","isEqual","buildEventCollectionField","buildExtractionOptions","buildGroupByField","buildTargetPropertyField","buildPercentileField","buildIntervalField","buildFilters","buildGlobalTimeframePicker","buildFunnelBuilder","buildClearButton","apiQueryUrl","analysisTypes","PercentileField","GroupByField","focusOnReactSelect","select","multiGroupToggle","toggleMultiGroupBy","secondField","getGroupBy","slice","shouldBeOpen","ExtractionOptions","projectSchema","property","selected","shouldBeSelected","newPropertyNames","emailField","latestField","extractionPropertiesFilter","isEmail","handleChangeWithEvent","_getExtractionKeys","_handlePropertyNamesChange","ReactMultiSelect","focusedIndex","interceptEvent","itemVal","_isSelected","_handleOptionChange","_renderOption","selectedItems","_toggleOpenClose","_renderOptionMenu","LatestField","FunnelsBuilder","toggleStepActive","buildSteps","FunnelStep","object","canRemove","handleCheckboxChange","checked","moveStepUp","moveStepDown","buildStepBody","stepWrapperClasses","dateFormat","timeFormat","AbsolutePicker","setDate","endValue","handleDateBlur","setTime","DAYS_IN_WEEK","WEEKS_IN_CALENDAR","DatePicker","settings","calendar","elementValue","elementDataValue","valueString","isRTL","queue","view","disable","enable","collectionDisabled","shift","timeChange","highlightedObject","targetDate","UTC","year","month","selectMonth","selectYear","includeToday","buttonToday","calendarItem","pop","isInfiniteValue","Infinity","normalize","day","getUTCDay","createRange","from","to","createDate","withinRange","range","dateUnit","overlapRanges","one","two","rel","setUTCDate","navigate","targetDateObject","targetYear","targetMonth","isTargetArray","isTargetObject","viewsetObject","setUTCHours","measure","viewset","dateObject","originalDateObject","isFlippedBase","hasEnabledBeforeTarget","hasEnabledAfterTarget","minLimitObject","maxLimitObject","reachedMin","reachedMax","hasEnabledWeekdays","dateTime","dateToVerify","isDisabledMatch","dateToDisable","firstDay","parsingObject","toArray","formattingLabel","formatLength","yyyy","yy","mm","m","dd","d","getWordLengthFromCollection","word","getFirstWordLength","ddd","weekdaysShort","dddd","weekdaysFull","mmm","monthsShort","mmmm","monthsFull","itemObject","isDateExact","isDateOverlap","flipEnable","deactivate","datesToDisable","disabledItems","unitToDisable","matchFound","activate","datesToEnable","disabledItemsCount","unitToEnable","disabledUnit","isExactRange","isOpen","nowObject","selectedObject","disabledCollection","tableHead","fullCollection","weekdays","showWeekdaysFull","createMonthNav","next","role","controls","labelMonthNext","labelMonthPrev","createMonthLabel","monthsCollection","showMonthsShort","selectMonths","loopedMonth","labelMonthSelect","createYearLabel","focusedYear","numberYears","selectYears","minYear","maxYear","lowestYear","highestYear","availableYears","neededYears","loopedYear","labelYearSelect","header","rowCounter","shiftDateBy","isSelected","isHighlighted","isDisabled","infocus","outfocus","activedescendant","table","today","buttonClear","buttonClose","footer","navPrev","navNext","HOURS_IN_DAY","MINUTES_IN_HOUR","HOURS_TO_NOON","MINUTES_IN_DAY","TimePicker","clock","fromValue","$pickerHolder","$viewset","vendors","vendor","animations","$el","position","clientHeight","clockItem","getHours","getMinutes","hour","mins","createTime","timeUnit","nowMinutes","isValueInteger","isBelowInterval","minTime","timeObject","timeToVerify","timeToDisable","minLimit","maxLimit","minutes","isPM","parseValue","h","hh","H","HH","isTimeExact","isTimeOverlap","timesToDisable","timesToEnable","isRangeMatched","getMonth","getDate","loopedTime","timeMinutes","formatLabel","listItem","RELATIVE_TIMEFRAMES","hasRelativeTimeframe","RelativePicker","setRelativeTime","buildDescriptionCopy","subIntervalCopy","timeAmountPluralSuffix","relativityCopy","singularCurrentInterval","descriptionCopy","relativeIntervalTypes","Timezone","handleTimezoneBlur","handleTimezoneActivated","handleTimezoneChange","timezones","Filter","buildValueFormGroup","filterOperators","buildOperatorSelect","buildPropertyNameSelect","getListSyntaxInfo","buildValidationError","filterCompleteAndInvalid","filterClasses","pasrseIntoDate","timeString","FilterValueFields","setValueState","getCoercionOptions","getInputPlaceholder","newProps","valueInput","Geo","Interval","setInterval","intervalFieldsToggled","toggleState","intervalUpdateFn","intervalGetFn","ApiUrl","handleInputSelect","setSelectionRange","handleInputChange","dateForItem","created_date","datetime","BrowseQueries","clickCallback","buildList","listElements","listItems","selectedIndex","createdAt","isCachedText","displayName","fieldChanged","emptyContent","refreshRateMultiplier","CacheToggle","setCached","_isCached","settingsOpen","setSettingsOpen","setRefreshRate","setRefreshRateBlur","round","_refreshRateInHours","cached","tooltip","isCached","parentClasses","cacheDetailsClasses","cacheSettingsClasses","cacheToggleLabel","_minutesAgo","runInformation","run_information","last_run_status","lastRun","last_run_date","utcOffset","duration","moment","humanize","InfoIcon","width","fill","_notices","_removeGlobalNotices","_removeStepNotices","_clearAll","waitFor"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA,iCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA,sCAAsC,QAAQ;AAC9C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;;AAEA;AACA,QAAQ,yBAAyB;AACjC;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;;;;;;AC7bA,iD;;;;;;;;;;;;;ACAA;;;;;;kBAEe,yBAAU;AACvBzX,mBAAiB,IADM;AAEvBG,yBAAuB,IAFA;AAGvBG,kBAAgB,IAHO;AAIvBQ,mBAAiB,IAJM;AAKvBI,mBAAiB,IALM;AAMvBE,uBAAqB,IANE;AAOvBE,kCAAgC,IAPT;AAQvBE,kBAAgB,IARO;AASvBE,qBAAmB,IATI;AAUvB+B,0BAAwB,IAVD;AAWvBO,0BAAwB,IAXD;AAYvBF,wBAAsB,IAZC;;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","file":"keen-explorer.umd.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"react\"), require(\"moment\"), require(\"classnames\"), require(\"keymirror\"), require(\"jQuery\"), require(\"qs\"), require(\"string\"), require(\"keen-analysis\"), require(\"react-dom\"), require(\"json-stable-stringify\"), require(\"flux\"), require(\"keen-dataviz\"), require(\"react-highlight\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"react\", \"moment\", \"classnames\", \"keymirror\", \"jQuery\", \"qs\", \"string\", \"keen-analysis\", \"react-dom\", \"json-stable-stringify\", \"flux\", \"keen-dataviz\", \"react-highlight\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"lodash\"), require(\"react\"), require(\"moment\"), require(\"classnames\"), require(\"keymirror\"), require(\"jQuery\"), require(\"qs\"), require(\"string\"), require(\"keen-analysis\"), require(\"react-dom\"), require(\"json-stable-stringify\"), require(\"flux\"), require(\"keen-dataviz\"), require(\"react-highlight\")) : factory(root[\"lodash\"], root[\"react\"], root[\"moment\"], root[\"classnames\"], root[\"keymirror\"], root[\"jQuery\"], root[\"qs\"], root[\"string\"], root[\"keen-analysis\"], root[\"react-dom\"], root[\"json-stable-stringify\"], root[\"flux\"], root[\"keen-dataviz\"], root[\"react-highlight\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__9__, __WEBPACK_EXTERNAL_MODULE__19__, __WEBPACK_EXTERNAL_MODULE__30__, __WEBPACK_EXTERNAL_MODULE__31__, __WEBPACK_EXTERNAL_MODULE__32__, __WEBPACK_EXTERNAL_MODULE__50__, __WEBPACK_EXTERNAL_MODULE__51__, __WEBPACK_EXTERNAL_MODULE__54__, __WEBPACK_EXTERNAL_MODULE__57__, __WEBPACK_EXTERNAL_MODULE__62__, __WEBPACK_EXTERNAL_MODULE__66__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 48);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","import _ from 'lodash';\nimport S from 'string';\nimport moment from 'moment';\n\nconst ISO_DATE_FORMAT = 'YYYY-MM-DDTHH:mm:ss.SSS';\n\nfunction _isWrappedInSingleQuotes(value) {\n  return value.substring(0, 1) === \"'\" && value.substring(value.length - 1) === \"'\";\n}\n\nfunction _isWrappedInDoubleQuotes(value) {\n  return value.substring(0, 1) === '\"' && value.substring(value.length - 1) === '\"';\n}\n\nexport function toTitleCase(text) {\n    return text.replace(/\\w\\S*/g, function(txt) {\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n    });\n  };\n\nexport function singularize(text) {\n    return text.replace(/s+$/, '');\n  };\n\nexport function prettyPrintJSON(json) {\n    return JSON.stringify(json, undefined, 2);\n  };\n\nexport function coercionTypeForPropertyType(type) {\n    var coercionTypeMap = {\n      'string':   'String',\n      'num':      'Number',\n      'datetime': 'Datetime',\n      'list':     'List',\n      'null':     'Null',\n      'bool':     'Boolean'\n    };\n    return coercionTypeMap[type];\n  };\n\nexport function booleanMap(value) {\n    if (value === null || value === '' ) {\n      return '';\n    } else if (value === 'false') {\n      return 'false';\n    } else if (value === 'true') {\n      return 'true';\n    } else {\n      return value ? 'true' : 'false';\n    }\n  };\n\nexport function sortItems(items, keyFunc) {\n    // using a key + mapped indices avoids repeated calls to\n    // possibly-slow key functions.\n    // keyFunc is assumed to return a unicode string.\n    keyFunc = keyFunc || function formatString(str) {\n        return str.replace(/[-_ .]/, '').toLowerCase();\n    };\n\n    var mapped = items.map(function(el, i) {\n      return { index: i, value: keyFunc(el) };\n    })\n\n    mapped.sort(function(a, b) {\n      return a.value.localeCompare(b.value);\n    });\n\n    return mapped.map(function(el){\n      return items[el.index];\n    });\n  };\n\n  /**\n   * Checks whether the given string is in a date format, as defined by:\n   * 'YYYY-MM-DDTHH:mm:ss.SSS'\n   * @return {Boolean} Whether or not the string is in the expected format.\n   */\nexport function isDateInStrictFormat(dateString) {\n    return moment(dateString, ISO_DATE_FORMAT, true).isValid();\n  };\n\nexport function convertDateToUTC(date) {\n    return new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n  };\n\nexport function formatISOTimeNoTimezone(time) {\n    return moment(time).format('YYYY-MM-DDTHH:mm:ss.SSS');\n  };\n\nexport function generateRandomId(prefix) {\n    return (prefix || '') + (+new Date() + Math.floor(Math.random() * 999999)).toString(36);\n  };\n\nexport function generateTempId() {\n    return generateRandomId('TEMP-');\n  };\n\nexport function isValidQueryValue(value) {\n    if (_.isArray(value)) return value.length > 0;\n    if (value === false) return true;\n    if (value === 0) return true;\n    if (_.isPlainObject(value)) return !_.isEmpty(value);\n    return !isNullOrUndefined(value);\n  };\n\nexport function parseList(value) {\n    if (value) {\n      if (!isList(value)) return '';\n      var parsedList = S(value).parseCSV();\n\n      parsedList = _.map(parsedList, function(val) {\n        if (_isWrappedInSingleQuotes(val)) {\n          var quotelessVal = val.replace(\"'\", \"\");\n          if (parseFloat(quotelessVal)) {\n            val = parseFloat(quotelessVal);\n          }\n        }\n        return val;\n      });\n\n      return parsedList;\n    } else {\n      return '';\n    }\n  };\n\nexport function isList(str) {\n    var strVal = String(str);\n    var isList = true;\n    var items = strVal.match(/(\".*?\"|[^\",\\s]+)(?=\\s*,|\\s*$)/g);\n    if (items) {\n      for(var i=0; i<items.length; i++) {\n        isList = (_isWrappedInSingleQuotes(items[i].trim()) || _isWrappedInDoubleQuotes(items[i].trim()));\n        if (!isList) break;\n      }\n      return isList;\n    }\n    else {\n      return false;\n    }\n\n  };\n\nexport function isNullOrUndefined(value) {\n    return (_.isNull(value) || _.isUndefined(value));\n  };\n\nexport function padLeft(value) {\n    return value < 10 ? '0' + value : value;\n  };\n\nconst FormatUtils = {\n  toTitleCase,\n  singularize,\n  prettyPrintJSON,\n  coercionTypeForPropertyType,\n  booleanMap,\n  sortItems,\n  isDateInStrictFormat,\n  convertDateToUTC,\n  formatISOTimeNoTimezone,\n  generateRandomId,\n  generateTempId,\n  isValidQueryValue,\n  parseList,\n  isList,\n  isNullOrUndefined,\n  padLeft\n};\n\nexport default FormatUtils;\n","import _ from 'lodash';\nimport Qs from 'qs';\nimport stringify from 'json-stable-stringify';\nimport moment from 'moment';\nimport FormatUtils from './FormatUtils';\nimport FunnelUtils from './FunnelUtils';\nimport ProjectUtils from './ProjectUtils';\nimport FilterUtils from './FilterUtils';\nimport TimeframeUtils from './TimeframeUtils';\n\nconst QUERY_PARAMS = [\n  'event_collection',\n  'analysis_type',\n  'target_property',\n  'percentile',\n  'group_by',\n  'timeframe',\n  'interval',\n  'timezone',\n  'filters',\n  'steps',\n  'email',\n  'latest',\n  'property_names'\n];\n\nconst EXRACTION_EVENT_LIMIT = 100;\n\nconst ANALYSIS_TYPES_WITHOUT_TARGET = [\n  'extraction',\n  'count',\n  'funnel'\n];\n\nfunction toCamelcaseName(name) {\n  return name.replace(/_(.)/, function(match, p1) {\n    return p1.toUpperCase();\n  })\n}\n\nfunction toUnderscoreName(name) {\n  return name.replace(/([A-Z])/, function(match, p1) {\n    return '_' + p1.toLowerCase();\n  })\n}\n\nvar SKIP = {}\nfunction mapSkip(collection, fn) {\n  return _.without(_.map(collection, fn), SKIP);\n}\n\nfunction echoIf(valueMaybe, append) {\n  if (valueMaybe) {\n    return append;\n  }\n  return '';\n}\n\nconst ExplorerUtils = {\n\n  EXRACTION_EVENT_LIMIT: EXRACTION_EVENT_LIMIT,\n\n  isPersisted: function(explorer) {\n    return explorer.id && !explorer.id.toString().match('TEMP');\n  },\n\n  saveType: function(explorer) {\n    return ExplorerUtils.isPersisted(explorer) ? 'update' : 'save';\n  },\n\n  shouldHaveTarget: function(explorer) {\n    return !FormatUtils.isNullOrUndefined(explorer.query.analysis_type) && ANALYSIS_TYPES_WITHOUT_TARGET.indexOf(explorer.query.analysis_type) === -1;\n  },\n\n  isEmailExtraction: function(explorer) {\n    return (explorer.query.analysis_type === 'extraction' && !_.isNull(explorer.query.email));\n  },\n\n  isImmediateExtraction: function(explorer) {\n    return (explorer.query.analysis_type === 'extraction' && _.isNull(explorer.query.email));\n  },\n\n  mergeResponseWithExplorer: function(explorer, response) {\n    var newModel = _.defaultsDeep(ExplorerUtils.formatQueryParams(response), explorer);\n    delete newModel.originalModel; // Remove the original model.\n    newModel.id = response.query_name; // Set the ID to the query_name (it's now persisted.)\n    newModel.originalModel = _.cloneDeep(newModel);\n    return newModel;\n  },\n\n  queryJSON: function(explorer) {\n    if (!explorer || !explorer.query) return;\n    var params = _.cloneDeep(explorer.query);\n\n    if (params.analysis_type === 'extraction') {\n      if (FormatUtils.isNullOrUndefined(params.email)) {\n        params.latest = EXRACTION_EVENT_LIMIT;\n      }\n    } else {\n      delete params.latest;\n      delete params.email;\n      delete params.property_names;\n    }\n\n    if (params.analysis_type !== 'funnel') {\n      _.assign(params, TimeframeUtils.getTimeParameters(params.time, params.timezone));\n    }\n\n    // Add filters\n    if (params.filters) {\n      params.filters = _.map(params.filters, function(filter){\n        return FilterUtils.queryJSON(filter);\n      });\n    }\n\n    if (params.steps) {\n      params.steps = _.map(params.steps, FunnelUtils.stepJSON);\n    }\n\n    _.each(params, function(value, key) {\n      // If it's an array, clean out any empty elements\n      if (_.isArray(value)) {\n        _.remove(value, function(element) {\n          return !_.isNumber(element) && _.isEmpty(element);\n        });\n      }\n\n      // Remove any empty properties or ones that shouldn't be\n      // part of the query request.\n      if (!FormatUtils.isValidQueryValue(value) || !_.includes(QUERY_PARAMS, key)) {\n        delete params[key];\n      }\n    });\n\n    return params;\n  },\n\n  toJSON: function(explorer) {\n    var json = _.pick(explorer, [\n      'id',\n      'query_name',\n      'refresh_rate',\n      'metadata'\n    ]);\n    json.query = ExplorerUtils.queryJSON(explorer);\n    if (json.query.analysis_type === 'extraction') json.refresh_rate = 0;\n    return json;\n  },\n\n  cleanJSONforSave: function(explorer) {\n    if (explorer.query.analysis_type === 'extraction') {\n      explorer.query.latest = EXRACTION_EVENT_LIMIT;\n      delete explorer.query.email;\n      delete explorer.query.property_names;\n    }\n    return explorer;\n  },\n\n  paramsForURL: function(explorer) {\n    var attrs = ExplorerUtils.toJSON(explorer);\n    return _.omit(attrs, [\n      'id',\n      'query_name',\n      'refresh_rate',\n      'metadata'\n    ]);\n  },\n\n  /**\n   * Execures a Keen.js query with the provided client and query params, calling the\n   * callbacks after execution.\n   * @param {Object} config The runQuery configuration\n   * Expected structure:\n   * {\n   *   client:   {The Keen.js client},\n   *   query:    {The object with the query parameters},\n   *   success:  {Success callback function},\n   *   error:    {Error callback function},\n   *   complete: {Complete callback function}\n   * }\n   * @return {undefined}\n   */\n  runQuery: function(config) {\n    config.client\n      .query(config.query.analysis_type, _.omit(config.query, 'analysis_type'))\n      .then(function(res, err){\n        if (err) {\n          config.error(err);\n        }\n        else {\n          config.success(res);\n        }\n        if (config.complete) config.complete(err, res);\n      })\n      .catch(config.error);\n  },\n\n  /**\n   * Takes in an object of query params directly taken from the URL and formats/deconstructs them appropriately to work well\n   * with our data model.\n   * @param  {Object} the raw params from the URL\n   * @return {Object} formatted attributes to be used for creating a new Explorer model.\n   */\n  formatQueryParams: function(params) {\n    if (!params || !params.query) return;\n    if (params.query && params.query.timeframe) {\n      var unpackedTime = TimeframeUtils.unpackTimeframeParam(params.query.timeframe, params.query.timezone);\n      params.query.time = unpackedTime.time;\n      params.query.timezone = unpackedTime.timezone;\n    }\n    if (params.query.group_by && !_.isArray(params.query.group_by)) {\n      params.query.group_by = [params.query.group_by];\n    }\n    if (params.query.filters) {\n      params.query.filters = _.compact(_.map(params.query.filters, FilterUtils.formatFilterParams));\n    }\n    if (params.query.steps) {\n      params.query.steps = _.compact(_.map(params.query.steps, FunnelUtils.formatQueryParams));\n      params.query.steps[params.query.steps.length - 1].active = true\n    }\n    if (!params.id && params.query_name) params.id = params.query_name;\n\n    if (!params.metadata) {\n      params.metadata = {};\n    }\n\n    if (!params.metadata.display_name) params.metadata.display_name = params.query_name;\n    if (!params.metadata.visualization || !params.metadata.visualization.chart_type) {\n      params.metadata.visualization = {};\n      if (params.query.interval) {\n        params.metadata.visualization.chart_type = \"area\";\n      } else {\n        params.metadata.visualization.chart_type = \"metric\";\n      }\n    }\n    return params;\n  },\n\n  encodeAttribute: function(attr) {\n    return encodeURIComponent(JSON.stringify(attr));\n  },\n\n  getApiQueryUrl: function(client, explorer) {\n    var attrs = ExplorerUtils.queryJSON(explorer);\n    var url = client.url('queries', attrs.analysis_type);\n\n    var analysisType = attrs.analysis_type;\n    delete attrs.analysis_type;\n\n    var timeframe = _.cloneDeep(attrs.timeframe);\n    delete attrs.timeframe;\n\n    var filters = _.map(attrs.filters, function(filter) {\n      return _.omit(_.cloneDeep(filter), 'coercion_type');\n    });\n    delete attrs.filters;\n\n    var steps;\n    if (attrs.steps && attrs.steps.length) {\n      steps = ExplorerUtils.encodeAttribute(attrs.steps);\n      delete attrs.steps;\n    }\n\n    if (attrs.group_by && _.isArray(attrs.group_by) && attrs.group_by.length) {\n      attrs.group_by = (attrs.group_by.length > 1) ? JSON.stringify(attrs.group_by) : attrs.group_by[0];\n    }\n\n    var queryAttrs = Qs.stringify(attrs);\n\n    if (timeframe && TimeframeUtils.timeframeType(explorer.query.time) === 'relative') {\n      queryAttrs += '&timeframe='+ timeframe;\n    }\n    else if (timeframe && TimeframeUtils.timeframeType(explorer.query.time) === 'absolute') {\n      // This is an absolute timeframe, so we need to encode the object in a specific way before sending it, as per keen docs => https://keen.io/docs/data-analysis/timeframe/#absolute-timeframes\n      timeframe = ExplorerUtils.encodeAttribute(timeframe);\n      queryAttrs += '&timeframe='+ timeframe;\n    }\n\n    // We need to encode the filters the same way as we encode the absolute timeframe.\n    if (filters) {\n      filters = ExplorerUtils.encodeAttribute(filters);\n      queryAttrs += '&filters='+ filters;\n    }\n\n    if (steps) {\n      queryAttrs += '&steps=' + steps;\n    }\n\n    var authKey = client.masterKey() || client.readKey();\n\n    url += '?api_key=' + authKey + '&' + queryAttrs;\n    return url;\n  },\n\n  resultCanBeVisualized: function(explorer) {\n    return (explorer.response && !FormatUtils.isNullOrUndefined(explorer.response.result) && (_.isNumber(explorer.response.result) || (_.isArray(explorer.response.result) && explorer.response.result.length)));\n  },\n\n  isJSONViz: function(explorer) {\n    return explorer.metadata.visualization.chart_type && explorer.metadata.visualization.chart_type.toLowerCase() === 'json';\n  },\n\n  isTableViz: function(explorer) {\n    return explorer.metadata.visualization.chart_type && explorer.metadata.visualization.chart_type.toLowerCase() === 'table';\n  },\n\n  getSdkExample: function(explorer, client) {\n    var defaultKeenAnalysisOpts = {\n          host: 'api.keen.io',\n          protocol: 'https',\n          requestType: 'jsonp'\n        },\n        params = ExplorerUtils.queryJSON(explorer),\n        s = stringify,\n        dynamicCriteria,\n        paramNames,\n        dynamicConstructorNames = [\n          'host', 'protocol', 'requestType'\n        ],\n        funnelRootParams = [\n          'event_collection', 'steps'\n        ],\n        dynamicConstructorValues;\n\n    var chartTitle = 'Untitled Chart';\n    if (explorer.metadata && explorer.metadata.display_name) {\n      chartTitle = explorer.metadata.display_name;\n    }\n\n    var chartType = '';\n    if (explorer.metadata && explorer.metadata.visualization\n        && explorer.metadata.visualization.chart_type\n          && explorer.metadata.visualization.chart_type !== 'JSON') {\n            chartType = explorer.metadata.visualization.chart_type;\n    }\n\n    switch(params.analysis_type) {\n      case 'funnel':\n        paramNames = ['steps'];\n        break;\n\n      default:\n        paramNames = ['event_collection', 'filters', 'group_by', 'interval', 'target_property', 'percentile', 'timeframe', 'timezone'];\n        break;\n    }\n\n    if(params.steps) {\n      params.steps = _.map(params.steps, function(step) { return _.omit(step, 'active'); });\n    }\n\n    dynamicConstructorValues = mapSkip(dynamicConstructorNames, function(name) {\n      if (client.config[name] == defaultKeenAnalysisOpts[name]) {\n        return SKIP\n      }\n      return '  ' + name + ': ' + s(client.config[name])\n    }).join(',\\n');\n    // remove coercion from example; it's already been handled elsewhere.\n    _.each(params['filters'], function(filter) { delete filter['coercion_type'] })\n\n    dynamicCriteria = mapSkip(paramNames, function(param) {\n      if (!params[param]) {\n        return SKIP\n      }\n      return '        ' + param + ': ' + s(params[param], { space: 0 })\n    }).join(',\\n');\n\n    var value = [\n      '<!DOCTYPE html>',\n      '<html>',\n      '<head>',\n      '  <meta charset=\"utf-8\">',\n      '  <link href=\"https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-2.0.4.min.css\" rel=\"stylesheet\" />',\n      '</head>',\n      '<body>',\n      '  <!-- Target DOM Node -->',\n      '  <div id=\"keen-example-chart\"></div>',\n      '  ',\n      '  <script src=\"https://d26b395fwzu5fz.cloudfront.net/keen-analysis-2.0.0.min.js\" type=\"text/javascript\"></script>',\n      '  <script src=\"https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-2.0.4.min.js\" type=\"text/javascript\"></script>',\n      '  <script type=\"text/javascript\">',\n      '    var client = new Keen({',\n      '      projectId: ' + s(client.config.projectId) + ',',\n      '      readKey: ' + s(client.config.readKey) + echoIf(dynamicConstructorValues, ','),\n      dynamicConstructorValues,\n      '    });',\n      '    ',\n      '    var chart = new Keen.Dataviz()',\n      '      .el(\"#keen-example-chart\")',\n      '      .height(240)',\n      '      .title(\"' + chartTitle + '\")',\n      '' + chartType ? '      .type(\"' + chartType + '\")' : '',\n      '      .prepare();',\n      '    ',\n      '    client',\n      '      .query(' + s(params.analysis_type) + ', {',\n               dynamicCriteria,\n      '      })',\n      '      .then(function(res) {',\n      '        chart.data(res).render();',\n      '      })',\n      '      .catch(function(err) {',\n      '        chart.message(err.message);',\n      '      });',\n      '    ',\n      '  </script>',\n      '</body>',\n      '</html>'\n    ]\n    return _.filter(value, function(val) { return val !== \"\"; }).join('\\n');\n  },\n\n  slugify: function(name) {\n    return name.toLowerCase().replace(/[^\\w\\s-]/g, '').replace(/ /g, '-');\n  }\n\n};\n\nexport default ExplorerUtils;\n","import _ from 'lodash';\nimport DateUtils from './DateUtils';\nimport FormatUtils from './FormatUtils.js';\n\n// ***********************\n// ** Project Constants\n// ***********************\n\nconst CONSTANTS = {\n\n  DEFAULT_TIMEZONE: 'UTC',\n\n  ANALYSIS_TYPES: [\n    'sum',\n    'count',\n    'count_unique',\n    'minimum',\n    'maximum',\n    'average',\n    'select_unique',\n    'extraction',\n    'percentile',\n    'median',\n    'funnel',\n    'standard_deviation'\n  ],\n\n  ABSOLUTE_INTERVAL_TYPES: [\n    { name: 'minutely', value: 'minutely' },\n    { name: 'hourly',   value: 'hourly' },\n    { name: 'daily',    value: 'daily' },\n    { name: 'weekly',   value: 'weekly' },\n    { name: 'monthly',  value: 'monthly' },\n    { name: 'yearly',   value: 'yearly' }\n  ],\n\n  RELATIVE_INTERVAL_TYPES: [\n    { name: 'minutes',  value: 'minutes' },\n    { name: 'hours',    value: 'hours' },\n    { name: 'days',     value: 'days' },\n    { name: 'weeks',    value: 'weeks' },\n    { name: 'months',   value: 'months' },\n    { name: 'years',    value: 'years' }\n  ],\n\n  TIMEZONES: [\n    {\n      name: 'UTC',\n      offset: 0,\n      dst_offset: 0\n    },\n    {\n      name: 'Europe/London',\n      offset: 0,\n      dst_offset: 3600\n    },\n    {\n      name: 'Africa/Casablanca',\n      offset: 0,\n      dst_offset: 0\n    },\n    {\n      name: 'Africa/Nairobi',\n      offset: 10800,\n      dst_offset: 0\n    },\n    {\n      name: 'Asia/Dubai',\n      offset: 14400,\n      dst_offset: 0\n    },\n    {\n      name: 'America/Sao_Paulo',\n      offset: -10800,\n      dst_offset: -7200\n    },\n    {\n      name: 'US/Eastern',\n      offset: -18000,\n      dst_offset: -14400\n    },\n    {\n      name: 'US/Central',\n      offset: -21600,\n      dst_offset: -18000\n    },\n    {\n      name: 'US/Mountain',\n      offset: -25200,\n      dst_offset: -21600\n    },\n    {\n      name: 'US/Pacific',\n      offset: -28800,\n      dst_offset: -25200\n    },\n    {\n      name: 'US/Alaska',\n      offset: -32400,\n      dst_offset: -28800\n    },\n    {\n      name: 'US/Hawaii',\n      offset: -36000,\n      dst_offset: -32400\n    },\n    {\n      name: 'Europe/Paris',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Europe/Amsterdam',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Europe/Stockholm',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Europe/Prague',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Asia/Istanbul',\n      offset: 7200,\n      dst_offset: 10800\n    },\n    {\n      name: 'Europe/Istanbul',\n      offset: 7200,\n      dst_offset: 10800\n    },\n    {\n      name: 'Europe/Copenhagen',\n      offset: 3600,\n      dst_offset: 7200\n    },\n    {\n      name: 'Asia/Jakarta',\n      offset: 25200,\n      dst_offset: 25200\n    },\n    {\n      name: 'Asia/Singapore',\n      offset: 28800,\n      dst_offset: 28800\n    },\n    {\n      name: 'Australia/Perth',\n      offset: 28800,\n      dst_offset: 28800\n    },\n    {\n      name: 'Asia/Tokyo',\n      offset: 32400,\n      dst_offset: 32400\n    },\n    {\n      name: 'Australia/Sydney',\n      offset: 36000,\n      dst_offset: 39600\n    },\n    {\n      name: 'Pacific/Auckland',\n      offset: 43200,\n      dst_offset: 46800\n    }\n  ],\n\n  FILTER_OPERATORS: [\n    { name: '\\u003D Equal to',\n      value: 'eq',\n      canBeCoeredTo: ['String', 'Number', 'Null', 'List', 'Boolean', 'Datetime']\n    },\n    { name: '\\u2260 Not equal to',\n      value: 'ne',\n      canBeCoeredTo: ['String', 'Number', 'Null', 'List', 'Boolean', 'Datetime']\n    },\n    { name: '\\u003E Greater than',\n      value: 'gt',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u2265 Greater than or equal to',\n      value: 'gte',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u003C Less than',\n      value: 'lt',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u2264 Less than or equal to',\n      value: 'lte',\n      canBeCoeredTo: ['Number', 'Null', 'Datetime', 'String']\n    },\n    { name: '\\u2203 Property exists',\n      value: 'exists',\n      canBeCoeredTo: ['Boolean']\n    },\n    { name: '\\u229A String contains',\n      value: 'contains',\n      canBeCoeredTo: ['String', 'Null']\n    },\n    { name: '\\u2349 String does not contain',\n      value: 'not_contains',\n      canBeCoeredTo: ['String', 'Null']\n    },\n    { name: '\\u29C7 Matches any value in a list',\n      value: 'in',\n      canBeCoeredTo: ['List']\n    },\n    { name: '\\u2690 Within a given radius (geo)',\n      value: 'within',\n      canBeCoeredTo: ['Geo']\n    }\n  ]\n};\n\nconst projectUtils = {\n\n  getConstant: function(name) {\n    return CONSTANTS[name];\n  },\n\n  eventsUrl: function(client) {\n    return client.url('events', {\n      api_key: client.config.masterKey\n    });\n  },\n\n  getEventCollectionPropertyNames: function(project, collection) {\n    return project.schema[collection] ? project.schema[collection].sortedProperties : [];\n  },\n\n  getPropertyType: function(project, collection, propertyName) {\n    var collection = project.schema[collection];\n    return collection ? collection.properties[propertyName] : null;\n  },\n\n  /*\n    Returns the local timezone offset in seconds offset from UTC.\n    This is how the Keen API wants the offset to look. This is also\n    opposite in negative/positive numbers from how Javascript\n    handles it.\n   */\n  getLocalTimezoneOffset: function(date){\n    return (new Date().getTimezoneOffset() * -1) * 60;\n  },\n\n  getLocalTimezone: function(date){\n    var isDST = DateUtils.isDST();\n    var localOffset = projectUtils.getLocalTimezoneOffset();\n    var zones = CONSTANTS.TIMEZONES.filter((zone) => {\n      if (isDST) {\n        return zone.dst_offset === localOffset;\n      } else {\n        return zone.offset === localOffset;\n      }\n    });\n    if (!zones.length) return localOffset;\n    return zones[0].name;\n  },\n\n};\n\nexport default projectUtils;\n","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport ExplorerConstants from '../constants/ExplorerConstants';\nimport ExplorerStore from '../stores/ExplorerStore';\nimport ExplorerValidations from '../validations/ExplorerValidations';\nimport NoticeActions from './NoticeActions';\nimport AppStateActions from './AppStateActions';\nimport ProjectActions from './ProjectActions';\nimport ProjectStore from '../stores/ProjectStore';\nimport RunValidations from '../utils/RunValidations';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport ChartTypeUtils from '../utils/ChartTypeUtils';\nimport CashedQueryUtils from '../utils/CashedQueryUtils';\nimport QueryActions from '../components/explorer/query_actions';\n\nconst ExplorerActions = {\n\n  create: function(attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CREATE,\n      attrs: attrs\n    });\n  },\n\n  createBatch: function(models) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CREATE_BATCH,\n      models: models\n    });\n  },\n\n  clone: function(sourceId) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CLONE,\n      id: sourceId\n    });\n    NoticeActions.create({\n      text: \"Query cloned! Add a name for this cloned query and save it.\",\n      type: 'success',\n      icon: 'check'\n    });\n  },\n\n  update: function(id, updates) {\n    var updated_query, project = ProjectStore.getProject();\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: id,\n      updates: updates\n    });\n    // Fetch schema for selected event collection\n    updated_query = updates.query ? updates.query : updates.response && updates.response.query ? updates.response.query : {};\n    if (updated_query.event_collection) {\n      ProjectActions.fetchCollectionSchema(project.client, updated_query.event_collection);\n    }\n    if (updated_query.steps && updated_query.steps.length) {\n      _.each(updated_query.steps, function(step, i) {\n        ProjectActions.fetchCollectionSchema(project.client, step.event_collection);\n      });\n    }\n  },\n\n  remove: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE,\n      id: id\n    });\n  },\n\n  setActive: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SET_ACTIVE,\n      id: id\n    });\n  },\n\n  revertActiveChanges: function() {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REVERT_ACTIVE_CHANGES\n    });\n  },\n\n  clear: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_CLEAR,\n      id: id\n    });\n  },\n\n  validate: function(id) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_VALIDATE,\n      id: id\n    });\n  },\n\n  addFilter: function(id, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_ADD_FILTER,\n      id: id,\n      attrs: attrs\n    });\n  },\n\n  removeFilter: function(id, index) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE_FILTER,\n      id: id,\n      index: index\n    });\n  },\n\n  updateFilter: function(id, index, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE_FILTER,\n      id: id,\n      index: index,\n      attrs: attrs\n    });\n  },\n\n  addStep: function(id, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_ADD_STEP,\n      id: id,\n      attrs: attrs\n    });\n  },\n\n  removeStep: function(id, index) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE_STEP,\n      id: id,\n      index: index\n    });\n  },\n\n  setStepActive: function(id, index) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SET_STEP_ACTIVE,\n      id: id,\n      index: index\n    });\n  },\n\n  updateStep: function(id, index, attrs) {\n    var project = ProjectStore.getProject();\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE_STEP,\n      id: id,\n      index: index,\n      attrs: attrs\n    });\n\n    // Fetch schema for selected event collection\n    if (attrs.event_collection) {\n      ProjectActions.fetchCollectionSchema(project.client, attrs.event_collection);\n    }\n  },\n\n  moveStep: function(id, index, direction) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_MOVE_STEP,\n      id: id,\n      index: index,\n      direction: direction\n    });\n  },\n\n  addStepFilter: function(id, stepIndex, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_ADD_STEP_FILTER,\n      id: id,\n      stepIndex: stepIndex,\n      attrs: attrs\n    });\n  },\n\n  removeStepFilter: function(id, stepIndex, filterIndex) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_REMOVE_STEP_FILTER,\n      id: id,\n      stepIndex: stepIndex,\n      filterIndex: filterIndex\n    });\n  },\n\n  updateStepFilter: function(id, stepIndex, filterIndex, attrs) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE_STEP_FILTER,\n      id: id,\n      stepIndex: stepIndex,\n      filterIndex: filterIndex,\n      attrs: attrs\n    });\n  },\n\n  exec: function(client, id) {\n    var explorer = ExplorerStore.get(id);\n    if (explorer.loading) {\n      throw new Error(\"Warning: calling exec when model loading is true. Explorer id: \" + explorer.id);\n    }\n    ExplorerActions.validate(explorer.id);\n    explorer = ExplorerStore.get(id);\n    if (!explorer.isValid) {\n      AppDispatcher.dispatch({\n        actionType: ExplorerConstants.EXPLORER_FOUND_INVALID,\n        id: explorer.id\n      });\n      return;\n    }\n    NoticeActions.clearAll();\n\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: explorer.id,\n      updates: { loading: true }\n    });\n\n    ExplorerUtils.runQuery({\n      client: client,\n      query: ExplorerUtils.queryJSON(explorer),\n      error: ExplorerActions.execError.bind(this, explorer),\n      success: ExplorerActions.execSuccess.bind(this, explorer)\n    });\n  },\n\n  execError: function(explorer, err) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_QUERY_ERROR,\n      query: explorer.query,\n      error: err.message\n    });\n    ExplorerActions.update(explorer.id, { loading: false });\n    NoticeActions.create({ text: err.message, type: 'error' });\n  },\n\n  execSuccess: function (explorer, response) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_QUERY_SUCCESS,\n      query: explorer.query,\n      isSaved: ExplorerUtils.isPersisted(explorer)\n    });\n    NoticeActions.clearAll();\n\n    var updates = {};\n    updates.response = response;\n    // If there is no query object on the response, add one. This is required for Dataviz to properly auto-parse\n    // the result + the query to correctly choose a chart type.\n    if (!response.query) response.query = ExplorerUtils.queryJSON(explorer);\n    updates.loading = false;\n\n    if (!ChartTypeUtils.responseSupportsChartType(response.query, explorer.metadata.visualization.chart_type)) {\n      updates.metadata = _.cloneDeep(explorer.metadata);\n      updates.metadata.visualization.chart_type = ChartTypeUtils.getChartTypeOptions(response.query)[0];\n    }\n\n    updates.dataTimestamp = Date.now();\n    ExplorerActions.update(explorer.id, updates);\n  },\n\n  runEmailExtraction: function(client, id) {\n    ExplorerActions.validate(id);\n    var explorer = ExplorerStore.get(id);\n\n    if (!explorer.isValid) {\n      AppDispatcher.dispatch({\n        actionType: ExplorerConstants.EXPLORER_FOUND_INVALID,\n        id: explorer.id\n      });\n      return;\n    }\n    NoticeActions.clearAll();\n\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: explorer.id,\n      updates: { loading: true }\n    });\n\n    ExplorerUtils.runQuery({\n      client: client,\n      query: ExplorerUtils.queryJSON(explorer),\n      success: ExplorerActions.runEmailExtractionSuccess.bind(this, explorer),\n      error: ExplorerActions.runEmailExtractionError,\n    });\n  },\n\n  runEmailExtractionSuccess: function(explorer, res) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_QUERY_SUCCESS,\n      query: explorer.query,\n      isSaved: ExplorerUtils.isPersisted(explorer)\n    });\n    NoticeActions.clearAll();\n    NoticeActions.create({\n      text: \"Email extraction successfully requested. Check your email (\"+explorer.query.email+\").\",\n      type: 'success',\n      icon: 'check'\n    });\n    ExplorerActions.update(explorer.id, {\n      result: res,\n      loading: false\n    });\n  },\n\n  runEmailExtractionError: function(err) {\n    NoticeActions.create({ text: err.message, type: 'error', icon: 'remove-sign' });\n  },\n\n  fetchAllPersisted: function(persistence, callback) {\n    AppStateActions.update({ fetchingPersistedExplorers: true });\n    persistence.get(null, function(err, resp) {\n      if (err) {\n        callback(err);\n        return;\n      }\n      var models = [];\n      resp.forEach(function(model) {\n        var formattedModel = ExplorerUtils.formatQueryParams(model);\n        RunValidations.run(ExplorerValidations, formattedModel);\n        if (!formattedModel.isValid) {\n          console.warn('A persisted explorer model is invalid: ', formattedModel);\n          console.log('Errors: ', formattedModel.errors);\n        }\n        models.push(formattedModel);\n      });\n      ExplorerActions.createBatch(models);\n      AppStateActions.update({ fetchingPersistedExplorers: false });\n      callback(null);\n    });\n  },\n\n  fetchPersisted: function(persistence, id, callback) {\n    persistence.get(id, function(err, resp) {\n      if (err) {\n        callback(err);\n        return;\n      }\n      var model = ExplorerUtils.formatQueryParams(resp);\n      RunValidations.run(ExplorerValidations, model);\n      if (!model.isValid) {\n        console.warn('A persisted explorer model is invalid: ', model);\n      }\n      ExplorerActions.create(model);\n      callback(null);\n    });\n  },\n\n  save: function(persistence, sourceId) {\n    var saveType = ExplorerUtils.saveType(ExplorerStore.get(sourceId));\n    var persistenceFunction = saveType === 'save' ? 'create' : 'update';\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SAVING,\n      id: sourceId,\n      saveType: saveType\n    });\n\n    var explorer = ExplorerStore.get(sourceId);\n    if (!explorer.isValid) {\n      AppDispatcher.dispatch({\n        actionType: ExplorerConstants.EXPLORER_FOUND_INVALID,\n        id: explorer.id\n      });\n      ExplorerActions.update(sourceId, { saving: false });\n      return;\n    }\n    NoticeActions.clearAll();\n\n    var explorerJSON = ExplorerUtils.cleanJSONforSave(\n      ExplorerUtils.toJSON(ExplorerStore.get(sourceId))\n    );\n    persistence[persistenceFunction](explorerJSON, function(err, res) {\n      if (err) {\n        if(err.error_code === 'OverCachedQueryLimitError'){\n          AppStateActions.update({ isLimited: true })\n        }\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_SAVE_FAIL,\n          saveType: saveType,\n          id: sourceId,\n          errorResp: err,\n          query: ExplorerStore.get(sourceId).query\n        });\n        return;\n      }\n      ExplorerActions.saveSuccess(sourceId, res);\n    });\n  },\n\n  saveSuccess: function(sourceId, res) {\n    var saveType = ExplorerUtils.saveType(ExplorerStore.get(sourceId));\n    var updatedModel = ExplorerUtils.mergeResponseWithExplorer(ExplorerStore.get(sourceId), res);\n    CashedQueryUtils.checkLimits();\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_UPDATE,\n      id: sourceId,\n      updates: updatedModel\n    });\n    // We need to use the new model id below, not the old sourceId passed in.\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_SAVE_SUCCESS,\n      id: updatedModel.id,\n      saveType: saveType,\n      query: updatedModel.query\n    });\n  },\n\n  destroy: function(persistence, sourceId) {\n    AppDispatcher.dispatch({\n      actionType: ExplorerConstants.EXPLORER_DESTROYING\n    });\n    var attrs = _.clone(ExplorerUtils.toJSON(ExplorerStore.get(sourceId)));\n    persistence.destroy(attrs, function(err, res) {\n      if (err) {\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_DESTROY_FAIL,\n          errorMsg: err,\n          query: ExplorerStore.get(sourceId).query\n        });\n      } else {\n        CashedQueryUtils.checkLimits();\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_REMOVE,\n          id: sourceId\n        });\n        AppDispatcher.dispatch({\n          actionType: ExplorerConstants.EXPLORER_DESTROY_SUCCESS,\n          query: attrs.query\n        });\n      }\n    });\n  }\n\n};\n\nexport default ExplorerActions;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","import _ from 'lodash';\nimport moment from 'moment';\nimport S from 'string';\nimport TimeframeUtils from './TimeframeUtils';\nimport FormatUtils from './FormatUtils';\nimport FilterValidations from '../validations/FilterValidations';\nimport RunValidations from './RunValidations';\n\nfunction exists(value) {\n  return !_.isNull(value) && !_.isUndefined(value);\n}\n\nfunction toType(obj) {\n  return ({}).toString.call(obj).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n}\n\nfunction isNumeric(num) {\n  return !isNaN(num);\n}\n\nconst filterUtils = {\n\n  coercionFunctions: {\n\n    'Datetime': function(filter) {\n      if (typeof filter.property_value === 'string') {\n        var coercedDate = new Date(filter.property_value);\n        if (coercedDate !== null && coercedDate.toString() !== 'Invalid Date') return coercedDate.toString();\n      }\n      return filterUtils.defaultDate();\n    },\n\n    'String': function(filter) {\n      if (!exists(filter.property_value)) return null;\n      return filter.property_value.toString();\n    },\n\n    'Number': function(filter) {\n      if (!exists(filter.property_value)) return null;\n      var newVal = parseFloat(filter.property_value);\n      if (typeof newVal === 'undefined' || newVal === null || isNaN(newVal)) {\n        newVal = '';\n      }\n      return newVal;\n    },\n\n    'Boolean': function(filter) {\n      var isFalse = filter.property_value === 'false' || filter.property_value === false;\n      return isFalse ? false : true;\n    },\n\n    'Null': function(filter) {\n      return null;\n    },\n\n    'Geo': function(filter) {\n      return filter.property_value;\n    },\n\n    'List': function(filter) {\n      return filter.property_value;\n    }\n\n  },\n\n  defaultDate: function() {\n    var yesterday = moment().subtract(1, 'days').startOf('day').format('x');\n    return new Date(Number(yesterday));\n  },\n\n  getCoercedValue: function(filter) {\n    if (!filterUtils.coercionFunctions[filter.coercion_type]) return null;\n    return filterUtils.coercionFunctions[filter.coercion_type](filter);\n  },\n\n  /**\n   * Gets the type for the given filter's property_value. This value should be raw, as in it should not have\n   * been put through getCoercedValue yet. So for example, if it's a list type, it should be a string with the\n   * expected list format: \"\\a word\\\"\", '1', '56', \\\"\"another word\\\"\"\n   * @param  {Object} filter The filter to get the property value coercion type for.\n   * @return {String}        The determined type for the given property value.\n   */\n  getCoercionType: function(filter) {\n    switch (toType(filter.property_value)) {\n      case 'object':\n        return 'Geo';\n        break;\n      case 'string':\n        if (filter.operator === 'exists') return 'Boolean';\n        if (['false', 'true'].indexOf(filter.property_value) > -1) return 'Boolean';\n        if (isNumeric(filter.property_value) && ['contains', 'not_contains'].indexOf(filter.operator) === -1) return 'Number';\n        if (FormatUtils.isDateInStrictFormat(filter.property_value.substring(0, filter.property_value.length-6))) return 'Datetime';\n        if (FormatUtils.isList(filter.property_value)) return 'List';\n        return 'String';\n        break;\n      case 'array':\n        return 'List';\n        break;\n      case 'boolean':\n        return 'Boolean';\n        break;\n      case 'number':\n        return 'Number';\n        break;\n      case 'null':\n        return 'Null';\n        break;\n    }\n  },\n\n  isComplete: function(filter) {\n    var attrs = [\n      'property_name',\n      'property_value',\n      'operator',\n      'coercion_type'\n    ];\n    var complete = true;\n    for(var i=0; i<attrs.length; i++) {\n      var val = filter[attrs[i]];\n      complete = !_.isUndefined(val) && !_.isNull(val);\n      if (_.isObject(val)) complete = !_.isEmpty(val);\n      if (!complete) break;\n    }\n    return complete;\n  },\n\n  queryJSON: function(filter) {\n    RunValidations.run(FilterValidations, filter);\n    if (!filter.isValid) return {};\n\n    var attrs = _.cloneDeep(filter);\n    attrs.property_value = filterUtils.getCoercedValue(filter);\n\n    if (attrs.coercion_type === 'Datetime') {\n      attrs.property_value = FormatUtils.formatISOTimeNoTimezone(attrs.property_value);\n    }\n    if (attrs.coercion_type === 'List') {\n      attrs.property_value = FormatUtils.parseList(attrs.property_value);\n    }\n\n    return _.pick(attrs, ['property_name', 'operator', 'property_value']);\n  },\n\n  initList: function(filter) {\n    var newVal = \"\";\n    _.each(filter.property_value, function(item, index){\n      if (_.isString(item)) newVal += '\"' + item + '\"';\n      if (_.isNumber(item)) newVal += \"'\" + item + \"'\";\n      if (index !== filter.property_value.length - 1) newVal += ', ';\n    });\n    filter.property_value = newVal;\n    return filter;\n  },\n\n  formatFilterParams: function(filter) {\n    filter.coercion_type = filterUtils.getCoercionType(filter);\n    if (filter.coercion_type === 'List') {\n      filter = _.assign({}, filter, filterUtils.initList(filter));\n    }\n    filter.property_value = filterUtils.getCoercedValue(filter);\n    if (filter.coercion_type === 'Datetime') {\n      filter.property_value = FormatUtils.convertDateToUTC(new Date(filter.property_value));\n    }\n    return filter;\n  },\n\n  coerceGeoValue: function(value) {\n    var trailingDecimals = value.match(/\\.+$/);\n    if (value === '-' || (trailingDecimals && trailingDecimals.length)) {\n      return value;\n    } else {\n      return parseFloat(value) || 0;\n    }\n  },\n\n  validFilters: function(filters) {\n    return _.filter(filters, function(filter) {\n      RunValidations.run(FilterValidations, filter)\n      return filter.isValid;\n    });\n  }\n\n};\n\nexport default filterUtils;\n","import { Dispatcher } from 'flux';\n\nexport default new Dispatcher();\n","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","const run = function(validatorSet, model) {\n    var keys = Object.keys(validatorSet);\n    model.isValid = true;\n    model.errors = [];\n\n    for (var i=0; i<keys.length; i++) {\n      var validator = validatorSet[keys[i]];\n\n      // Check if this validator should be run at all.\n      if (validator.shouldRun && !validator.shouldRun(model)) continue;\n\n      var result = validator.validate(model);\n\n      // Validator returned true. This attribute is valid. Move on.\n      if (result === true) continue;\n\n      // There is an error. Set the model as invalid and set the errors on the model.\n      model.isValid = false;\n      model.errors.push({\n        attribute: keys[i],\n        msg: (result === false) ? validator.msg : result\n      });\n    }\n};\nexport default { run };\n","/* ExplorerStore */\n\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport _ from 'lodash';\nimport ProjectConstants from '../constants/ProjectConstants';\nimport ProjectUtils from '../utils/ProjectUtils';\nimport FormatUtils from '../utils/FormatUtils';\n\nconst CHANGE_EVENT = 'change';\n\nlet _projects = {};\n\nfunction defaultAttrs() {\n  return {\n    id: null,\n    loading: true,\n    eventCollections: [],\n    sortedEventCollections: {},\n    schema: {}\n  };\n}\n\nfunction _create(attrs) {\n  var id = FormatUtils.generateTempId();\n  _projects[id] = _.assign(defaultAttrs(), { id: id }, attrs);\n}\n\nfunction _update(id, updates) {\n  _projects[id] = _.assign({}, _projects[id], updates);\n}\n\nfunction _updateEventCollection(id, collectionName, updates) {\n  var newCollection = _.assign(\n    {},\n    _projects[id].schema[collectionName],\n    updates\n  );\n  _projects[id].schema[collectionName] = newCollection;\n}\n\nvar ProjectStore = _.assign({}, EventEmitter.prototype, {\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(_dispatcherToken);\n  },\n\n  clearAll: function() {\n    _projects = {};\n  },\n\n  getProject: function() {\n    var keys = Object.keys(_projects);\n    if (keys.length) {\n      return _projects[keys[0]];\n    }\n  },\n\n  getAll: function() {\n    return _projects;\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n});\n\n// Register callback to handle all updates\nvar _dispatcherToken = AppDispatcher.register(function(action) {\n  var attrs;\n\n  switch(action.actionType) {\n    case ProjectConstants.PROJECT_CREATE:\n      _create(action.attrs);\n      ProjectStore.emitChange();\n      break;\n\n    case ProjectConstants.PROJECT_UPDATE:\n      _update(action.id, action.updates);\n      ProjectStore.emitChange();\n      break;\n\n    case ProjectConstants.PROJECT_UPDATE_EVENT_COLLECTION:\n      _updateEventCollection(action.id, action.collectionName, action.updates);\n      ProjectStore.emitChange();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default ProjectStore;\n","/* ExplorerStore */\n\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport _ from 'lodash';\nimport ExplorerConstants from '../constants/ExplorerConstants';\nimport FormatUtils from '../utils/FormatUtils';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport FilterUtils from '../utils/FilterUtils';\nimport ProjectUtils from '../utils/ProjectUtils';\nimport ProjectStore from './ProjectStore';\n\nimport RunValidations from '../utils/RunValidations.js';\nimport ExplorerValidations from '../validations/ExplorerValidations.js';\nimport FilterValidations from '../validations/FilterValidations.js';\nimport StepValidations from '../validations/StepValidations.js';\n\nconst CHANGE_EVENT = 'change';\nconst SHARED_FUNNEL_STEP_PROPERTIES = ['event_collection', 'time', 'timezone', 'filters'];\n\nlet _explorers = {};\n\nfunction _defaultAttrs() {\n  return {\n    id: FormatUtils.generateTempId(),\n    query_name: null,\n    active: false,\n    saving: false,\n    dataTimestamp: null,\n    response: null,\n    loading: false,\n    isValid: true,\n    errors: [],\n    refresh_rate: 0,\n    query: {\n      event_collection: null,\n      analysis_type: null,\n      target_property: null,\n      percentile: null,\n      group_by: [],\n      interval: null,\n      timezone: ProjectUtils.getLocalTimezone(),\n      filters: [],\n      steps: [],\n      email: null,\n      latest: null,\n      property_names: [],\n      time: {\n        relativity: 'this',\n        amount: 14,\n        sub_timeframe: 'days'\n      }\n    },\n    metadata: _defaultMetadata()\n  };\n}\n\nfunction _defaultMetadata() {\n  return {\n    display_name: null,\n    visualization: {\n      chart_type: null\n    }\n  };\n}\n\nfunction _defaultFilter() {\n  return {\n    property_name: null,\n    property_value: null,\n    operator: 'eq',\n    coercion_type: 'String',\n    isValid: true,\n    errors: []\n  };\n}\n\nfunction _defaultGeoFilter() {\n  return {\n    coordinates: [],\n    max_distance_miles: null\n  };\n}\n\nfunction _defaultStep() {\n  return {\n    event_collection: null,\n    actor_property: null,\n    time: {\n      relativity: 'this',\n      amount: 14,\n      sub_timeframe: 'days'\n    },\n    timezone: ProjectUtils.getLocalTimezone(),\n    filters: [],\n    optional: false,\n    inverted: false,\n    with_actors: false,\n    active: false,\n    isValid: true,\n    errors: []\n  }\n}\n\n\nfunction _validate(id) {\n  RunValidations.run(ExplorerValidations, _explorers[id]);\n}\n\n/**\n * Get the default coercion type for this filter based off the filter's property_name's set type\n * in the project schema.\n * @param  {Object} explorer  The explorer model that the filter belongs to\n * @param  {Object} filter    The filter\n * @return {String}           The default coercion type\n */\nfunction _getDefaultFilterCoercionType(explorer, filter) {\n  var propertyType = ProjectUtils.getPropertyType(\n    ProjectStore.getProject(),\n    explorer.query.event_collection,\n    filter.property_name);\n  var targetCoercionType = FormatUtils.coercionTypeForPropertyType(propertyType);\n  return targetCoercionType;\n}\n\n/**\n * Runs through the changeset and moves data around if necessary\n * @param {Object} explorer   The explorer model that is being updated\n * @param {Object} updates    The updated explorer model\n * @return {Object}           The new set of updates\n */\nfunction _prepareUpdates(explorer, updates) {\n  // TODO: We're assigning the response object directly onto the model so we\n  // don't have to loop through the (sometimes) massive response object.\n  function customizer(objValue, srcValue, key) {\n    if (_.isArray(objValue)) {\n      return srcValue;\n    } else if (key === 'time' && _.isPlainObject(objValue)) {\n      return srcValue;\n    }\n  }\n  var newModel = _.mergeWith({}, explorer, _.omit(updates, 'response'), customizer);\n  if (updates.response) newModel.response = updates.response;\n\n  // Check if the event collection has changed. Clear the property names if so.\n  if (updates.query && updates.query.event_collection && updates.query.event_collection !== explorer.query.event_collection) {\n    newModel.query.property_names = [];\n  }\n\n  if(newModel.query.analysis_type === 'funnel' && explorer.query.analysis_type !== 'funnel') {\n    newModel = _migrateToFunnel(explorer, newModel);\n  } else if(newModel.query.analysis_type !== 'funnel' && explorer.query.analysis_type === 'funnel') {\n    newModel = _migrateFromFunnel(explorer, newModel);\n  }\n  newModel = _removeInvalidFields(newModel);\n\n  return newModel;\n}\n\n/**\n * If the query got changed to a funnel, move the step-specific parameters to a steps object.\n * @param {Object} explorer The explorer model that is being updated\n * @param {Object} newModel The updated explorer model\n * @return {Object}         The new set of updates\n */\nfunction _migrateToFunnel(explorer, newModel) {\n  var firstStep = _defaultStep();\n  firstStep.active = true;\n\n  _.each(SHARED_FUNNEL_STEP_PROPERTIES, function (key) {\n    if(!_.isUndefined(explorer.query[key]) && !_.isNull(explorer.query[key])) {\n      firstStep[key] = explorer.query[key]\n    }\n\n    newModel.query[key] = (key === 'filters') ? [] : null;\n  });\n\n  if(!_.isUndefined(explorer.query.target_property) && !_.isNull(explorer.query.target_property)) {\n    firstStep.actor_property = explorer.query.target_property;\n    explorer.query.target_property = null;\n  }\n\n  newModel.query.steps = [firstStep];\n\n  return newModel;\n}\n\n/**\n * If the query got changed from a funnel, move the applicable parameters out to the root query\n * @param {Object} explorer The explorer model that is being updated\n * @param {Object} newModel The updated explorer model\n * @return {Object}         The new set of updates\n */\nfunction _migrateFromFunnel(explorer, newModel) {\n  if (explorer.query.steps.length < 1) return newModel;\n  var activeStep = _.find(explorer.query.steps, { active: true }) || explorer.query.steps[0];\n\n  _.each(SHARED_FUNNEL_STEP_PROPERTIES, function (key) {\n    if (!_.isUndefined(activeStep[key])) {\n      newModel.query[key] = activeStep[key];\n    }\n  });\n\n  if (!_.isNull(activeStep.actor_property) && ExplorerUtils.shouldHaveTarget(newModel)) {\n    newModel.query.target_property = activeStep.actor_property;\n  }\n\n  newModel.query.steps = [];\n\n  return newModel;\n}\n\n/**\n * Removes fields from the query that aren't valid given the new analysis type.\n * @param {Object} newModel   The updated explorer model\n * @return {Object}           The new set of updates\n */\nfunction _removeInvalidFields(newModel) {\n  if (!ExplorerUtils.isEmailExtraction(newModel)) {\n    newModel.query.latest = null;\n    newModel.query.email = null;\n  }\n  if (newModel.query.analysis_type === 'extraction') {\n    newModel.query.group_by = null;\n    newModel.query.interval = null;\n  }\n  if (newModel.query.analysis_type !== 'extraction') {\n    newModel.query.latest = null;\n  }\n  if (newModel.query.analysis_type !== 'percentile') {\n    newModel.query.percentile = null;\n  }\n  if (_.includes(['count', 'extraction', 'funnel'], newModel.query.analysis_type)) {\n    newModel.query.target_property = null;\n  }\n  if (newModel.query.analysis_type !== 'funnel') {\n    newModel.query.steps = [];\n  }\n  if(newModel.query.analysis_type === 'funnel') {\n    newModel.query.filters = [];\n    newModel.query.time = null;\n    newModel.query.timezone = null;\n    newModel.query.group_by = null;\n    newModel.query.timeframe = null;\n    newModel.query.interval = null;\n  }\n  return newModel;\n}\n\n/**\n * Looks at updates about to be made to a filter and performs a series of operations to\n * change the filter values depending on the coercion_type, operator and type of property_value.\n * @param  {Object} explorer  The explorer model that owns the filter to be updated\n * @param  {Object} filter    The filter to be updated\n * @param  {Object} updates   The updates to be made to the filter\n * @return {Object}           The updated version of the filter after the changes have been made to it.\n */\nfunction _prepareFilterUpdates(explorer, filter, updates) {\n  if (updates.property_name && updates.property_name !== filter.property_name) {\n    if (filter.operator === 'exists') {\n      updates.coercion_type = 'Boolean';\n    } else {\n      // No need to update the operator - we allow any operator for any property type right now.\n      updates.coercion_type = _getDefaultFilterCoercionType(explorer, _.merge({}, filter, updates));\n    }\n  }\n  else if (updates.operator && updates.operator !== filter.operator) {\n    var newOp = updates.operator;\n    if (newOp === 'in') updates.coercion_type = 'List';\n    if (newOp === 'exists') updates.coercion_type = 'Boolean';\n    if (newOp === 'within') updates.coercion_type = 'Geo';\n\n    // If it's not any of these operators, we still need to make sure that the current coercion_type is available\n    // as an option for this new operator.\n    var coercionOptions = _.find(ProjectUtils.getConstant('FILTER_OPERATORS'), { value: updates.operator }).canBeCoeredTo;\n    var coercion_type = updates.coercion_type || filter.coercion_type;\n    if (!_.includes(coercionOptions, coercion_type)) {\n      updates.coercion_type = coercionOptions[0];\n    }\n  }\n\n  if (updates.coercion_type === 'Geo' && filter.coercion_type !== 'Geo') {\n    updates.property_value = _defaultGeoFilter();\n  }\n\n  updates.property_value = FilterUtils.getCoercedValue(_.merge({}, filter, updates));\n\n  return updates;\n}\n\nfunction _wrapGroupBy(group_by) {\n  if (!_.isArray(group_by)) group_by = [group_by];\n  return _.pull(group_by, null);\n}\n\nfunction _create(attrs) {\n  if (attrs && attrs.active === true) {\n    throw new Error('You must use setActive to set a model as active.');\n    return;\n  }\n\n  attrs = attrs || {};\n  var newAttrs = _.merge(_defaultAttrs(), attrs);\n\n  if (newAttrs.query.steps) {\n    newAttrs.query.steps = _.map(newAttrs.query.steps, function (step) {\n      return _.merge(_defaultStep(), step);\n    });\n  }\n  if (!newAttrs.metadata) newAttrs.metadata = _defaultMetadata();\n  newAttrs.query.group_by = _wrapGroupBy(newAttrs.query.group_by);\n  newAttrs.query.percentile = parseFloat(newAttrs.query.percentile) || null;\n\n  _explorers[newAttrs.id] = newAttrs;\n  return newAttrs.id;\n}\n\nfunction _update(id, updates) {\n  if (updates && updates.active === true && !_explorers[id].active) {\n    throw new Error('You must use setActive to set a model as active.');\n    return;\n  }\n\n  var newModel = _prepareUpdates(_explorers[id], updates);\n  newModel.query.group_by = _wrapGroupBy(newModel.query.group_by);\n  newModel.query.percentile = parseFloat(newModel.query.percentile) || null;\n\n  if (updates.id && updates.id !== id) {\n    _explorers[updates.id] = newModel;\n    delete _explorers[id];\n    return updates.id;\n  } else {\n    _explorers[id] = newModel;\n    return id;\n  }\n}\n\nfunction _markFirstInvalidStepActive(id) {\n  var explorer = _explorers[id];\n  if (explorer.query.analysis_type !== 'funnel') return;\n  explorer.query.steps.forEach(function(step, index) {\n    if (!step.isValid) _setStepActive(id, index);\n  });\n}\n\nfunction _remove(id) {\n  delete _explorers[id];\n}\n\nfunction _setActive(id) {\n  _.each(_explorers, function(explorer, key) {\n    explorer.active = false;\n    delete explorer.originalModel;\n  });\n  _explorers[id].active = true;\n  _explorers[id].originalModel = _.cloneDeep(_explorers[id]);\n}\n\nfunction _revertActiveChanges() {\n  var active = _.find(_explorers, { active: true });\n  var original = _explorers[active.id].originalModel;\n  _explorers[active.id] = _.assign({}, original, { originalModel: original, response: active.response });\n  return active.id;\n}\n\nfunction _addFilter(id, attrs) {\n  attrs = attrs || {};\n  _explorers[id].query.filters.push(_.assign(_defaultFilter(), attrs));\n}\n\nfunction _removeFilter(id, index) {\n  _explorers[id].query.filters.splice(index, 1);\n}\n\nfunction _updateFilter(id, index, updates) {\n  var filter = _explorers[id].query.filters[index];\n  var updates = _prepareFilterUpdates(_explorers[id], filter, updates);\n\n  _explorers[id].query.filters[index] = _.assign({}, filter, updates);\n\n  // Hack around the fact that _.assign doesn't assign null values. But we\n  // actually WANT a null value if the coercion_type is null.\n  if (_explorers[id].query.filters[index].coercion_type === 'Null') {\n    _explorers[id].query.filters[index].property_value = null;\n  }\n}\n\nfunction _addStep(id, attrs) {\n  var explorer = _explorers[id];\n  if (explorer.query.analysis_type !== 'funnel') {\n    throw new Error('Error: Attempting to add a step to a non-funnel query. Explorer id: '+explorer.id);\n  }\n  var step = _.assign(_defaultStep(), attrs || {});\n  step.active = true;\n\n  // This is likely always true, but I like being defensive\n  if(explorer.query.steps.length > 0) {\n    var lastStep = explorer.query.steps[explorer.query.steps.length - 1];\n\n    step.time = lastStep.time;\n    step.timezone = lastStep.timezone;\n  }\n\n  explorer.query.steps.push(step);\n  _setStepActive(id, explorer.query.steps.length - 1);\n}\n\nfunction _removeStep(id, index) {\n  _explorers[id].query.steps.splice(index, 1);\n\n  if(index > _explorers[id].query.steps.length - 1) {\n    _setStepActive(id, _explorers[id].query.steps.length - 1);\n  } else {\n    _setStepActive(id, index);\n  }\n}\n\nfunction _updateStep(id, index, updates) {\n  var step = _explorers[id].query.steps[index];\n  _explorers[id].query.steps[index] = _.assign({}, step, updates);\n}\n\nfunction _setStepActive(id, index) {\n  _explorers[id].query.steps.forEach(function(step) {\n    step.active = false\n  })\n  _explorers[id].query.steps[index].active = true;\n}\n\nfunction _moveStep(id, index, direction) {\n  var steps = _.cloneDeep(_explorers[id].query.steps);\n\n  if (direction === 'up') {\n    if (index === 0) return;\n\n    var stepToDisplace = steps[index-1];\n    var step = steps[index];\n    steps[index-1] = step;\n    steps[index] = stepToDisplace;\n  }\n  if (direction === 'down') {\n    if (index === steps.length-1) return;\n\n    var stepToDisplace = steps[index+1];\n    var step = steps[index];\n    steps[index+1] = step;\n    steps[index] = stepToDisplace;\n  }\n\n  _explorers[id].query.steps = steps;\n}\n\nfunction _addStepFilter(id, stepIndex, attrs) {\n  attrs = attrs || {};\n  _explorers[id].query.steps[stepIndex].filters.push(_.assign(_defaultFilter(), attrs));\n}\n\nfunction _removeStepFilter(id, stepIndex, filterIndex) {\n  _explorers[id].query.steps[stepIndex].filters.splice(filterIndex, 1);\n}\n\nfunction _updateStepFilter(id, stepIndex, filterIndex, updates) {\n  var filter = _explorers[id].query.steps[stepIndex].filters[filterIndex];\n  var updates = _prepareFilterUpdates(_explorers[id], filter, updates);\n  _explorers[id].query.steps[stepIndex].filters[filterIndex] = _.assign({}, filter, updates);\n\n  // Hack around the fact that _.assign doesn't assign null values. But we\n  // actually WANT a null value if the coercion_type is null.\n  if (_explorers[id].query.steps[stepIndex].filters[filterIndex].coercion_type === 'Null') {\n    _explorers[id].query.steps[stepIndex].filters[filterIndex].property_value = null;\n  }\n}\n\nfunction _clear(id) {\n  var model = _explorers[id];\n  _explorers[id] = _.assign({}, _defaultAttrs(), _.pick(model, ['id', 'query_name', 'active', 'metadata', 'originalModel']));\n}\n\nvar ExplorerStore = _.assign({}, EventEmitter.prototype, {\n\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(this.dispatchToken);\n  },\n\n  clearAll: function() {\n    _explorers = {};\n  },\n\n  set: function(explorer) {\n    _explorers[explorer.id] = explorer;\n  },\n\n  get: function(id) {\n    return _explorers[id];\n  },\n\n  getActive: function() {\n    return _.find(_explorers, { active: true });\n  },\n\n  getAll: function() {\n    return _explorers;\n  },\n\n  getLast: function() {\n    var keys = _.keys(_explorers);\n    return _explorers[keys[keys.length-1]];\n  },\n\n  getAllPersisted: function() {\n    return _.filter(_explorers, function(explorer){\n      return ExplorerUtils.isPersisted(explorer);\n    });\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n\n});\n\n// Register callback to handle all updates\nExplorerStore.dispatchToken = AppDispatcher.register(function(action) {\n\n  function finishAction(id) {\n    // Validate the model\n    if (id) _validate(id);\n\n    // Emit change\n    ExplorerStore.emitChange();\n  }\n\n  switch(action.actionType) {\n    case ExplorerConstants.EXPLORER_CREATE:\n      _create(action.attrs);\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_CREATE_BATCH:\n      action.models.forEach(function(model) {\n        _explorers[model.id] ? _update(model.id, model) : _create(model);\n      });\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_CLONE:\n      var source = ExplorerStore.get(action.id);\n      _create({ query: _.cloneDeep(source.query),\n                metadata: {\n                  display_name: null,\n                  visualization: {\n                    chart_type: _.cloneDeep(source.metadata.visualization.chart_type)\n                  }\n                }\n              });\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE:\n      var id = _update(action.id, action.updates);\n      finishAction(id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE:\n      var wasActive = (_explorers[action.id].active === true);\n      _remove(action.id);\n      // Create a new active explorer to replace the previously active one.\n      if (wasActive) {\n        var id = _create();\n        _setActive(id);\n      }\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_SET_ACTIVE:\n      _setActive(action.id);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REVERT_ACTIVE_CHANGES:\n      var id = _revertActiveChanges();\n      finishAction(id);\n      break;\n\n    case ExplorerConstants.EXPLORER_CLEAR:\n      _clear(action.id);\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVING:\n      _update(action.id, { saving: true });\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_SUCCESS:\n      _update(action.id, { saving: false });\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_FAIL:\n      _update(action.id, { saving: false });\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_ADD_FILTER:\n      _addFilter(action.id, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE_FILTER:\n      _removeFilter(action.id, action.index);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE_FILTER:\n      _updateFilter(action.id, action.index, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_ADD_STEP:\n      _addStep(action.id, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE_STEP:\n      _removeStep(action.id, action.index);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE_STEP:\n      _updateStep(action.id, action.index, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_SET_STEP_ACTIVE:\n      _setStepActive(action.id, action.index);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_MOVE_STEP:\n      _moveStep(action.id, action.index, action.direction);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_ADD_STEP_FILTER:\n      _addStepFilter(action.id, action.stepIndex, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_REMOVE_STEP_FILTER:\n      _removeStepFilter(action.id, action.stepIndex, action.filterIndex);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_UPDATE_STEP_FILTER:\n      _updateStepFilter(action.id, action.stepIndex, action.filterIndex, action.attrs);\n      finishAction(action.id);\n      break;\n\n    case ExplorerConstants.EXPLORER_VALIDATE:\n      _validate(action.id);\n      finishAction();\n      break;\n\n    case ExplorerConstants.EXPLORER_FOUND_INVALID:\n      // Find any invalid steps and mark the first one active to display the notice.\n      _markFirstInvalidStepActive(action.id);\n      finishAction();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default ExplorerStore;\n","import React from 'react';\nimport _ from 'lodash';\n\n/* TODO:\n[ ] resting state (selection/empty)\n[x] activate component on `up/down` key, or by typing\n[x] 'esc' key to close w/out changing selection (webkit pattern)\n[~] accessibility\n    [x] announce/surface options to screen readers\n    [x] input field should instruct further key controls\n[x] snag: re-activating w/ prior selection -> only see that selection\n    - should we show all on first (re-)focus?\n    - only filter list when typing? track interaction states?\n[ ] snag: long strings wrap and throw off scroll-sync\n    - truncrate at calc'd length? maybe truncate the middle? 'beginning.ah...ok.end'\n    - crazy: 'walk' the truncatation of the 'active' li (from right to left) after a 1-2sec 'pause'\n    - can we use 'left/right' key actions to change truncation? maybe w/ CSS?\n[ ] snag: mobile. perhaps we should revert to native elements, to avoid input+list+keyboard hysteria?\n[ ] bug: Escape event listener bubbles up and closes the modal.\n[ ] bug: With breaks on selects inside filter manager modal.\n*/\n\nconst ReactSelect = React.createClass({\n\n  getDefaultProps: function() {\n    return {\n      items: [],\n      wrapClasses: '',\n      inputClasses: '',\n      placeholder: '',\n      handleBlur: function(){},\n      handleChange: function(){},\n      handleSelection: function(){}\n    };\n  },\n\n  getInitialState: function() {\n    return {\n      focusedItem: '',\n      limit: 30,\n      initialFocus: false,\n      selectedItem: 0,\n      visible: false,\n      visibleItems: 0\n    };\n  },\n\n  resetState: function(){\n    this.setState({\n      focusedItem: '',\n      limit: 30,\n      selectedItem: 0,\n      visible: false,\n      initialFocus: true\n    });\n  },\n\n  handleClick: function(e) {\n    this.setState({ visible: true });\n    this.handleItemFocus();\n  },\n\n  handleChange: function(e) {\n    var newState = {\n      initialFocus: false\n    };\n    if (this.state.visible) {\n      newState['limit'] = 30;\n      newState['selectedItem'] = 0;\n      this.refs.scrollpane.scrollTop = 0;\n    }\n    else {\n      newState['visible'] = true;\n    }\n    this.setState(newState);\n    this.props.handleChange(\n      this.props.name,\n      this.refs.input.value\n    );\n  },\n\n  handleFocus: function(e) {\n    if (!this.state.visible) {\n      this.setState({\n        initialFocus: true,\n        visible: true\n      });\n    }\n    else {\n      this.resetState();\n    }\n  },\n\n  handleBlur: function(e) {\n    if (this.refs.scrollpane && e.relatedTarget !== this.refs.scrollpane) {\n      if (!this.state.visible) e.preventDefault();\n      this.resetTimeout = setTimeout(this.resetState, 100);\n      this.blurTimeout = setTimeout(this.props.handleBlur(e), 100);\n    }\n  },\n\n  handleItemFocus: function() {\n    clearTimeout(this.resetTimeout);\n    clearTimeout(this.blurTimeout);\n  },\n\n  handleItemSelection: function(index) {\n    if (typeof this.props.items[index]) {\n      var selection = String(this.props.items[index]);\n      this.setState({ initialFocus: false });\n      this.refs.input.focus();\n      this.resetState();\n      this.props.handleChange(this.props.name, selection);\n      this.props.handleSelection(this.props.name, selection);\n    }\n  },\n\n  handleKeyDown: function(e) {\n    var itemHeight, itemOffset;\n\n    if (e.key === \"Tab\" || e.key === \"Shift\") return;\n\n    this.setState({ visible: true });\n\n    if (this.refs.list && this.state.selectedItem) {\n      itemHeight = this.refs.list.children[this.state.selectedItem].scrollHeight + 1;\n      itemOffset = itemHeight * this.state.selectedItem;\n    }\n\n    if (this.keyDownCallbacks[e.key]) {\n      this.keyDownCallbacks[e.key].call(this, e, itemHeight, itemOffset);\n    }\n  },\n\n  keyDownCallbacks: {\n\n    \"ArrowUp\": function(e, itemHeight, itemOffset) {\n      var newState = {};\n      var list = this.refs.list;\n\n      if (this.state.selectedItem-1 >= 0) {\n        newState['selectedItem'] = this.state.selectedItem-1;\n        if (list) {\n          newState['focusedItem'] = list.children[this.state.selectedItem-1].innerHTML;\n        }\n      }\n      else {\n        newState['selectedItem'] = 0;\n        if (list) {\n          newState['focusedItem'] = list.children[0].innerHTML;\n        }\n      }\n      this.setState(newState);\n\n      if (list && itemOffset > itemHeight*3) {\n        this.refs.scrollpane.scrollTop -= itemHeight;\n      }\n      e.preventDefault();\n    },\n\n    \"ArrowDown\": function(e, itemHeight, itemOffset) {\n      var newState = {};\n      var list = this.refs.list;\n\n      if (this.state.selectedItem+1 < this.visibleItems) {\n        newState['selectedItem'] = this.state.selectedItem+1;\n        if (list) {\n          newState['focusedItem'] = this.refs.list.children[this.state.selectedItem+1].innerHTML;\n        }\n      }\n      else {\n        newState['selectedItem'] = this.visibleItems-1;\n        if (list) {\n          newState['focusedItem'] = list.children[this.visibleItems-1].innerHTML;\n        }\n      }\n      this.setState(newState);\n\n      if (list && itemOffset > itemHeight*3) {\n        this.refs.scrollpane.scrollTop += itemHeight;\n      }\n      e.preventDefault();\n    },\n\n    \"Enter\": function(e, itemHeight, itemOffset) {\n      var list = this.refs.list;\n      if (list) {\n        var childNode = list.children[this.state.selectedItem];\n        if (childNode) this.handleItemSelection( childNode.getAttribute('data-index') );\n      }\n      else {\n        this.resetState();\n      }\n      e.preventDefault();\n    },\n\n    \"Escape\": function(e, itemHeight, itemOffset) {\n      this.handleBlur(e);\n      e.preventDefault();\n    }\n\n  },\n\n  handleScroll: function(e) {\n    var pane = this.refs.scrollpane;\n    var diff = pane.scrollHeight - pane.scrollTop - 200;\n      // -200 offset is a hack to account for fixed height\n    if (diff < 50) {\n      this.setState({ limit: this.state.limit + 30 });\n    }\n  },\n\n  // Data management\n\n  appendListItems: function(arr) {\n    var self = this;\n    arr.forEach(function(opt, i){\n      self.props.items.push(opt);\n    });\n    this.forceUpdate();\n    return this;\n  },\n\n  insertListItems: function(index, arr){\n    this.props.items.splice.apply(this.props.items, [index,0].concat(arr));\n    this.forceUpdate();\n    return this;\n  },\n\n  removeListItems: function(){\n    this.props.items = [];\n    this.forceUpdate();\n    return this;\n  },\n\n  getItems: function() {\n    var self = this;\n    var count = 0;\n    this.visibleItems = 0;\n    var inputString = this.state.initialFocus ? '' : (this.props.value || '');\n    return this.props.items.map(function(item, index) {\n      // If input is present, skip items that don't match\n      if (inputString.length > 0 && String(item).toLowerCase().search(_.escapeRegExp(inputString).toLowerCase()) < 0) return;\n\n      // Simple result limiting\n      count++; if (count > self.state.limit) return;\n      self.visibleItems = self.visibleItems+1;\n      return (\n        <li className={self.state.selectedItem === count-1 ? \"react-select-item active\" : \"react-select-item\" }\n          key={index}\n          data-index={index}\n          onMouseDown={self.handleItemSelection.bind(self, index)}\n          onFocus={self.handleItemFocus.bind(self, index)}\n          aria-live=\"polite\"\n          role=\"option\">\n            {item}\n        </li>\n      );\n    });\n  },\n\n  getScrollPane: function(items) {\n    // Hide scrollpane unless active\n    if (this.state.visible) {\n      return (\n        <div\n        ref=\"scrollpane\"\n        className=\"react-select-scrollpane\"\n        onScroll={this.handleScroll}\n        tabIndex=\"-1\"\n        aria-hidden=\"false\">\n          <div className=\"react-select-aria-notice\" aria-live=\"assertive\">\n            {this.state.focusedItem || ''}\n          </div>\n          <ul ref=\"list\" className=\"react-select-list\"\n              aria-atomic=\"false\"\n              aria-label=\"Begin typing to filter options, or key up or down to browse available options\"\n              aria-live=\"assertive\"\n              aria-relevant=\"additions\"\n              role=\"listbox\"\n              id={this.props.id + '-scrollpane'}>\n            {items}\n          </ul>\n        </div>\n      );\n    }\n  },\n\n  // React methods\n\n  render: function(){\n    var items = this.getItems();\n    var scrollpane = this.getScrollPane(items);\n\n    var wrapClasses = 'react-select';\n    if (this.props.wrapClasses) {\n      wrapClasses = wrapClasses + ' ' + this.props.wrapClasses;\n    }\n    if (this.state.visible) {\n      wrapClasses = wrapClasses + ' visible';\n    }\n\n    var inputClasses = 'react-select-input';\n    if (this.props.inputClasses) {\n      inputClasses = inputClasses + ' ' + this.props.inputClasses;\n    }\n\n    return (\n      <div ref=\"wrapper\" className={wrapClasses}>\n        <input ref=\"input\"\n               name={this.props.name}\n               className={inputClasses}\n               value={this.props.value || \"\"}\n               placeholder={this.props.placeholder}\n               onClick={this.handleClick}\n               onChange={this.handleChange}\n               onFocus={this.handleFocus}\n               onBlur={this.handleBlur}\n               onKeyDown={this.handleKeyDown}\n               aria-expanded={this.state.visible}\n               aria-owns={this.props.id + '-scrollpane'}\n               aria-label={this.props.title || \"Select value\"}\n               aria-selected={(this.props.value && this.props.value.length) ? true : undefined}\n               aria-live=\"polite\"\n               autoComplete=\"off\" />\n        {scrollpane}\n      </div>\n    );\n  }\n\n});\n\nexport default ReactSelect;\n","import _ from 'lodash';\nimport ProjectUtils from './ProjectUtils';\nimport FormatUtils from './FormatUtils';\n\nconst timeframeUtils = {\n\n  /**\n   * Takes a time object and returns a string representing the timeframe type (absolute or relative)\n   * @param  {Object} time The time object\n   * @return {String} The type of timeframe, 'absolute' or 'relative'\n   */\n   timeframeType: function(time) {\n      if (_.isUndefined(time)) {\n        return null;\n      } else if (!_.isPlainObject(time)) {\n        throw new Error('Invalid timeframe type: not a plain object.');\n      } else if (_.has(time, 'start') || _.has(time, 'end')) {\n        return 'absolute';\n      } else if (_.has(time, 'relativity') && _.has(time, 'amount') && _.has(time, 'sub_timeframe')) {\n        return 'relative';\n      } else {\n        throw new Error('Invalid timeframe type: invalid time value.');\n      }\n   },\n\n  getTimezoneOffset: function(timezone) {\n    var zone = _.find(ProjectUtils.getConstant('TIMEZONES'), { value: timezone });\n    return zone ? zone.offset : '+00:00';\n  },\n\n  timeframeBuilders: {\n\n    absolute: function(time) {\n      if (time && time.start && time.end) {\n        return {\n          start: FormatUtils.formatISOTimeNoTimezone(time.start),\n          end: FormatUtils.formatISOTimeNoTimezone(time.end)\n        };\n      }\n    },\n\n    relative: function(time) {\n      if (time && time.relativity && time.amount && time.sub_timeframe) {\n        return [time.relativity, time.amount, time.sub_timeframe].join('_');\n      }\n    }\n\n  },\n\n  getTimeframe: function(time) {\n    var timeframeBuilder = timeframeUtils.timeframeBuilders[timeframeUtils.timeframeType(time)];\n    if (typeof(timeframeBuilder) === 'undefined') return \"\";\n    return timeframeBuilder(time);\n  },\n\n  getTimeParameters: function(timeframe, timezone) {\n    return {\n      timeframe: timeframe ? timeframeUtils.getTimeframe(timeframe) : null,\n      timezone: timezone || ProjectUtils.getConstant('DEFAULT_TIMEZONE')\n    };\n  },\n\n  /**\n   * Takes a URL encoded timerame string or object and returns a time object that looks how the Explorer store wants\n   * it to\n   * @param  {String} timeframe\n   * @return {Object}\n   * Return structure:\n   * {\n   *  time: {an Object, either containing a deconstructed absolute or relative timeframe}\n   * }\n   */\n  unpackTimeframeParam: function(timeframe, timezone) {\n    if (typeof timeframe === 'object') {\n      return timeframeUtils.unpackAbsoluteTimeframe(timeframe, timezone);\n    } else if (typeof timeframe === 'string') {\n      return timeframeUtils.unpackRelativeTimeframe(timeframe, timezone);\n    }\n  },\n\n  unpackAbsoluteTimeframe: function (timeframe, timezone) {\n    var formattedValue = {\n      time: {},\n      timezone: null\n    };\n\n    if (!timezone || !ProjectUtils.getConstant('TIMEZONES').filter(z => z.name === timezone).length) {\n      formattedValue.timezone = 'UTC';\n    } else {\n      formattedValue.timezone = timezone;\n    }\n\n    var startVal = timeframe.start ? timeframe.start.substring(0, 19) : \"\";\n    formattedValue.time.start = FormatUtils.formatISOTimeNoTimezone(startVal);\n\n    var endVal = timeframe.end ? timeframe.end.substring(0, 19) : \"\";\n    formattedValue.time.end = FormatUtils.formatISOTimeNoTimezone(endVal);\n\n    return formattedValue;\n  },\n\n  unpackRelativeTimeframe: function (timeframe, timezone) {\n    var split = timeframe.split('_');\n    return {\n      time: {\n        relativity: split[0],\n        amount: split[1],\n        sub_timeframe: split[2]\n      },\n      timezone: timezone\n    };\n  }\n\n}\n\nexport default timeframeUtils;\n","import React from 'react';\nimport _ from 'lodash';\n\nconst SelectComponent = React.createClass({\n\n  buildOptions: function() {\n    if (this.state.options.length) {\n\n      return this.state.options.map(function(option) {\n        return (\n          <option value={option.value} key={option.value} disabled={option.disabled || false}>\n            {option.name}\n          </option>\n        );\n      });\n    } else {\n      return null;\n    }\n  },\n\n  wrapValuesInObjects: function(options) {\n    if (!_.isObject(options[0])) {\n      return _.map(options, function(option) {\n        return { name: option, value: option };\n      });\n    }\n    return options;\n  },\n\n  sortOptions: function(options) {\n    return options.sort(function(a, b){\n      var A = a.name.toLowerCase();\n      var B = b.name.toLowerCase();\n\n       if (A < B){\n        return -1;\n       } else if (A > B) {\n        return  1;\n       } else {\n         return 0;\n       }\n    });\n  },\n\n  buildEmptyOption: function() {\n    var emptyOption = this.props.emptyOption;\n\n    if (emptyOption === true) {\n      return (<option value=\"\"></option>);\n    } else if (emptyOption) {\n      return (<option value=\"\">{emptyOption}</option>);\n    } else {\n      return null;\n    }\n  },\n\n  setupOptions: function(options) {\n    var newOptions = this.wrapValuesInObjects(options);\n    if (this.props.sort) newOptions = this.sortOptions(newOptions);\n    return newOptions;\n  },\n\n  // React Methods\n\n  getDefaultProps: function() {\n    return {\n      classes: 'form-group',\n      sort: true,\n      emptyOption: true,\n      reference: 'select',\n      handleSelection: function(){},\n      handleBlur: function(){},\n      options: []\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ options: this.setupOptions(nextProps.options) });\n  },\n\n  getInitialState: function() {\n    return {\n      options: this.setupOptions(this.props.options)\n    };\n  },\n\n  render: function() {\n    var optionNodes = this.buildOptions();\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label}</label> : null;\n    var emptyOption = this.buildEmptyOption();\n    var emptyVal = this.props.multiple ? [] : ''\n    var selectedValue = this.props.selectedOption ? this.props.selectedOption : emptyVal;\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <div className=\"select-element\">\n          <select ref={this.props.reference}\n                  name={this.props.name}\n                  value={selectedValue}\n                  className=\"form-control\"\n                  multiple={this.props.multiple}\n                  onChange={this.props.handleSelection}\n                  onBlur={this.props.handleBlur}\n                  disabled={this.props.disabled}>\n            {emptyOption}\n            {optionNodes}\n          </select>\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default SelectComponent;\n","import React from 'react';\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nconst FieldsToggle = React.createClass({\n\n  handleFieldsToggle: function(toggledState) {\n    var attrNames = this.props.attrsToStore;\n    var updates = {};\n\n    if (!_.isArray(attrNames)) {\n      attrNames = [attrNames];\n    }\n    _.each(attrNames, function(attrName){\n      if (toggledState) {\n        if (this._storedAttrs[attrName]) {\n          updates[attrName] = this._storedAttrs[attrName];\n        }\n      } else {\n        this._storedAttrs[attrName] = this.props.getFn(attrName);\n        var resetVal = this.props.resetValues[attrName] || null;\n        updates[attrName] = resetVal;\n      }\n    }.bind(this));\n\n    this.props.updateFn(updates);\n  },\n\n  toggleButtonClick: function(event) {\n    event.preventDefault();\n    this.toggle();\n  },\n\n  toggle: function() {\n    var openState;\n    if (this.props.fieldsCount === null) {\n      openState = !this.state.open;\n      this.setState({ open: openState });\n      this.handleFieldsToggle(openState);\n    }\n    this.props.toggleCallback(openState || null);\n  },\n\n  // React Methods\n\n  componentWillMount: function() {\n    this._storedAttrs = {};\n  },\n\n  getDefaultProps: function() {\n    return {\n      toggleCallback: function(){},\n      initialOpenState: false,\n      fieldsCount: null,\n      resetValues: {}\n    };\n  },\n\n  getInitialState: function(){\n    return {\n      open: this.props.initialOpenState ? true : false\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    if (!this.props.initialOpenState && nextProps.initialOpenState) {\n      this.setState({ open: true });\n    }\n  },\n\n  render: function() {\n    var fieldsCount = this.props.fieldsCount ? this.props.fieldsCount : null;\n\n    var classes = classNames({\n      'has-fields-count': fieldsCount,\n      'open': this.state.open && fieldsCount === null,\n      'fields-toggle': true\n    });\n\n    var bodyContent;\n    if (this.props.children) {\n      bodyContent = (\n        <div className=\"toggle-body\">\n          {this.props.children}\n        </div>\n      );\n    }\n\n    return (\n      <div className={classes}>\n        <a href=\"#\" className=\"toggle-label\" onClick={this.toggleButtonClick} ref=\"toggle-label\">\n          <h5 ref=\"name\">{this.props.name}</h5>\n          <button type=\"button\" className=\"toggle-button\">\n            <span className=\"icon\" ref=\"icon\">{fieldsCount}</span>\n          </button>\n        </a>\n        {bodyContent}\n      </div>\n    );\n  }\n\n});\n\nexport default FieldsToggle;\n","import React from 'react';\nimport _ from 'lodash';\n\nconst InputComponent = React.createClass({\n\n  _onChange: function(event) {\n    this.setState({ value: event.target.value });\n    this.props.onChange(event);\n  },\n\n  getDefaultProps: function() {\n    return {\n      classes: 'form-group',\n      inputClasses: '',\n      type: 'text',\n      placeholder: '',\n      readonly: false,\n      onChange: function(){}\n    };\n  },\n\n  getInitialState: function() {\n    return {\n      value: this.props.value || ''\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ value: nextProps.value });\n  },\n\n  render: function() {\n    var required = this.props.required ? <small>(required)</small> : null;\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label} {required}</label> : null;\n    var inputClasses = \"form-control\";\n    if (this.props.inputClasses) inputClasses = inputClasses + \" \" + this.props.inputClasses;\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <input ref=\"input\"\n               type={this.props.type}\n               name={this.props.name}\n               className={inputClasses}\n               placeholder={this.props.placeholder}\n               onChange={this._onChange}\n               onBlur={this.props.onBlur}\n               value={this.state.value}\n               readOnly={this.props.readonly}\n               autoComplete=\"off\" />\n      </div>\n    );\n  }\n\n});\n\nexport default InputComponent;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__19__;","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  EXPLORER_CREATE: null,\n  EXPLORER_CREATE_BATCH: null,\n  EXPLORER_CLONE: null,\n  EXPLORER_UPDATE: null,\n  EXPLORER_REMOVE: null,\n  EXPLORER_SET_ACTIVE: null,\n  EXPLORER_REVERT_ACTIVE_CHANGES: null,\n  EXPLORER_CLEAR: null,\n  EXPLORER_VALIDATE: null,\n  EXPLORER_FOUND_INVALID: null,\n  EXPLORER_QUERY_SUCCESS: null,\n  EXPLORER_QUERY_ERROR: null,\n\n  // Filter Actions\n  EXPLORER_ADD_FILTER: null,\n  EXPLORER_REMOVE_FILTER: null,\n  EXPLORER_UPDATE_FILTER: null,\n  EXPLORER_ADD_STEP: null,\n  EXPLORER_REMOVE_STEP: null,\n  EXPLORER_UPDATE_STEP: null,\n  EXPLORER_SET_STEP_ACTIVE: null,\n  EXPLORER_MOVE_STEP: null,\n  EXPLORER_ADD_STEP_FILTER: null,\n  EXPLORER_REMOVE_STEP_FILTER: null,\n  EXPLORER_UPDATE_STEP_FILTER: null,\n\n  // Saved Query Actions\n  EXPLORER_SAVE: null,\n  EXPLORER_SAVE_NEW: null,\n  EXPLORER_DESTROY: null,\n  EXPLORER_SAVING: null,\n  EXPLORER_SAVE_SUCCESS: null,\n  EXPLORER_SAVE_FAIL: null,\n  EXPLORER_DESTROYING: null,\n  EXPLORER_DESTROY_SUCCESS: null,\n  EXPLORER_DESTROY_FAIL: null\n});\n","import AppDispatcher from '../dispatcher/AppDispatcher';\nimport NoticeConstants from '../constants/NoticeConstants';\n\nconst NoticeActions = {\n\n  create: function(attrs) {\n    AppDispatcher.dispatch({\n      actionType: NoticeConstants.NOTICE_CREATE,\n      attrs: attrs\n    });\n  },\n\n  clearAll: function() {\n    AppDispatcher.dispatch({\n      actionType: NoticeConstants.NOTICE_CLEAR_ALL\n    });\n  }\n\n};\n\nexport default NoticeActions;\n","import AppDispatcher from '../dispatcher/AppDispatcher';\nimport AppStateConstants from '../constants/AppStateConstants';\n\nconst AppStateActions = {\n\n  update: function(updates) {\n    AppDispatcher.dispatch({\n      actionType: AppStateConstants.APP_STATE_UPDATE,\n      updates: updates\n    });\n  },\n\n  reset: function() {\n    AppDispatcher.dispatch({\n      actionType: AppStateConstants.APP_STATE_RESET,\n    });\n  }\n\n};\n\nexport default AppStateActions;\n","import _ from 'lodash';\nimport FormatUtils from '../utils/FormatUtils';\n\nfunction isGeoCoercionType(model) {\n  return model.coercion_type === 'Geo';\n}\n\nexport default {\n\n  property_name: {\n\n    msg: 'Choose a property name',\n\n    validate: function(model) {\n      return (typeof model.property_name === 'string' && model.property_name.length > 0);\n    }\n\n  },\n\n  operator: {\n\n    msg: 'Choose an operator',\n\n    validate: function(model) {\n      return (typeof model.operator === 'string' && model.operator.length > 0);\n    }\n\n  },\n\n  property_value: {\n\n    msg: 'Choose a property value.',\n\n    shouldRun: function(model) {\n      return !isGeoCoercionType(model);\n    },\n\n    validate: function(model) {\n      var value = model.property_value;\n      var coercionType = model.coercion_type;\n\n      if (coercionType == 'List') {\n        return FormatUtils.parseList(value) ? true : false;\n      } else if (coercionType === 'Null' || coercionType === 'Boolean') {\n        return true;\n      } else if (coercionType === 'Number') {\n        return _.isNumber(value);\n      } else if (coercionType === 'String') {\n        return true;\n      } else {\n        return value ? true : false;\n      }\n    }\n\n  },\n\n  coercion_type: {\n\n    msg: 'Choose a coercion type',\n\n    validate: function(model) {\n      return (typeof model.coercion_type ==='string' && model.coercion_type.length > 0);\n    }\n\n  },\n\n  coordinates: {\n\n    msg: 'Provide all coordinates.',\n\n    shouldRun: isGeoCoercionType,\n\n    validate: function(model) {\n      var value = model.property_value.coordinates;\n      var valid = _.isArray(value) && value.length === 2;\n      if (!valid) return valid;\n\n      for(var i=0; i<value.length; i++) {\n        if (!valid) break;\n        valid = _.isNumber(value[i]);\n      }\n      return valid;\n    }\n\n  },\n\n  max_distance_miles: {\n\n    msg: 'Provide a max distance in miles.',\n\n    shouldRun: isGeoCoercionType,\n\n    validate: function(model) {\n      var value = model.property_value.max_distance_miles;\n      return value && _.isNumber(value);\n    }\n\n  }\n\n};\n","import React from 'react';\nimport _ from 'lodash';\n\nconst LoaderComponent = React.createClass({\n\n  toggle: function(visible) {\n    this.props.visible = visible;\n    this.forceUpdate();\n  },\n\n  // React Methods\n\n  getDefaultProps: function() {\n    return {\n      visible: false,\n      additionalClasses: false\n    };\n  },\n\n  render: function() {\n    var classes = \"explorer-loader\";\n    if (!this.props.visible) classes += \" hide\";\n    if (this.props.additionalClasses) classes += \" \" + this.props.additionalClasses;\n\n    return (\n      <div className={classes}>\n        <div className=\"msg\">\n          <div className=\"explorer-spinner\">\n            <div className=\"rect1\"></div>\n            <div className=\"rect2\"></div>\n            <div className=\"rect3\"></div>\n            <div className=\"rect4\"></div>\n            <div className=\"rect5\"></div>\n          </div>\n          Loading...\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default LoaderComponent;\n","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport ProjectConstants from '../constants/ProjectConstants';\nimport ProjectStore from '../stores/ProjectStore';\nimport ProjectUtils from '../utils/ProjectUtils';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport FormatUtils from '../utils/FormatUtils';\n\nconst ProjectActions = {\n\n  create: function(attrs) {\n    AppDispatcher.dispatch({\n      actionType: ProjectConstants.PROJECT_CREATE,\n      attrs: attrs\n    });\n  },\n\n  update: function(id, updates) {\n    var project = ProjectStore.getProject();\n\n    AppDispatcher.dispatch({\n      actionType: ProjectConstants.PROJECT_UPDATE,\n      id: project.id,\n      updates: updates\n    });\n  },\n\n  fetchProjectCollections: function(client) {\n    var project = ProjectStore.getProject();\n    if (!project) console.error(\"Cannot fetchProjectCollections: No project model has been created yet.\");\n    var authKey = client.masterKey() || client.readKey();\n\n    return client\n      .get(client.url('projectId'))\n      .auth(authKey)\n      .send()\n      .then(function(res){\n        var schema = _.assign({}, project.schema);\n        _.each(res.events, function(collection) {\n          schema[collection.name] = _.assign(collection, {\n            properties: {},\n            sortedProperties: [],\n            loading: false,\n            recentEvents: null\n          });\n        });\n        ProjectActions.update(project.id, {\n          schema: schema,\n          eventCollections: FormatUtils.sortItems(_.keys(schema)),\n          loading: false\n        });\n      })\n      .catch(function(err){\n        console.error('Error fetching project collections: ', err.stack);\n      });\n  },\n\n  fetchCollectionSchema: function(client, collectionName) {\n    var project = ProjectStore.getProject();\n    if (project.eventCollections.indexOf(collectionName) < 0) {\n      return false;\n    }\n    ProjectActions.updateEventCollection(collectionName, {\n      loading: true\n    });\n    return client\n      .get(client.url('events', encodeURIComponent(collectionName)))\n      .auth(client.masterKey())\n      .send()\n      .then(function(res) {\n        ProjectActions.updateEventCollection(collectionName, {\n          properties: res.properties,\n          sortedProperties: FormatUtils.sortItems(_.keys(res.properties)),\n          loading: false\n        });\n      })\n      .catch(function(err){\n        console.error('Error fetching project collections: ', err.stack);\n      });\n  },\n\n  updateEventCollection: function(collectionName, updates) {\n    var project = ProjectStore.getProject();\n    AppDispatcher.dispatch({\n      actionType: ProjectConstants.PROJECT_UPDATE_EVENT_COLLECTION,\n      id: project.id,\n      collectionName: collectionName,\n      updates: updates\n    });\n  },\n\n  fetchRecentEventsForCollection: function(client, eventCollection) {\n    var project = ProjectStore.getProject();\n    ProjectActions.updateEventCollection(eventCollection, {\n      loading: true\n    });\n    ExplorerUtils.runQuery({\n      client: client,\n      query: {\n        event_collection: eventCollection,\n        analysis_type: 'extraction',\n        latest: 10\n      },\n      success: function(res) {\n        ProjectActions.updateEventCollection(eventCollection, {\n          recentEvents: res.result\n        });\n      },\n      error: function(err) {\n        console.error(\"Error requesting latest events for event collection: \" + eventCollection, err.stack);\n      },\n      complete: function() {\n        ProjectActions.updateEventCollection(eventCollection, {\n          loading: false\n        });\n      }\n    });\n  }\n\n};\n\nexport default ProjectActions;\n","import React from 'react';\nimport _ from 'lodash';\n\nfunction noticeExists(notice) {\n  return notice && !_.isEmpty(notice);\n}\n\nconst NoticeComponent = React.createClass({\n\n  close: function(event) {\n    event.preventDefault();\n    this.setState({ open: false });\n    this.props.closeCallback();\n  },\n\n  getDefaultProps: function() {\n    return {\n      notice: {},\n      closeCallback: function(){},\n      closable: true\n    };\n  },\n\n  getInitialState: function() {\n    return {\n      open: noticeExists(this.props.notice)\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ open: noticeExists(nextProps.notice) });\n  },\n\n  render: function() {\n    var classes = 'notice-component alert';\n    if (!this.state.open) {\n      classes += ' hide';\n    }\n    if (this.props.notice.type) {\n      var type = this.props.notice.type;\n      if (type === 'error') type = 'danger';\n      classes += ' alert-' + type;\n    } else {\n      classes += ' alert-info';\n    }\n\n    var icon;\n    if (this.props.notice.icon) {\n      icon = <span className={\"icon glyphicon glyphicon-\" + this.props.notice.icon}></span>\n    }\n\n    var closeBtn;\n    if (this.props.closable) {\n      closeBtn = <button className=\"close\" onClick={this.close}>&times;</button>;\n    }\n\n    return (\n      <div className={classes} key=\"notice\" ref=\"notice\">\n        {closeBtn}\n        <p>{icon} <strong>{this.props.notice.text || ''}</strong></p>\n      </div>\n    );\n  }\n\n});\n\nexport default NoticeComponent;\n","import _ from 'lodash';\n\nconst ChartTypeUtils = {\n  getQueryDataType: function(query){\n    var isInterval = typeof query.interval === \"string\";\n    var isGroupBy = typeof query.group_by === \"string\" || (query.group_by instanceof Array && query.group_by.length === 1);\n    var is2xGroupBy = query.group_by instanceof Array && query.group_by.length === 2;\n    var dataType;\n\n    if (query.analysis_type === \"funnel\") {\n      dataType = 'cat-ordinal';\n    }\n    else if (query.analysis_type === \"extraction\") {\n      dataType = 'extraction';\n    }\n    else if (query.analysis_type === \"select_unique\") {\n      dataType = 'nominal';\n    }\n\n    // metric\n    else if (!isGroupBy && !isInterval && !is2xGroupBy) {\n      dataType = 'singular';\n    }\n\n    // group_by, no interval\n    else if (isGroupBy && !isInterval) {\n      dataType = 'categorical';\n    }\n\n    // interval, no group_by\n    else if (isInterval && (!isGroupBy && !is2xGroupBy)) {\n      dataType = 'chronological';\n    }\n\n    // interval, group_by\n    else if (isInterval && (isGroupBy || is2xGroupBy)) {\n      dataType = 'cat-chronological';\n    }\n\n    // 2x group_by\n    // TODO: research possible dataType options\n    else if (!isInterval && is2xGroupBy) {\n      dataType = 'categorical';\n    }\n\n    return dataType;\n  },\n\n  getChartTypeOptions: function(query) {\n    var dataTypes = {\n      'singular':           ['metric'],\n      'categorical':        ['piechart', 'barchart', 'columnchart', 'table'],\n      'cat-interval':       ['columnchart', 'barchart', 'table'],\n      'cat-ordinal':        ['barchart', 'columnchart', 'areachart', 'linechart', 'table'],\n      'chronological':      ['areachart', 'linechart', 'table'],\n      'cat-chronological':  ['linechart', 'columnchart', 'barchart', 'areachart', 'table'],\n      'nominal':            ['table'],\n      'extraction':         ['table']\n    };\n    var queryDataType = ChartTypeUtils.getQueryDataType(query);\n    return dataTypes[queryDataType].concat(['JSON']);\n  },\n\n  responseSupportsChartType: function(query, chartType) {\n    return _.includes(ChartTypeUtils.getChartTypeOptions(query), chartType);\n  },\n\n  isTableChartType: function(chartType) {\n    return chartType == 'table';\n  }\n}\n\nexport default ChartTypeUtils;\n","import _ from 'lodash';\nimport ExplorerUtils from '../utils/ExplorerUtils';\nimport SharedValidators from './SharedValidators';\nimport StepValidations from './StepValidations';\nimport RunValidations from '../utils/RunValidations';\n\nfunction isNotFunnel(model) {\n  return model.query.analysis_type !== 'funnel';\n}\n\nexport default {\n\n  analysis_type: {\n\n    msg: 'Choose an Analysis Type.',\n\n    validate: function(model) {\n      return (typeof model.query.analysis_type ==='string' && model.query.analysis_type.length > 0);\n    }\n\n  },\n\n  event_collection: {\n\n    msg: 'Choose an Event Collection.',\n\n    shouldRun: isNotFunnel,\n\n    validate: function(model) {\n      return (typeof model.query.event_collection ==='string' && model.query.event_collection.length > 0);\n    }\n\n  },\n\n  target_property: {\n\n    msg: 'Choose a Target Property.',\n\n    shouldRun: function(model) {\n      return ExplorerUtils.shouldHaveTarget(model);\n    },\n\n    validate: function(model) {\n      return (typeof model.query.target_property ==='string' && model.query.target_property.length > 0);\n    }\n\n  },\n\n  percentile_value: {\n\n    msg: 'Choose a Percentile Value.',\n\n    shouldRun: function(model) {\n      return model.query.analysis_type === 'percentile';\n    },\n\n    validate: function(model) {\n      return model.query.percentile !== null && model.query.percentile !== '' && typeof model.query.percentile === 'number';\n    }\n\n  },\n\n  filters: {\n\n    shouldRun: isNotFunnel,\n\n    msg: 'One of your filters is invalid.',\n\n    validate: function(model) {\n      return SharedValidators.filters(model.query.filters);\n    }\n\n  },\n\n  steps: {\n\n    msg: 'One of your funnel steps is invalid.',\n\n    shouldRun: function(model) {\n      return model.query.analysis_type === 'funnel';\n    },\n\n    validate: function(model) {\n      if (!model.query.steps) return false;\n      var isValid = true;\n      for (var i=0; i<model.query.steps.length; i++) {\n        RunValidations.run(StepValidations, model.query.steps[i]);\n        if (!model.query.steps[i].isValid) isValid = false;\n      }\n      return isValid;\n    },\n\n  },\n\n  time: {\n\n    shouldRun: isNotFunnel,\n\n    validate: function(model) {\n      return SharedValidators.time(model.query.time);\n    }\n\n  },\n\n  query_name: {\n\n    msg: 'You must give your saved query a name.',\n\n    shouldRun: function(model) {\n      return model.saving;\n    },\n\n    validate: function(model) {\n      var name = model.query_name;\n      return (name !== null && name !== undefined && typeof name === \"string\" && name.length > 0);\n    }\n\n  },\n\n  refresh_rate: {\n\n    msg: 'Refresh rate must be between 4 and 24 hours.',\n\n    validate: function(model) {\n      var rate = model.refresh_rate;\n      return (typeof rate !== 'number' || (rate >= 1440 && rate <= 86400) || rate == 0);\n    }\n\n  },\n\n  email: {\n\n    msg: 'A valid email address is required.',\n\n    shouldRun: ExplorerUtils.isEmailExtraction,\n\n    validate: function(model) {\n      return new RegExp(/.+@.+\\..+/i).test(model.query.email);\n    }\n\n  },\n\n  latest: {\n\n    msg: 'Latest must be a number.',\n\n    shouldRun: ExplorerUtils.isEmailExtraction,\n\n    validate: function(model) {\n      var value = model.query.latest;\n      if (!value) return true;\n      var n = ~~Number(value);\n      return String(n) === value && n >= 0;\n    }\n\n  }\n\n};\n","/*!\n * pickadate.js v3.5.4, 2014/09/11\n * By Amsul, http://amsul.ca\n * Hosted on http://amsul.github.io/pickadate.js\n * Licensed under MIT\n */\n\n(function ( factory ) {\n\n    // AMD.\n    if ( typeof define == 'function' && define.amd )\n        define( 'picker', ['jquery'], factory )\n\n    // Node.js/browserify.\n    else if ( typeof exports == 'object' )\n        module.exports = factory( require('jquery') )\n\n    // Browser globals.\n    else this.Picker = factory( jQuery )\n\n}(function( $ ) {\n\nvar $window = $( window )\nvar $document = $( document )\nvar $html = $( document.documentElement )\n\n\n/**\n * The picker constructor that creates a blank picker.\n */\nfunction PickerConstructor( ELEMENT, NAME, COMPONENT, OPTIONS ) {\n\n    // If theres no element, return the picker constructor.\n    if ( !ELEMENT ) return PickerConstructor\n\n\n    var\n        IS_DEFAULT_THEME = false,\n\n\n        // The state of the picker.\n        STATE = {\n            id: ELEMENT.id || 'P' + Math.abs( ~~(Math.random() * new Date()) )\n        },\n\n\n        // Merge the defaults and options passed.\n        SETTINGS = COMPONENT ? $.extend( true, {}, COMPONENT.defaults, OPTIONS ) : OPTIONS || {},\n\n\n        // Merge the default classes with the settings classes.\n        CLASSES = $.extend( {}, PickerConstructor.klasses(), SETTINGS.klass ),\n\n\n        // The element node wrapper into a jQuery object.\n        $ELEMENT = $( ELEMENT ),\n\n\n        // Pseudo picker constructor.\n        PickerInstance = function() {\n            return this.start()\n        },\n\n\n        // The picker prototype.\n        P = PickerInstance.prototype = {\n\n            constructor: PickerInstance,\n\n            $node: $ELEMENT,\n\n\n            /**\n             * Initialize everything\n             */\n            start: function() {\n\n                // If its already started, do nothing.\n                if ( STATE && STATE.start ) return P\n\n\n                // Update the picker states.\n                STATE.methods = {}\n                STATE.start = true\n                STATE.open = false\n                STATE.type = ELEMENT.type\n\n\n                // Confirm focus state, convert into text input to remove UA stylings,\n                // and set as readonly to prevent keyboard popup.\n                ELEMENT.autofocus = ELEMENT == document.activeElement\n                ELEMENT.readOnly = !SETTINGS.editable\n                ELEMENT.id = ELEMENT.id || STATE.id\n                if ( ELEMENT.type != 'text' ) {\n                    ELEMENT.type = 'text'\n                }\n\n\n                // Create a new picker component with the settings.\n                P.component = new COMPONENT(P, SETTINGS)\n\n\n                // Create the picker root with a holder and then prepare it.\n                P.$root = $( PickerConstructor._.node('div', createWrappedComponent(), CLASSES.picker, 'id=\"' + ELEMENT.id + '_root\"') )\n                prepareElementRoot()\n\n\n                // If theres a format for the hidden input element, create the element.\n                if ( SETTINGS.formatSubmit ) {\n                    prepareElementHidden()\n                }\n\n\n                // Prepare the input element.\n                prepareElement()\n\n\n                // Insert the root as specified in the settings.\n                if ( SETTINGS.container ) $( SETTINGS.container ).append( P.$root )\n                else $ELEMENT.after( P.$root )\n\n\n                // Bind the default component and settings events.\n                P.on({\n                    start: P.component.onStart,\n                    render: P.component.onRender,\n                    stop: P.component.onStop,\n                    open: P.component.onOpen,\n                    close: P.component.onClose,\n                    set: P.component.onSet\n                }).on({\n                    start: SETTINGS.onStart,\n                    render: SETTINGS.onRender,\n                    stop: SETTINGS.onStop,\n                    open: SETTINGS.onOpen,\n                    close: SETTINGS.onClose,\n                    set: SETTINGS.onSet\n                })\n\n\n                // Once were all set, check the theme in use.\n                IS_DEFAULT_THEME = isUsingDefaultTheme( P.$root.children()[ 0 ] )\n\n\n                // If the element has autofocus, open the picker.\n                if ( ELEMENT.autofocus ) {\n                    P.open()\n                }\n\n\n                // Trigger queued the start and render events.\n                return P.trigger( 'start' ).trigger( 'render' )\n            }, //start\n\n\n            /**\n             * Render a new picker\n             */\n            render: function( entireComponent ) {\n\n                // Insert a new component holder in the root or box.\n                if ( entireComponent ) P.$root.html( createWrappedComponent() )\n                else P.$root.find( '.' + CLASSES.box ).html( P.component.nodes( STATE.open ) )\n\n                // Trigger the queued render events.\n                return P.trigger( 'render' )\n            }, //render\n\n\n            /**\n             * Destroy everything\n             */\n            stop: function() {\n\n                // If its already stopped, do nothing.\n                if ( !STATE.start ) return P\n\n                // Then close the picker.\n                P.close()\n\n                // Remove the hidden field.\n                if ( P._hidden ) {\n                    P._hidden.parentNode.removeChild( P._hidden )\n                }\n\n                // Remove the root.\n                P.$root.remove()\n\n                // Remove the input class, remove the stored data, and unbind\n                // the events (after a tick for IE - see `P.close`).\n                $ELEMENT.removeClass( CLASSES.input ).removeData( NAME )\n                setTimeout( function() {\n                    $ELEMENT.off( '.' + STATE.id )\n                }, 0)\n\n                // Restore the element state\n                ELEMENT.type = STATE.type\n                ELEMENT.readOnly = false\n\n                // Trigger the queued stop events.\n                P.trigger( 'stop' )\n\n                // Reset the picker states.\n                STATE.methods = {}\n                STATE.start = false\n\n                return P\n            }, //stop\n\n\n            /**\n             * Open up the picker\n             */\n            open: function( dontGiveFocus ) {\n\n                // If its already open, do nothing.\n                if ( STATE.open ) return P\n\n                // Add the active class.\n                $ELEMENT.addClass( CLASSES.active )\n                aria( ELEMENT, 'expanded', true )\n\n                // * A Firefox bug, when `html` has `overflow:hidden`, results in\n                //   killing transitions :(. So add the opened state on the next tick.\n                //   Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=625289\n                setTimeout( function() {\n\n                    // Add the opened class to the picker root.\n                    P.$root.addClass( CLASSES.opened )\n                    aria( P.$root[0], 'hidden', false )\n\n                }, 0 )\n\n                // If we have to give focus, bind the element and doc events.\n                if ( dontGiveFocus !== false ) {\n\n                    // Set it as open.\n                    STATE.open = true\n\n                    // Prevent the page from scrolling.\n                    if ( IS_DEFAULT_THEME ) {\n                        $html.\n                            css( 'overflow', 'hidden' ).\n                            css( 'padding-right', '+=' + getScrollbarWidth() )\n                    }\n\n                    // Pass focus to the elements jQuery object.\n                    $ELEMENT.trigger( 'focus' )\n\n                    // Bind the document events.\n                    $document.on( 'click.' + STATE.id + ' focusin.' + STATE.id, function( event ) {\n\n                        var target = event.target\n\n                        // If the target of the event is not the element, close the picker picker.\n                        // * Dont worry about clicks or focusins on the root because those dont bubble up.\n                        //   Also, for Firefox, a click on an `option` element bubbles up directly\n                        //   to the doc. So make sure the target wasn't the doc.\n                        // * In Firefox stopPropagation() doesnt prevent right-click events from bubbling,\n                        //   which causes the picker to unexpectedly close when right-clicking it. So make\n                        //   sure the event wasnt a right-click.\n                        if ( target != ELEMENT && target != document && event.which != 3 ) {\n\n                            // If the target was the holder that covers the screen,\n                            // keep the element focused to maintain tabindex.\n                            P.close( target === P.$root.children()[0] )\n                        }\n\n                    }).on( 'keydown.' + STATE.id, function( event ) {\n\n                        var\n                            // Get the keycode.\n                            keycode = event.keyCode,\n\n                            // Translate that to a selection change.\n                            keycodeToMove = P.component.key[ keycode ],\n\n                            // Grab the target.\n                            target = event.target\n\n\n                        // On escape, close the picker and give focus.\n                        if ( keycode == 27 ) {\n                            P.close( true )\n                        }\n\n\n                        // Check if there is a key movement or enter keypress on the element.\n                        else if ( target == ELEMENT && ( keycodeToMove || keycode == 13 ) ) {\n\n                            // Prevent the default action to stop page movement.\n                            event.preventDefault()\n\n                            // Trigger the key movement action.\n                            if ( keycodeToMove ) {\n                                PickerConstructor._.trigger( P.component.key.go, P, [ PickerConstructor._.trigger( keycodeToMove ) ] )\n                            }\n\n                            // On enter, if the highlighted item isnt disabled, set the value and close.\n                            else if ( !P.$root.find( '.' + CLASSES.highlighted ).hasClass( CLASSES.disabled ) ) {\n                                P.set( 'select', P.component.item.highlight ).close()\n                            }\n                        }\n\n\n                        // If the target is within the root and enter is pressed,\n                        // prevent the default action and trigger a click on the target instead.\n                        else if ( $.contains( P.$root[0], target ) && keycode == 13 ) {\n                            event.preventDefault()\n                            target.click()\n                        }\n                    })\n                }\n\n                // Trigger the queued open events.\n                return P.trigger( 'open' )\n            }, //open\n\n\n            /**\n             * Close the picker\n             */\n            close: function( giveFocus ) {\n\n                // If we need to give focus, do it before changing states.\n                if ( giveFocus ) {\n                    // ....ah yes! It wouldve been incomplete without a crazy workaround for IE :|\n                    // The focus is triggered *after* the close has completed - causing it\n                    // to open again. So unbind and rebind the event at the next tick.\n                    $ELEMENT.off( 'focus.' + STATE.id ).trigger( 'focus' )\n                    setTimeout( function() {\n                        $ELEMENT.on( 'focus.' + STATE.id, focusToOpen )\n                    }, 0 )\n                }\n\n                // Remove the active class.\n                $ELEMENT.removeClass( CLASSES.active )\n                aria( ELEMENT, 'expanded', false )\n\n                // * A Firefox bug, when `html` has `overflow:hidden`, results in\n                //   killing transitions :(. So remove the opened state on the next tick.\n                //   Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=625289\n                setTimeout( function() {\n\n                    // Remove the opened and focused class from the picker root.\n                    P.$root.removeClass( CLASSES.opened + ' ' + CLASSES.focused )\n                    aria( P.$root[0], 'hidden', true )\n\n                }, 0 )\n\n                // If its already closed, do nothing more.\n                if ( !STATE.open ) return P\n\n                // Set it as closed.\n                STATE.open = false\n\n                // Allow the page to scroll.\n                if ( IS_DEFAULT_THEME ) {\n                    $html.\n                        css( 'overflow', '' ).\n                        css( 'padding-right', '-=' + getScrollbarWidth() )\n                }\n\n                // Unbind the document events.\n                $document.off( '.' + STATE.id )\n\n                // Trigger the queued close events.\n                return P.trigger( 'close' )\n            }, //close\n\n\n            /**\n             * Clear the values\n             */\n            clear: function( options ) {\n                return P.set( 'clear', null, options )\n            }, //clear\n\n\n            /**\n             * Set something\n             */\n            set: function( thing, value, options ) {\n\n                var thingItem, thingValue,\n                    thingIsObject = $.isPlainObject( thing ),\n                    thingObject = thingIsObject ? thing : {}\n\n                // Make sure we have usable options.\n                options = thingIsObject && $.isPlainObject( value ) ? value : options || {}\n\n                if ( thing ) {\n\n                    // If the thing isnt an object, make it one.\n                    if ( !thingIsObject ) {\n                        thingObject[ thing ] = value\n                    }\n\n                    // Go through the things of items to set.\n                    for ( thingItem in thingObject ) {\n\n                        // Grab the value of the thing.\n                        thingValue = thingObject[ thingItem ]\n\n                        // First, if the item exists and theres a value, set it.\n                        if ( thingItem in P.component.item ) {\n                            if ( thingValue === undefined ) thingValue = null\n                            P.component.set( thingItem, thingValue, options )\n                        }\n\n                        // Then, check to update the element value and broadcast a change.\n                        if ( thingItem == 'select' || thingItem == 'clear' ) {\n                            $ELEMENT.\n                                val( thingItem == 'clear' ? '' : P.get( thingItem, SETTINGS.format ) ).\n                                trigger( 'change' )\n                        }\n                    }\n\n                    // Render a new picker.\n                    P.render()\n                }\n\n                // When the method isnt muted, trigger queued set events and pass the `thingObject`.\n                return options.muted ? P : P.trigger( 'set', thingObject )\n            }, //set\n\n\n            /**\n             * Get something\n             */\n            get: function( thing, format ) {\n\n                // Make sure theres something to get.\n                thing = thing || 'value'\n\n                // If a picker state exists, return that.\n                if ( STATE[ thing ] != null ) {\n                    return STATE[ thing ]\n                }\n\n                // Return the value, if that.\n                if ( thing == 'value' ) {\n                    return ELEMENT.value\n                }\n\n                // Check if a component item exists, return that.\n                if ( thing in P.component.item ) {\n                    if ( typeof format == 'string' ) {\n                        var thingValue = P.component.get( thing )\n                        return thingValue ?\n                            PickerConstructor._.trigger(\n                                P.component.formats.toString,\n                                P.component,\n                                [ format, thingValue ]\n                            ) : ''\n                    }\n                    return P.component.get( thing )\n                }\n            }, //get\n\n\n\n            /**\n             * Bind events on the things.\n             */\n            on: function( thing, method, internal ) {\n\n                var thingName, thingMethod,\n                    thingIsObject = $.isPlainObject( thing ),\n                    thingObject = thingIsObject ? thing : {}\n\n                if ( thing ) {\n\n                    // If the thing isnt an object, make it one.\n                    if ( !thingIsObject ) {\n                        thingObject[ thing ] = method\n                    }\n\n                    // Go through the things to bind to.\n                    for ( thingName in thingObject ) {\n\n                        // Grab the method of the thing.\n                        thingMethod = thingObject[ thingName ]\n\n                        // If it was an internal binding, prefix it.\n                        if ( internal ) {\n                            thingName = '_' + thingName\n                        }\n\n                        // Make sure the thing methods collection exists.\n                        STATE.methods[ thingName ] = STATE.methods[ thingName ] || []\n\n                        // Add the method to the relative method collection.\n                        STATE.methods[ thingName ].push( thingMethod )\n                    }\n                }\n\n                return P\n            }, //on\n\n\n\n            /**\n             * Unbind events on the things.\n             */\n            off: function() {\n                var i, thingName,\n                    names = arguments;\n                for ( i = 0, namesCount = names.length; i < namesCount; i += 1 ) {\n                    thingName = names[i]\n                    if ( thingName in STATE.methods ) {\n                        delete STATE.methods[thingName]\n                    }\n                }\n                return P\n            },\n\n\n            /**\n             * Fire off method events.\n             */\n            trigger: function( name, data ) {\n                var _trigger = function( name ) {\n                    var methodList = STATE.methods[ name ]\n                    if ( methodList ) {\n                        methodList.map( function( method ) {\n                            PickerConstructor._.trigger( method, P, [ data ] )\n                        })\n                    }\n                }\n                _trigger( '_' + name )\n                _trigger( name )\n                return P\n            } //trigger\n        } //PickerInstance.prototype\n\n\n    /**\n     * Wrap the picker holder components together.\n     */\n    function createWrappedComponent() {\n\n        // Create a picker wrapper holder\n        return PickerConstructor._.node( 'div',\n\n            // Create a picker wrapper node\n            PickerConstructor._.node( 'div',\n\n                // Create a picker frame\n                PickerConstructor._.node( 'div',\n\n                    // Create a picker box node\n                    PickerConstructor._.node( 'div',\n\n                        // Create the components nodes.\n                        P.component.nodes( STATE.open ),\n\n                        // The picker box class\n                        CLASSES.box\n                    ),\n\n                    // Picker wrap class\n                    CLASSES.wrap\n                ),\n\n                // Picker frame class\n                CLASSES.frame\n            ),\n\n            // Picker holder class\n            CLASSES.holder\n        ) //endreturn\n    } //createWrappedComponent\n\n\n\n    /**\n     * Prepare the input element with all bindings.\n     */\n    function prepareElement() {\n\n        $ELEMENT.\n\n            // Store the picker data by component name.\n            data(NAME, P).\n\n            // Add the input class name.\n            addClass(CLASSES.input).\n\n            // If theres a `data-value`, update the value of the element.\n            val( $ELEMENT.data('value') ?\n                P.get('select', SETTINGS.format) :\n                ELEMENT.value\n            ).\n\n            // On focus/click, open the picker and adjust the root focused state.\n            on('focus.' + STATE.id + ' click.' + STATE.id, focusToOpen)\n\n\n        // Only bind keydown events if the element isnt editable.\n        if ( !SETTINGS.editable ) {\n\n            // Handle keyboard event based on the picker being opened or not.\n            $ELEMENT.on('keydown.' + STATE.id, function(event) {\n\n                var keycode = event.keyCode,\n\n                    // Check if one of the delete keys was pressed.\n                    isKeycodeDelete = /^(8|46)$/.test(keycode)\n\n                // For some reason IE clears the input value on escape.\n                if ( keycode == 27 ) {\n                    P.close()\n                    return false\n                }\n\n                // Check if `space` or `delete` was pressed or the picker is closed with a key movement.\n                if ( keycode == 32 || isKeycodeDelete || !STATE.open && P.component.key[keycode] ) {\n\n                    // Prevent it from moving the page and bubbling to doc.\n                    event.preventDefault()\n                    event.stopPropagation()\n\n                    // If `delete` was pressed, clear the values and close the picker.\n                    // Otherwise open the picker.\n                    if ( isKeycodeDelete ) { P.clear().close() }\n                    else { P.open() }\n                }\n            })\n        }\n\n\n        // Update the aria attributes.\n        aria(ELEMENT, {\n            haspopup: true,\n            expanded: false,\n            readonly: false,\n            owns: ELEMENT.id + '_root' + (P._hidden ? ' ' + P._hidden.id : '')\n        })\n    }\n\n\n    /**\n     * Prepare the root picker element with all bindings.\n     */\n    function prepareElementRoot() {\n\n        P.$root.\n\n            on({\n\n                // When something within the root is focused, stop from bubbling\n                // to the doc and remove the focused state from the root.\n                focusin: function( event ) {\n                    P.$root.removeClass( CLASSES.focused )\n                    event.stopPropagation()\n                },\n\n                // When something within the root holder is clicked, stop it\n                // from bubbling to the doc.\n                'mousedown click': function( event ) {\n\n                    var target = event.target\n\n                    // Make sure the target isnt the root holder so it can bubble up.\n                    if ( target != P.$root.children()[ 0 ] ) {\n\n                        event.stopPropagation()\n\n                        // * For mousedown events, cancel the default action in order to\n                        //   prevent cases where focus is shifted onto external elements\n                        //   when using things like jQuery mobile or MagnificPopup (ref: #249 & #120).\n                        //   Also, for Firefox, dont prevent action on the `option` element.\n                        if ( event.type == 'mousedown' && !$( target ).is( ':input' ) && target.nodeName != 'OPTION' ) {\n\n                            event.preventDefault()\n\n                            // Re-focus onto the element so that users can click away\n                            // from elements focused within the picker.\n                            ELEMENT.focus()\n                        }\n                    }\n                }\n            }).\n\n            // If theres a click on an actionable element, carry out the actions.\n            on( 'click', '[data-pick], [data-nav], [data-clear], [data-close]', function() {\n\n                var $target = $( this ),\n                    targetData = $target.data(),\n                    targetDisabled = $target.hasClass( CLASSES.navDisabled ) || $target.hasClass( CLASSES.disabled ),\n\n                    // * For IE, non-focusable elements can be active elements as well\n                    //   (http://stackoverflow.com/a/2684561).\n                    activeElement = document.activeElement\n                    activeElement = activeElement && ( activeElement.type || activeElement.href ) && activeElement\n\n                // If its disabled or nothing inside is actively focused, re-focus the element.\n                if ( targetDisabled || activeElement && !$.contains( P.$root[0], activeElement ) ) {\n                    ELEMENT.focus()\n                }\n\n                // If something is superficially changed, update the `highlight` based on the `nav`.\n                if ( !targetDisabled && targetData.nav ) {\n                    P.set( 'highlight', P.component.item.highlight, { nav: targetData.nav } )\n                }\n\n                // If something is picked, set `select` then close with focus.\n                else if ( !targetDisabled && 'pick' in targetData ) {\n                    P.set( 'select', targetData.pick ).close( true )\n                }\n\n                // If a clear button is pressed, empty the values and close with focus.\n                else if ( targetData.clear ) {\n                    P.clear().close( true )\n                }\n\n                else if ( targetData.close ) {\n                    P.close( true )\n                }\n\n            }) //P.$root\n\n        aria( P.$root[0], 'hidden', true )\n    }\n\n\n     /**\n      * Prepare the hidden input element along with all bindings.\n      */\n    function prepareElementHidden() {\n\n        var name\n\n        if ( SETTINGS.hiddenName === true ) {\n            name = ELEMENT.name\n            ELEMENT.name = ''\n        }\n        else {\n            name = [\n                typeof SETTINGS.hiddenPrefix == 'string' ? SETTINGS.hiddenPrefix : '',\n                typeof SETTINGS.hiddenSuffix == 'string' ? SETTINGS.hiddenSuffix : '_submit'\n            ]\n            name = name[0] + ELEMENT.name + name[1]\n        }\n\n        P._hidden = $(\n            '<input ' +\n            'type=hidden ' +\n\n            // Create the name using the original inputs with a prefix and suffix.\n            'name=\"' + name + '\"' +\n\n            // If the element has a value, set the hidden value as well.\n            (\n                $ELEMENT.data('value') || ELEMENT.value ?\n                    ' value=\"' + P.get('select', SETTINGS.formatSubmit) + '\"' :\n                    ''\n            ) +\n            '>'\n        )[0]\n\n        $ELEMENT.\n\n            // If the value changes, update the hidden input with the correct format.\n            on('change.' + STATE.id, function() {\n                P._hidden.value = ELEMENT.value ?\n                    P.get('select', SETTINGS.formatSubmit) :\n                    ''\n            }).\n\n            // Insert the hidden input after the element.\n            after(P._hidden)\n    }\n\n\n    // Separated for IE\n    function focusToOpen( event ) {\n\n        // Stop the event from propagating to the doc.\n        event.stopPropagation()\n\n        // If its a focus event, add the focused class to the root.\n        if ( event.type == 'focus' ) {\n            P.$root.addClass( CLASSES.focused )\n        }\n\n        // And then finally open the picker.\n        P.open()\n    }\n\n\n    // Return a new picker instance.\n    return new PickerInstance()\n} //PickerConstructor\n\n\n\n/**\n * The default classes and prefix to use for the HTML classes.\n */\nPickerConstructor.klasses = function( prefix ) {\n    prefix = prefix || 'picker'\n    return {\n\n        picker: prefix,\n        opened: prefix + '--opened',\n        focused: prefix + '--focused',\n\n        input: prefix + '__input',\n        active: prefix + '__input--active',\n\n        holder: prefix + '__holder',\n\n        frame: prefix + '__frame',\n        wrap: prefix + '__wrap',\n\n        box: prefix + '__box'\n    }\n} //PickerConstructor.klasses\n\n\n\n/**\n * Check if the default theme is being used.\n */\nfunction isUsingDefaultTheme( element ) {\n\n    var theme,\n        prop = 'position'\n\n    // For IE.\n    if ( element.currentStyle ) {\n        theme = element.currentStyle[prop]\n    }\n\n    // For normal browsers.\n    else if ( window.getComputedStyle ) {\n        theme = getComputedStyle( element )[prop]\n    }\n\n    return theme == 'fixed'\n}\n\n\n\n/**\n * Get the width of the browsers scrollbar.\n * Taken from: https://github.com/VodkaBears/Remodal/blob/master/src/jquery.remodal.js\n */\nfunction getScrollbarWidth() {\n\n    if ( $html.height() <= $window.height() ) {\n        return 0\n    }\n\n    var $outer = $( '<div style=\"visibility:hidden;width:100px\" />' ).\n        appendTo( 'body' )\n\n    // Get the width without scrollbars.\n    var widthWithoutScroll = $outer[0].offsetWidth\n\n    // Force adding scrollbars.\n    $outer.css( 'overflow', 'scroll' )\n\n    // Add the inner div.\n    var $inner = $( '<div style=\"width:100%\" />' ).appendTo( $outer )\n\n    // Get the width with scrollbars.\n    var widthWithScroll = $inner[0].offsetWidth\n\n    // Remove the divs.\n    $outer.remove()\n\n    // Return the difference between the widths.\n    return widthWithoutScroll - widthWithScroll\n}\n\n\n\n/**\n * PickerConstructor helper methods.\n */\nPickerConstructor._ = {\n\n    /**\n     * Create a group of nodes. Expects:\n     * `\n        {\n            min:    {Integer},\n            max:    {Integer},\n            i:      {Integer},\n            node:   {String},\n            item:   {Function}\n        }\n     * `\n     */\n    group: function( groupObject ) {\n\n        var\n            // Scope for the looped object\n            loopObjectScope,\n\n            // Create the nodes list\n            nodesList = '',\n\n            // The counter starts from the `min`\n            counter = PickerConstructor._.trigger( groupObject.min, groupObject )\n\n\n        // Loop from the `min` to `max`, incrementing by `i`\n        for ( ; counter <= PickerConstructor._.trigger( groupObject.max, groupObject, [ counter ] ); counter += groupObject.i ) {\n\n            // Trigger the `item` function within scope of the object\n            loopObjectScope = PickerConstructor._.trigger( groupObject.item, groupObject, [ counter ] )\n\n            // Splice the subgroup and create nodes out of the sub nodes\n            nodesList += PickerConstructor._.node(\n                groupObject.node,\n                loopObjectScope[ 0 ],   // the node\n                loopObjectScope[ 1 ],   // the classes\n                loopObjectScope[ 2 ]    // the attributes\n            )\n        }\n\n        // Return the list of nodes\n        return nodesList\n    }, //group\n\n\n    /**\n     * Create a dom node string\n     */\n    node: function( wrapper, item, klass, attribute ) {\n\n        // If the item is false-y, just return an empty string\n        if ( !item ) return ''\n\n        // If the item is an array, do a join\n        item = $.isArray( item ) ? item.join( '' ) : item\n\n        // Check for the class\n        klass = klass ? ' class=\"' + klass + '\"' : ''\n\n        // Check for any attributes\n        attribute = attribute ? ' ' + attribute : ''\n\n        // Return the wrapped item\n        return '<' + wrapper + klass + attribute + '>' + item + '</' + wrapper + '>'\n    }, //node\n\n\n    /**\n     * Lead numbers below 10 with a zero.\n     */\n    lead: function( number ) {\n        return ( number < 10 ? '0': '' ) + number\n    },\n\n\n    /**\n     * Trigger a function otherwise return the value.\n     */\n    trigger: function( callback, scope, args ) {\n        return typeof callback == 'function' ? callback.apply( scope, args || [] ) : callback\n    },\n\n\n    /**\n     * If the second character is a digit, length is 2 otherwise 1.\n     */\n    digits: function( string ) {\n        return ( /\\d/ ).test( string[ 1 ] ) ? 2 : 1\n    },\n\n\n    /**\n     * Tell if something is a date object.\n     */\n    isDate: function( value ) {\n        return {}.toString.call( value ).indexOf( 'Date' ) > -1 && this.isInteger( value.getUTCDate() )\n    },\n\n\n    /**\n     * Tell if something is an integer.\n     */\n    isInteger: function( value ) {\n        return {}.toString.call( value ).indexOf( 'Number' ) > -1 && value % 1 === 0\n    },\n\n\n    /**\n     * Create ARIA attribute strings.\n     */\n    ariaAttr: ariaAttr\n} //PickerConstructor._\n\n\n\n/**\n * Extend the picker with a component and defaults.\n */\nPickerConstructor.extend = function( name, Component ) {\n\n    // Extend jQuery.\n    $.fn[ name ] = function( options, action ) {\n\n        // Grab the component data.\n        var componentData = this.data( name )\n\n        // If the picker is requested, return the data object.\n        if ( options == 'picker' ) {\n            return componentData\n        }\n\n        // If the component data exists and `options` is a string, carry out the action.\n        if ( componentData && typeof options == 'string' ) {\n            return PickerConstructor._.trigger( componentData[ options ], componentData, [ action ] )\n        }\n\n        // Otherwise go through each matched element and if the component\n        // doesnt exist, create a new picker using `this` element\n        // and merging the defaults and options with a deep copy.\n        return this.each( function() {\n            var $this = $( this )\n            if ( !$this.data( name ) ) {\n                new PickerConstructor( this, name, Component, options )\n            }\n        })\n    }\n\n    // Set the defaults.\n    $.fn[ name ].defaults = Component.defaults\n} //PickerConstructor.extend\n\n\n\nfunction aria(element, attribute, value) {\n    if ( $.isPlainObject(attribute) ) {\n        for ( var key in attribute ) {\n            ariaSet(element, key, attribute[key])\n        }\n    }\n    else {\n        ariaSet(element, attribute, value)\n    }\n}\nfunction ariaSet(element, attribute, value) {\n    element.setAttribute(\n        (attribute == 'role' ? '' : 'aria-') + attribute,\n        value\n    )\n}\nfunction ariaAttr(attribute, data) {\n    if ( !$.isPlainObject(attribute) ) {\n        attribute = { attribute: data }\n    }\n    data = ''\n    for ( var key in attribute ) {\n        var attr = (key == 'role' ? '' : 'aria-') + key,\n            attrVal = attribute[key]\n        data += attrVal == null ? '' : attr + '=\"' + attribute[key] + '\"'\n    }\n    return data\n}\n\n\n\n// Expose the picker constructor.\nreturn PickerConstructor\n\n\n}));\n","module.exports = __WEBPACK_EXTERNAL_MODULE__30__;","module.exports = __WEBPACK_EXTERNAL_MODULE__31__;","module.exports = __WEBPACK_EXTERNAL_MODULE__32__;","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  PROJECT_CREATE: null,\n  PROJECT_UPDATE: null,\n  PROJECT_UPDATE_EVENT_COLLECTION: null\n});\n","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport AppStateConstants from '../constants/AppStateConstants';\n\nconst CHANGE_EVENT = 'change';\n\nfunction defaultState() {\n  return {\n    fetchingPersistedExplorers: false,\n    codeSampleHidden: true,\n    ready: false,\n    isLimited: false\n  };\n}\n\nvar _appState = defaultState();\n\nfunction _update(updates) {\n  _appState = _.assign({}, _appState, updates);\n}\n\nfunction _reset() {\n  _appState = defaultState();\n}\n\nvar AppStateStore = _.assign({}, EventEmitter.prototype, {\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(this.dispatchToken);\n  },\n\n  getState: function() {\n    return _appState;\n  },\n\n  getLimit: function() {\n    return _appState.isLimited;\n  },\n\n  reset: function() {\n    _reset();\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n});\n\n// Register callback to handle all updates\nAppStateStore.dispatchToken = AppDispatcher.register(function(action) {\n  switch(action.actionType) {\n    case AppStateConstants.APP_STATE_UPDATE:\n      _update(action.updates);\n      AppStateStore.emitChange();\n      break;\n\n    case AppStateConstants.APP_STATE_RESET:\n      _reset();\n      AppStateStore.emitChange();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default AppStateStore;\n","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  APP_STATE_UPDATE: null,\n  APP_STATE_RESET: null\n});\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nconst Modal = React.createClass({\n\n  closeClick: function(event) {\n    event.preventDefault();\n    this.close();\n  },\n\n  backdropClick: function(event) {\n    if (!$(event.target).closest('.modal-dialog').length) {\n      this.close();\n    }\n  },\n\n  close: function(){\n    if (this.state.open) {\n      this.removeBackdrop();\n      this.setState({ open: false });\n      this.props.onClose();\n    }\n  },\n\n  open: function() {\n    if (!this.state.open) {\n      this.addBackdrop();\n      this.setState({ open: true });\n      this.props.onOpen();\n    }\n  },\n\n  setLoading: function(value) {\n    if (typeof value === \"boolean\") {\n      this.setState({ loading: value });\n    }\n  },\n\n  addBackdrop: function() {\n    $('body').addClass('modal-open');\n\n    var backdropEl = document.createElement('div');\n    backdropEl.id = 'modal-backdrop';\n    backdropEl.className = 'modal-backdrop in';\n    document.body.appendChild(backdropEl);\n  },\n\n  removeBackdrop: function(){\n    $('body').removeClass('modal-open');\n    $('.modal-backdrop').remove();\n  },\n\n  buildFooter: function() {\n    if (this.props.footerBtns.length) {\n      var footerBtns = _.map(this.props.footerBtns, _.bind(function(btnConfig, index){\n        var text = btnConfig.text;\n\n        var classes = 'btn';\n        if (btnConfig.classes) {\n          classes = classes + ' ' + btnConfig.classes;\n        } else {\n          classes = classes + ' btn-default';\n        }\n\n        var icon;\n        if (btnConfig.iconName) {\n          var iconClass = 'icon glyphicon glyphicon-' + btnConfig.iconName;\n          var icon = (<span className={iconClass}></span>);\n        }\n\n        return (\n          <button type=\"button\" ref={btnConfig.ref || ''} className={classes} onClick={btnConfig.onClick || this.close} key={index}>\n            {icon}\n            {text}\n          </button>\n        );\n      }, this));\n\n      return (\n        <div className=\"modal-footer\">\n          {footerBtns}\n        </div>\n      );\n    }\n  },\n\n  // Lifecycle hooks\n\n  getInitialState: function() {\n    return {\n      open: false,\n      loading: false\n    };\n  },\n\n  getDefaultProps: function() {\n    return {\n      size: 'small',\n      modalClasses: '',\n      footerBtns: [],\n      onOpen: function(){},\n      onClose: function(){}\n    };\n  },\n\n  componentDidMount: function() {\n    $(document).on('click', '.modal.block', _.bind(this.backdropClick, this));\n    $(document).on('keyup', _.bind(function(e) {\n      // Escapism?\n      if (e.keyCode === 27 && e.target.className.indexOf('react-select-input') < 0) {\n        this.close();\n      }\n    }, this));\n  },\n\n  componentWillUnmount: function() {\n    $(document).off('click', '.modal-backdrop');\n  },\n\n  render: function() {\n    var modalClasses = this.props.modalClasses + ' modal';\n    if (this.state.open) {\n      modalClasses += ' block';\n    }\n    var modalDialogClasses = classNames({\n      'modal-dialog': true,\n      'modal-lg': this.props.size === 'large'\n    });\n\n    var titleIcon;\n    if (this.props.titleIcon) {\n      var titleIconClasses = \"icon glyphicon glyphicon-\" + this.props.titleIcon;\n      if (!this.props.title) titleIconClasses += \" big no-margin\";\n      if (this.props.iconClasses) titleIconClasses = titleIconClasses + \" \" + this.props.iconClasses;\n      titleIcon = <span className={titleIconClasses}></span>\n    }\n\n    return (\n      <div className={modalClasses}>\n        <div className={modalDialogClasses}>\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <button type=\"button\" className=\"close\" onClick={this.closeClick}>\n                <span aria-hidden=\"true\">&times;</span>\n                <span className=\"sr-only\">Close</span>\n              </button>\n              <h3 className=\"modal-title\">\n                {titleIcon}\n                {this.props.title}\n              </h3>\n            </div>\n            <div className=\"modal-body\">\n              {this.props.children}\n            </div>\n            {this.buildFooter()}\n          </div>\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Modal;\n","import _ from 'lodash';\nimport RunValidations from '../utils/RunValidations';\nimport FilterValidations from '../validations/FilterValidations';\nimport TimeframeUtils from '../utils/TimeframeUtils';\nimport FilterUtils from '../utils/FilterUtils';\n\nexport default {\n\n  filters: function(filters) {\n    if (!filters || (_.isArray(filters) && !filters.length)) return true;\n    var isValid = true\n    for (var i=0; i<filters.length; i++) {\n      if (!FilterUtils.isComplete(filters[i])) continue;\n      RunValidations.run(FilterValidations, filters[i]);\n      if (!filters[i].isValid) isValid = false\n    }\n    return isValid;\n  },\n\n  time: function(time) {\n    var defaultError = \"You must provide a timeframe.\";\n\n    if (!time) return defaultError;\n    if (TimeframeUtils.timeframeType(time) === 'relative') {\n      if (time.relativity && time.amount && time.sub_timeframe) return true;\n      return \"You must choose all 3 options for relative timeframes.\";\n    }\n    if (TimeframeUtils.timeframeType(time) === 'absolute') {\n      if (time.start && time.end) return true;\n      return \"You must provide a start and end time for absolute timeframes.\";\n    }\n\n    return defaultError;\n  }\n\n};\n","import _ from 'lodash';\nimport FormatUtils from '../utils/FormatUtils';\nimport SharedValidators from './SharedValidators';\n\nexport default {\n\n  event_collection: {\n\n    msg: 'Choose an Event Collection.',\n\n    validate: function(model) {\n      return (typeof model.event_collection ==='string' && model.event_collection.length > 0);\n    }\n\n  },\n\n  actor_property: {\n\n    msg: 'You must select an actor property',\n\n    validate: function(model) {\n      return (typeof model.actor_property ==='string' && model.actor_property.length > 0);\n    },\n\n  },\n\n  time: {\n\n    validate: function(model) {\n      return SharedValidators.time(model.time);\n    }\n\n  },\n\n  filters: {\n\n    msg: 'One of your filters is invalid.',\n\n    validate: function(model) {\n      return SharedValidators.filters(model.filters);\n    }\n\n  },\n\n\n  optional: {\n\n    msg: 'You must select whether this step is optional.',\n\n    validate: function(model) {\n      if (FormatUtils.isNullOrUndefined(model.optional)) return false;\n      return typeof model.optional === 'boolean';\n    }\n\n  },\n\n  inverted: {\n\n    msg: 'You must select whether this step is inverted.',\n\n    validate: function(model) {\n      if (FormatUtils.isNullOrUndefined(model.inverted)) return false;\n      return typeof model.inverted === 'boolean';\n    }\n\n  },\n\n  with_actors: {\n\n    msg: '\"with_actors\" must be set to either true or false',\n\n    validate: function(model) {\n      if (FormatUtils.isNullOrUndefined(model.with_actors)) return false;\n      return typeof model.with_actors === 'boolean';\n    }\n\n  },\n\n};\n","import keyMirror from 'keymirror';\n\nexport default keyMirror({\n  NOTICE_CREATE: null,\n  NOTICE_CLEAR_ALL: null\n});\n","import AppStateActions from '../actions/AppStateActions';\nimport ProjectStore from '../stores/ProjectStore';\n\nexport default {\n  checkLimits: function() {\n    const client = ProjectStore.getProject().client;\n    const url = client.url('/3.0/projects/{projectId}/organization-usage',\n      { api_key: client.config.masterKey }\n    );\n    fetch(url)\n    .then((resp) => resp.json()) \n    .then(function(data) {\n      if(data){\n        const { cached_queries: { limited, limit, current_usage } } = data;\n        if(limited, current_usage >= limit){\n          AppStateActions.update({ isLimited: true })\n        } else {\n          AppStateActions.update({ isLimited: false })\n        }\n      } else {\n        throw new Error(\"Problem with fetching query limits\");\n      }\n    })\n  }\n}","import React from 'react';\nimport classNames from 'classnames';\nimport _ from 'lodash';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\n\nconst QueryActions = React.createClass({\n\n  runBtnStates: {\n    default: {\n      inactive: 'Run Query',\n      active: 'Running...'\n    },\n    immediateExtraction: {\n      inactive: 'Run Extraction',\n      active: 'Running...'\n    },\n    emailExtraction: {\n      inactive: 'Send Email Extraction',\n      active: 'Sending...'\n    }\n  },\n\n  runButtonText: function() {\n    var btnStates = this.runBtnStates.default;\n\n    if (ExplorerUtils.isEmailExtraction(this.props.model)) {\n      btnStates = this.runBtnStates.emailExtraction;\n    } else if (ExplorerUtils.isImmediateExtraction(this.props.model)) {\n      btnStates = this.runBtnStates.immediateExtraction;\n    }\n\n    return this.props.model.loading ? btnStates.active : btnStates.inactive;\n  },\n\n  render: function() {\n    var saveMsg,\n        saveBtn,\n        cloneBtn,\n        deleteBtn,\n        actionsSupported = true,\n        runButtonClasses = classNames({\n          'disabled': this.props.model.loading,\n          'btn btn-primary run-query': true\n        }),\n        codeSampleBtnClasses = classNames({\n          'btn btn-default code-sample-toggle pull-right': true,\n          'open': !this.props.codeSampleHidden\n        });\n\n    var isEmailExtraction = ExplorerUtils.isEmailExtraction(this.props.model);\n    var isPersisted = ExplorerUtils.isPersisted(this.props.model);\n    var isFunnel = this.props.model.query.analysis_type === 'funnel';\n\n    if (this.props.persistence) {\n      if (isEmailExtraction) {\n        actionsSupported = false;\n        saveMsg = (\n          <p className=\"no-margin margin-top-tiny\">\n            <small>The Keen IO API currently does not support saving email extraction.</small>\n          </p>\n        );\n      }\n      saveBtn = (\n        <button type=\"button\" className=\"btn btn-success save-query\" onClick={actionsSupported ? this.props.saveQueryClick : function(){}} role=\"save-query\" disabled={this.props.model.loading || !actionsSupported}>\n          {isPersisted ? 'Update' : 'Save'}\n        </button>\n      );\n      deleteBtn = (\n        <button type=\"button\" role=\"delete-query\" className=\"btn btn-link\" onClick={actionsSupported ? this.props.removeClick : function(){}} disabled={!actionsSupported}>\n          Delete\n        </button>\n      );\n      if (isPersisted) {\n        cloneBtn = (\n          <button type=\"button\" className=\"btn btn-default\" onClick={actionsSupported ? this.props.cloneQueryClick : function(){}} role=\"clone-query\" disabled={this.props.model.loading || !actionsSupported}>\n            Clone\n          </button>\n        );\n      }\n    }\n\n    return (\n      <div className=\"query-actions clearfix\">\n        <div className=\"row\">\n          <div className=\"col-md-10 clearfix\">\n            <div className=\"run-group pull-left\">\n              <button type=\"submit\" role=\"run-query\" className={runButtonClasses} id=\"run-query\" onClick={this.props.handleQuerySubmit}>\n                {this.runButtonText()}\n              </button>\n            </div>\n            <div className=\"manage-group pull-left\">\n              {saveBtn}\n              {cloneBtn}\n              {deleteBtn}\n            </div>\n          </div>\n          <div className=\"col-md-2\">\n            <button className={codeSampleBtnClasses} role=\"toggle-code-sample\" onClick={this.props.toggleCodeSample}>\n              <span>&lt;/&gt; Embed</span>\n            </button>\n          </div>\n        </div>\n        {saveMsg}\n      </div>\n    );\n  }\n\n});\n\nexport default QueryActions;\n","import React from 'react';\nimport _ from 'lodash';\n\n// Components\nimport ReactSelect from '../../common/react_select.js';\n\nconst SelectField = React.createClass({\n\n  getDefaultProps: function() {\n    return {\n      sort: false,\n      inputClasses: []\n    }\n  },\n\n  buildBrowseEventsLink: function() {\n    if (this.props.onBrowseEvents) {\n      return (\n        <button className=\"btn btn-link field-secondary-control\" title=\"Browse event collections\" type=\"button\" onClick={this.props.onBrowseEvents} id=\"browse-event-collections\">\n          <span className=\"icon glyphicon glyphicon-search\"></span> Preview collections\n        </button>\n      );\n    }\n  },\n\n  // React methods\n\n  render: function() {\n    var requiredNote = (this.props.requiredLabel) ? <small>(required)</small> : null;\n\n    return (\n      <div className=\"field-component\">\n        <label htmlFor={this.props.name}>{this.props.label} {requiredNote}</label>\n        <ReactSelect ref=\"select\"\n                     name={this.props.name}\n                     inputClasses={this.props.inputClasses.join(' ') + ' form-control'}\n                     items={this.props.options}\n                     handleChange={this.props.handleChange}\n                     value={this.props.value}\n                     sort={this.props.sort} />\n        {this.buildBrowseEventsLink()}\n      </div>\n    );\n  }\n\n});\n\nexport default SelectField;\n","import _ from 'lodash';\nimport moment from 'moment';\nimport React from 'react';\nimport AbsolutePicker from './absolute_picker.js';\nimport RelativePicker from './relative_picker.js';\nimport FieldsToggle from './fields_toggle.js';\nimport ReactSelect from './react_select.js';\nimport Timezone from './timezone.js';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport TimeframeUtils from '../../utils/TimeframeUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\n\nfunction relativeDefaults() {\n  return {\n    relativity: 'this',\n    amount: '14',\n    sub_timeframe: 'days'\n  };\n}\n\nfunction absoluteDefaults() {\n  return {\n    start: new Date(moment().subtract(1, 'days').startOf('day').format()),\n    end: new Date(moment().startOf('day').format())\n  };\n}\n\nvar Timeframe = React.createClass({\n\n  toggleTimeframeType: function(event) {\n    event.preventDefault();\n    var type = event.currentTarget.dataset.type;\n\n    this.props.handleChange('time', (type === 'absolute') ? absoluteDefaults() : relativeDefaults());\n  },\n\n  isAbsolute: function() {\n    return TimeframeUtils.timeframeType(this.props.time) === 'absolute';\n  },\n\n  isRelative: function() {\n    return TimeframeUtils.timeframeType(this.props.time) === 'relative';\n  },\n\n  // React Methods\n\n  render: function() {\n    var timezone = this.props.timezone || ProjectUtils.getConstant('DEFAULT_TIMEZONE');\n\n    if (this.isAbsolute()) {\n      var timeframePicker = <AbsolutePicker time={this.props.time}\n                            handleChange={this.props.handleChange} />;\n    } else {\n      var timeframePicker = <RelativePicker relativeIntervalTypes={ProjectUtils.getConstant('RELATIVE_INTERVAL_TYPES')}\n                                            time={this.props.time}\n                                            handleChange={this.props.handleChange} />;\n    }\n\n    return (\n      <div className=\"timeframe\">\n        <div className=\"field-component\">\n          <label>Timeframe</label>\n          <ul className=\"nav nav-pills\" role=\"tablist\">\n            <li className={this.isRelative() ? 'active' : ''}>\n              <a href=\"#\" className=\"relative-tab\" data-type=\"relative\" onClick={this.toggleTimeframeType}>Relative</a>\n            </li>\n            <li className={this.isAbsolute() ? 'active' : ''}>\n              <a href=\"#\" className=\"absolute-tab\" data-type=\"absolute\" onClick={this.toggleTimeframeType}>Absolute</a>\n            </li>\n          </ul>\n          {timeframePicker}\n          <Timezone timezone={this.props.timezone}\n                    timeframe_type={TimeframeUtils.timeframeType(this.props.time)}\n                    handleChange={this.props.handleChange} />\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Timeframe;\n","import _ from 'lodash';\nimport React from 'react';\nimport moment from 'moment';\n\nimport pickadate from '../../../vendor/picker.js';\nimport '../../../vendor/picker.date.js';\nimport '../../../vendor/picker.time.js';\n\nconst Datepicker = React.createClass({\n\n  handleOnBlur: function(event) {\n    this.destroyPicker();\n    var value = event.target.value;\n    var isValid = moment(new Date(value)).isValid();\n\n    if (isValid) {\n      this.props.onBlur(event);\n      this.setState({ errorMsg: false });\n    } else if (value && !isValid) {\n      this.setState({ errorMsg: 'Invalid' });\n    }\n  },\n\n  onFocus: function() {\n    var minimum = this.props.minimum;\n    $(this.refs[this.props.refValue]).pickadate({\n      format: 'mmm d, yyyy',\n      editable: true,\n      min: minimum,\n      onSet: _.bind(function(args) {\n        this.props.onSet(this.props.name, new Date(this.refs.datepicker.value));\n      }, this)\n    });\n  },\n\n  destroyPicker: function() {\n    var picker = $(this.refs[this.props.refValue]).pickadate('picker');\n    if (picker) picker.stop();\n  },\n\n  // React methods\n\n  getInitialState: function() {\n    return {\n      errorMsg: false\n    };\n  },\n\n  getDefaultProps: function () {\n    return {\n      refValue: 'datepicker',\n      label: false,\n      onChange: function(){},\n      placeholder: '',\n      classes: 'datepicker-wrapper form-group',\n      onSet: function(){}\n    };\n  },\n\n  render: function() {\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label}</label> : null;\n    var errorMsg = this.state.errorMsg ? <p>{this.state.errorMsg}</p> : '';\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <input type=\"text\"\n               ref={this.props.refValue}\n               name={this.props.name}\n               className=\"form-control\"\n               value={this.props.value}\n               onChange={this.props.onChange}\n               onBlur={this.handleOnBlur}\n               onFocus={this.onFocus}\n               placeholder={this.props.placeholder}\n               autoComplete=\"off\" />\n        {errorMsg}\n      </div>\n    );\n  }\n});\n\nexport default Datepicker;\n","import _ from 'lodash';\nimport React from 'react';\nimport ReactSelect from './react_select.js';\n\nconst premadeTimes = [\n  '12:00 AM',\n  '12:15 AM',\n  '12:30 AM',\n  '12:45 AM',\n  '01:00 AM',\n  '01:15 AM',\n  '01:30 AM',\n  '01:45 AM',\n  '02:00 AM',\n  '02:15 AM',\n  '02:30 AM',\n  '02:45 AM',\n  '03:00 AM',\n  '03:15 AM',\n  '03:30 AM',\n  '03:45 AM',\n  '04:00 AM',\n  '04:15 AM',\n  '04:30 AM',\n  '04:45 AM',\n  '05:00 AM',\n  '05:15 AM',\n  '05:30 AM',\n  '05:45 AM',\n  '06:00 AM',\n  '06:15 AM',\n  '06:30 AM',\n  '06:45 AM',\n  '07:00 AM',\n  '07:15 AM',\n  '07:30 AM',\n  '07:45 AM',\n  '08:00 AM',\n  '08:15 AM',\n  '08:30 AM',\n  '08:45 AM',\n  '09:00 AM',\n  '09:15 AM',\n  '09:30 AM',\n  '09:45 AM',\n  '10:00 AM',\n  '10:15 AM',\n  '10:30 AM',\n  '10:45 AM',\n  '11:00 AM',\n  '11:15 AM',\n  '11:30 AM',\n  '11:45 AM',\n  '12:00 PM',\n  '12:15 PM',\n  '12:30 PM',\n  '12:45 PM',\n  '01:00 PM',\n  '01:15 PM',\n  '01:30 PM',\n  '01:45 PM',\n  '02:00 PM',\n  '02:15 PM',\n  '02:30 PM',\n  '02:45 PM',\n  '03:00 PM',\n  '03:15 PM',\n  '03:30 PM',\n  '03:45 PM',\n  '04:00 PM',\n  '04:15 PM',\n  '04:30 PM',\n  '04:45 PM',\n  '05:00 PM',\n  '05:15 PM',\n  '05:30 PM',\n  '05:45 PM',\n  '06:00 PM',\n  '06:15 PM',\n  '06:30 PM',\n  '06:45 PM',\n  '07:00 PM',\n  '07:15 PM',\n  '07:30 PM',\n  '07:45 PM',\n  '08:00 PM',\n  '08:15 PM',\n  '08:30 PM',\n  '08:45 PM',\n  '09:00 PM',\n  '09:15 PM',\n  '09:30 PM',\n  '09:45 PM',\n  '10:00 PM',\n  '10:15 PM',\n  '10:30 PM',\n  '10:45 PM',\n  '11:00 PM',\n  '11:15 PM',\n  '11:30 PM',\n  '11:45 PM',\n];\n\nfunction parseTime(timeStr, dt) {\n  if (!dt) {\n    dt = new Date();\n  }\n\n  var time = timeStr.match(/(\\d+)(?::(\\d\\d))?\\s*(p?)/i);\n  if (!time) {\n    return NaN;\n  }\n  var hours = parseInt(time[1], 10);\n  if (hours == 12 && !time[3]) {\n    hours = 0;\n  }\n  else {\n    hours += (hours < 12 && time[3]) ? 12 : 0;\n  }\n\n  dt.setHours(hours);\n  dt.setMinutes(parseInt(time[2], 10) || 0);\n  dt.setSeconds(0, 0);\n  return dt;\n}\n\nvar Timepicker = React.createClass({\n\n  validateTime: function(value) {\n    var parsed = parseTime(value);\n    if (parsed instanceof Date) {\n      this.setState({ errorMsg: false });\n      return true;\n    } else {\n      this.setState({ errorMsg: 'Invalid time' });\n      return false;\n    }\n  },\n\n  handleBlur: function(event) {\n    if (this.validateTime(event.target.value)) {\n      this.props.handleBlur(event.target.name, parseTime(event.target.value).getTime());\n    }\n  },\n\n  handleSelection: function(name, selection) {\n    if (this.validateTime(selection)) {\n      this.props.handleSelection(name, parseTime(selection).getTime());\n    }\n  },\n\n  handleChange: function(name, value) {\n    this.setState({ value: value });\n    this.props.handleChange(name, value);\n  },\n\n  // React methods\n\n  getInitialState: function() {\n    return {\n      errorMsg: false,\n      value: this.props.value\n    };\n  },\n\n  getDefaultProps: function () {\n    return {\n      refValue: 'timepicker',\n      label: false,\n      handleBlur: function(){},\n      handleChange: function(){},\n      handleSelection: function(){},\n      placeholder: '',\n      classes: 'timepicker-wrapper form-group'\n    };\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    if (nextProps.value != this.state.value) {\n      this.setState({ value: nextProps.value });\n    }\n  },\n\n  render: function() {\n    var label = this.props.label ? <label htmlFor={this.props.name}>{this.props.label}</label> : null;\n    var errorMsg = this.state.errorMsg ? <p>{this.state.errorMsg}</p> : null;\n\n    return (\n      <div className={this.props.classes}>\n        {label}\n        <ReactSelect ref={this.props.refValue}\n                     name={this.props.name}\n                     inputClasses=\"form-control\"\n                     items={premadeTimes}\n                     handleBlur={this.handleBlur}\n                     handleChange={this.handleChange}\n                     handleSelection={this.handleSelection}\n                     value={this.state.value}\n                     title={this.props.name}\n                     sort={true} />\n        {errorMsg}\n      </div>\n    );\n  }\n});\n\nexport default Timepicker;\n","import _ from 'lodash';\nimport React from 'react';\nimport Filter from './filter.js';\nimport Modal from './modal.js';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport FilterUtils from '../../utils/FilterUtils';\n\nconst FilterManager = React.createClass({\n\n  propTypes: {\n    eventCollection:  React.PropTypes.string,\n    propertyNames:    React.PropTypes.array,\n    filters:          React.PropTypes.array,\n    addFilter:        React.PropTypes.func.isRequired,\n    removeFilter:     React.PropTypes.func.isRequired,\n    handleChange:     React.PropTypes.func.isRequired,\n    getPropertyType:  React.PropTypes.func.isRequired\n  },\n\n  open: function() {\n    this.refs.modal.open();\n  },\n\n  addFilter: function(e) {\n    e.preventDefault();\n    this.props.addFilter();\n  },\n\n  removeFilter: function(index) {\n    this.props.removeFilter(index);\n  },\n\n  handleChange: function(index, name, value) {\n    var updates = _.cloneDeep(this.props.filters[index]);\n\n    if (!_.isNull(name.match('coordinates'))) {\n      var coordinateIndex = parseInt(name.split('.')[1]);\n      updates.property_value.coordinates[coordinateIndex] = FilterUtils.coerceGeoValue(value);\n    } else if (name === 'max_distance_miles' && updates.coercion_type === 'Geo') {\n      updates.property_value[name] = FilterUtils.coerceGeoValue(value);\n    } else {\n      updates[name] = value;\n    }\n\n    this.props.handleChange(index, updates);\n  },\n\n  buildFilterNodes: function() {\n    var filterNodes = this.props.filters.map(function(filter, index) {\n      return(\n        <Filter key={index}\n                index={index}\n                filter={filter}\n                propertyType={this.props.getPropertyType(this.props.eventCollection, filter.property_name)}\n                eventCollection={this.props.eventCollection}\n                propertyNames={this.props.propertyNames}\n                handleChange={this.handleChange}\n                removeFilter={this.removeFilter}\n                filterOperators={ProjectUtils.getConstant('FILTER_OPERATORS')} />\n      );\n    }.bind(this));\n\n    return (\n      <div>\n        {filterNodes}\n        <div className=\"filter-buttons\">\n          <a href=\"#\" className=\"add-filter btn btn-primary\" onClick={this.addFilter}>\n            <i className=\"icon glyphicon glyphicon-plus margin-right-tiny\"></i>\n            Add another filter\n          </a>\n        </div>\n      </div>\n    )\n  },\n\n  noFiltersMarkup: function() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-10 col-md-offset-1\">\n          <div className=\"no-filters-msg callout\">\n            <p className=\"lead\">\n              <i className=\"icon glyphicon glyphicon-info-sign margin-right-tiny\"></i>\n              Please select an Event Collection before making a filter.\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  },\n\n  render: function() {\n    var filterContent = this.props.eventCollection ? this.buildFilterNodes() : this.noFiltersMarkup();\n\n    return (\n      <Modal ref=\"modal\"\n             title=\"Filters\"\n             size=\"large\"\n             onClose={this.modalClosed}\n             modalClasses=\"filters-modal\"\n             footerBtns={[\n              {\n                text: 'Done',\n                classes: 'btn-success',\n                iconName: 'ok-circle'\n              }\n            ]}>\n        <div className=\"filters\">\n          {filterContent}\n        </div>\n      </Modal>\n    );\n  }\n});\n\nexport default FilterManager;\n","import Qs from 'qs';\nimport _ from 'lodash';\n\nexport default {\n\n  getSearchString: function() {\n    return window.location.search;\n  },\n\n  updateSearchString: function(queryStringData) {\n    var urlPath;\n    if (_.keys(queryStringData).length) {\n      urlPath = '?' + Qs.stringify(queryStringData);\n    } else {\n      urlPath = window.location.origin + window.location.pathname\n    }\n    window.history.pushState({ model: queryStringData }, \"\", urlPath);\n  },\n\n  getQueryAttributes: function() {\n    return Qs.parse(this.getSearchString().replace('?', ''), { depth: 7 });\n  }\n\n};\n","import _ from 'lodash';\nimport KeenAnalysis from 'keen-analysis';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Persistence from './modules/persistence/persistence.js';\nimport AppDispatcher from './dispatcher/AppDispatcher';\nimport AppComponent from './components/app.js';\nimport ProjectActions from './actions/ProjectActions';\nimport ExplorerActions from './actions/ExplorerActions';\nimport AppStateActions from './actions/AppStateActions';\nimport NoticeActions from './actions/NoticeActions';\nimport ExplorerUtils from './utils/ExplorerUtils';\nimport FormatUtils from './utils/FormatUtils';\nimport RunValidations from './utils/RunValidations';\nimport ExplorerValidations from './validations/ExplorerValidations';\nimport ExplorerStore from './stores/ExplorerStore';\nimport ProjectStore from './stores/ProjectStore';\nimport QueryStringUtils from './utils/QueryStringUtils';\n\nexport const KeenExplorer = function (el) {\n  var tempId = FormatUtils.generateTempId();\n  this.appDispatcher = AppDispatcher;\n  this.config = {\n    params: QueryStringUtils.getQueryAttributes(),\n    persistence: null\n  };\n  this.el(el);\n  if (!this.config.el) {\n    console.error(\"Can't find HTML tag\", el);\n  }\n  ExplorerActions.create(_.assign(ExplorerUtils.formatQueryParams(this.config.params) || {}, { 'id': tempId }));\n  ExplorerActions.setActive(tempId);\n  ExplorerActions.validate(tempId);\n}\n\nKeenExplorer.prototype.client = function(obj) {\n  if (!arguments.length) return this.config.client;\n  this.config.client = new KeenAnalysis(obj);\n  this.config.client.resources({\n    'events': '{protocol}://{host}/3.0/projects/{projectId}/events'\n  });\n  ProjectActions.create({ client: this.config.client });\n  ProjectActions.fetchProjectCollections(this.config.client);\n  return this;\n};\n\nKeenExplorer.prototype.el = function(target) {\n  if (!arguments.length) return this.config.el;\n  if (target.nodeName) {\n    this.config.el = target;\n  }\n  else if (document.querySelector) {\n    this.config.el = document.querySelector(target);\n  }\n  else {\n    this.config.el = undefined;\n  }\n  return this;\n};\n\nKeenExplorer.prototype.fetch = function(){\n  if (this.config.persistence) {\n    ExplorerActions.fetchAllPersisted(this.config.persistence, function(err) {\n      if (err) console.error('There was an error fetching the persisted explorers: ', err.stack);\n    });\n    // Is this a saved query we want to load?\n    if (this.config.params.saved_query) {\n      // Once the models come back from the server, mark the right one as active.\n      ExplorerActions.fetchPersisted(this.config.persistence, { id: this.config.params.saved_query },\n        this.doneFetchingSavedQuery.bind(this, this.config.params.saved_query));\n    } else {\n      AppStateActions.update({ ready: true });\n      // Run the query for this explorer if it's valid\n      var isEmailExtraction = ExplorerUtils.isEmailExtraction(ExplorerStore.getActive());\n      RunValidations.run(ExplorerValidations, ExplorerStore.getActive());\n      if (!isEmailExtraction && ExplorerStore.getActive().isValid) {\n        ExplorerActions.exec(this.config.client, ExplorerStore.getActive().id);\n      }\n    }\n  } else {\n    AppStateActions.update({ ready: true });\n  }\n  this.render();\n  return this;\n};\n\nKeenExplorer.prototype.persistence = function(bool) {\n  if (!arguments.length) return this.config.persistence;\n  if (typeof bool === 'boolean' && bool) {\n    if (!this.config.client || !this.config.client.masterKey()) {\n      console.error('The Persistence feature requires a client instance with a masterKey value');\n    }\n    this.config.persistence = new Persistence.KeenSavedQueries({\n      baseUrl: this.config.client.url('queries', 'saved'),\n      client: this.config.client\n    });\n    this.config.persistence.config.masterKey = this.config.client.masterKey();\n  }\n  return this;\n};\n\nKeenExplorer.prototype.doneFetchingSavedQuery = function(savedQueryName, err) {\n  if (!err) {\n    ExplorerActions.setActive(savedQueryName);\n    ExplorerActions.exec(this.config.client, savedQueryName);\n    AppStateActions.update({ ready: true });\n  } else {\n    if (err.status === 404) {\n      // We couldn't find that saved query.\n      NoticeActions.create({\n        text: 'The saved query '+savedQueryName+' could not be found.',\n        type: 'error',\n        icon: 'remove-sign'\n      });\n      var id = FormatUtils.generateTempId();\n      ExplorerActions.create({ id: id });\n      ExplorerActions.setActive(id);\n      AppStateActions.update({ ready: true });\n    } else {\n      console.error(\"There was a problem fetching a saved query: \", err.stack);\n    }\n  }\n};\n\nKeenExplorer.prototype.render = function() {\n  let Component = React.createFactory(AppComponent);\n  ReactDOM.render(Component({\n    persistence: this.config.persistence,\n    client: this.config.client\n  }), this.config.el);\n};\n\nKeenExplorer.Persistence = Persistence;\nexport default KeenExplorer;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__50__;","module.exports = __WEBPACK_EXTERNAL_MODULE__51__;","import KeenSavedQueries from './KeenSavedQueries.js';\n\nexport default {\n  KeenSavedQueries\n};\n","import _ from 'lodash';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\n\nfunction KeenSavedQueries(config) {\n  this.config = config;\n}\n\nKeenSavedQueries.prototype.create = function(model, callback) {\n  var body = _.omit(model, ['id']);\n  this.config.client\n    .put(this.config.client.url('queries', 'saved', model.query_name))\n    .auth(this.config.client.masterKey())\n    .send(body)\n    .then(function(res){\n      callback(null, res);\n    })\n    .catch(callback);\n};\n\nKeenSavedQueries.prototype.update = function(model, callback) {\n  var body = _.omit(model, ['id']);\n  this.config.client\n    .put(this.config.client.url('queries', 'saved', model.id))\n    .auth(this.config.client.masterKey())\n    .send(body)\n    .then(function(res){\n      callback(null, res);\n    })\n    .catch(callback);\n};\n\nKeenSavedQueries.prototype.destroy = function(model, callback) {\n  this.config.client\n    .del(this.config.client.url('queries', 'saved', model.id))\n    .auth(this.config.client.masterKey())\n    .send()\n    .then(function(res){\n      callback(null, res);\n    })\n    .catch(function(err){\n      if (err.status === 204) {\n        callback(null, undefined);\n      }\n      else {\n        callback(err, null);\n      }\n    });\n};\n\nKeenSavedQueries.prototype.get = function(model, callback) {\n  if (model) {\n    this.config.client\n      .get(this.config.client.url('queries', 'saved', model.id))\n      .auth(this.config.client.masterKey())\n      .send()\n      .then(function(res){\n        callback(null, res);\n      })\n      .catch(callback);\n  } else {\n    this.config.client\n      .get(this.config.client.url('queries', 'saved'))\n      .auth(this.config.client.masterKey())\n      .send()\n      .then(function(res){\n        callback(null, res);\n      })\n      .catch(callback);\n  }\n};\n\nexport default KeenSavedQueries;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__54__;","import _ from 'lodash';\nimport FormatUtils from './FormatUtils';\nimport FilterUtils from './FilterUtils';\nimport TimeframeUtils from './TimeframeUtils';\n\nconst STEP_PARAMS = [\n  'event_collection',\n  'actor_property',\n  'timeframe',\n  'interval',\n  'timezone',\n  'filters',\n  'optional',\n  'inverted',\n  'with_actors'\n];\nexport default {\n\n  stepJSON: function (step) {\n    var params = _.cloneDeep(step);\n\n    _.assign(params, TimeframeUtils.getTimeParameters(step.time, step.timezone));\n\n    if (params.filters) {\n      params.filters = _.map(params.filters, function(filter) {\n        return FilterUtils.queryJSON(filter, TimeframeUtils.getTimezoneOffset(params.timezone));\n      });\n\n      _.remove(params.filters, _.isEmpty);\n    }\n\n    // Remove empty, null, or unnecessary properties\n    _.each(params, function(value, key) {\n      if (!FormatUtils.isValidQueryValue(value) || !_.includes(STEP_PARAMS, key)) {\n        delete params[key];\n      }\n    });\n\n    return params;\n  },\n\n  formatQueryParams: function (step) {\n    if (step.timeframe) {\n      var unpackedTime = TimeframeUtils.unpackTimeframeParam(step.timeframe, step.timezone);\n      step.time = unpackedTime.time;\n      step.timezone = unpackedTime.timezone;\n    }\n\n    if (step.filters) {\n      step.filters = _.compact(_.map(step.filters, FilterUtils.formatFilterParams));\n    }\n\n    step.inverted = (step.inverted === true || step.inverted === \"true\");\n    step.optional = (step.optional === true || step.optional === \"true\");\n    step.with_actors = (step.with_actors === true || step.with_actors === \"true\");\n\n    return step;\n  }\n\n};\n","export default {\n  isDST: function() {\n    var date = new Date();\n    var jan = new Date(date.getFullYear(), 0, 1);\n    var jul = new Date(date.getFullYear(), 6, 1);\n    var stdOffset = Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());\n    return date.getTimezoneOffset() < stdOffset;\n  }\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__57__;","import React from 'react';\nimport Loader from './common/loader.js';\nimport ProjectStore from '../stores/ProjectStore';\nimport AppStateStore from '../stores/AppStateStore';\nimport Explorer from './explorer/index.js';\n\nfunction getProjectState() {\n  return {\n    project: ProjectStore.getProject(),\n    app: AppStateStore.getState()\n  };\n}\n\nconst App = React.createClass({\n\n\tcomponentDidMount: function() {\n    ProjectStore.addChangeListener(this._onChange);\n    AppStateStore.addChangeListener(this._onChange);\n\t},\n\n  componentWillUnmount: function() {\n    ProjectStore.removeChangeListener(this._onChange);\n    AppStateStore.addChangeListener(this._onChange);\n  },\n\n\tgetInitialState: function() {\n\t\treturn getProjectState();\n\t},\n\n  render: function () {\n    return (\n      <div id=\"keen-explorer\">\n        <Loader visible={this.state.project.loading || !this.state.app.ready} additionalClasses=\"app-loader\" />\n        <Explorer project={this.state.project}\n                  client={this.props.client}\n                  persistence={this.props.persistence} />\n      </div>\n    );\n  },\n\n  _onChange: function() {\n    this.setState(getProjectState());\n  }\n\n});\n\nexport default App;\n","import React from 'react';\nimport _ from 'lodash';\nimport EventBrowser from '../common/event_browser.js';\nimport Visualization from './visualization/index.js';\nimport QueryPaneTabs from './query_pane_tabs.js';\nimport QueryBuilder from './query_builder/index.js';\nimport BrowseQueries from './saved_queries/browse_queries.js';\nimport CacheToggle from './cache_toggle.js';\nimport QueryActions from './query_actions.js';\nimport Notice from '../common/notice.js';\nimport FilterManager from '../common/filter_manager.js';\nimport ExplorerStore from '../../stores/ExplorerStore';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport NoticeActions from '../../actions/NoticeActions';\nimport AppStateActions from '../../actions/AppStateActions';\nimport NoticeStore from '../../stores/NoticeStore';\nimport AppStateStore from '../../stores/AppStateStore';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport FilterUtils from '../../utils/FilterUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport CashedQueryUtils from '../../utils/CashedQueryUtils';\nimport QueryStringUtils from '../../utils/QueryStringUtils';\n\nfunction getStoresState() {\n  return {\n    allPersistedExplorers: ExplorerStore.getAllPersisted(),\n    activeExplorer: ExplorerStore.getActive(),\n    notice: NoticeStore.getGlobalNotice(),\n    stepNotices: NoticeStore.getStepNotices(),\n    appState: AppStateStore.getState()\n  };\n}\n\nconst Explorer = React.createClass({\n\n  toggleFields: function() {\n    _.each(this.getFieldsToggleComponents(), function(toggleObj) {\n      if (toggleObj.component) {\n        var hasValue = (!_.isUndefined(toggleObj.value) && !_.isNull(toggleObj.value)) ? true : false;\n        toggleObj.component.setState({ open: hasValue });\n      }\n    });\n  },\n\n  // ********************************\n  // Callbacks for child components\n  // ********************************\n\n  selectEventCollection: function(collectionName) {\n    var updates = {\n      query: {\n        event_collection: collectionName\n      }\n    };\n    ExplorerActions.update(this.state.activeExplorer.id, updates);\n    this.refs['event-browser'].refs.modal.close();\n  },\n\n  savedQueryClicked: function(event) {\n    event.preventDefault();\n    if (this.state.activeExplorer.loading) {\n      NoticeActions.create({\n        icon: 'info-sign',\n        type: 'warning',\n        text: \"There is already a query in progress. Wait for it to finish loading before selecting a query.\"\n      });\n    } else {\n      ExplorerActions.revertActiveChanges();\n      var modelId = event.currentTarget.dataset.id;\n      ExplorerActions.setActive(modelId);\n      ExplorerActions.exec(this.props.client, modelId);\n    }\n  },\n\n  removeSavedQueryClicked: function() {\n    if (confirm('Are you sure you want to delete this saved query?')) {\n      ExplorerActions.destroy(this.props.persistence, this.state.activeExplorer.id);\n    }\n  },\n\n  saveQueryClick: function(event) {\n    event.preventDefault();\n    ExplorerActions.save(this.props.persistence, this.state.activeExplorer.id);\n  },\n\n  cloneQueryClick: function(event) {\n    event.preventDefault();\n    ExplorerActions.clone(this.state.activeExplorer.id);\n    var newExplorer = ExplorerStore.getLast();\n    ExplorerActions.setActive(newExplorer.id);\n    this.setState({ activeQueryPane: 'build' });\n  },\n\n  createNewQuery: function(event) {\n    event.preventDefault();\n    ExplorerActions.create();\n    var newExplorer = ExplorerStore.getLast();\n    ExplorerActions.setActive(newExplorer.id);\n    this.setState({ activeQueryPane: 'build' });\n    CashedQueryUtils.checkLimits();\n  },\n\n  onBrowseEvents: function(event) {\n    event.preventDefault();\n    this.refs['event-browser'].refs.modal.open();\n  },\n\n  handleFiltersToggle: function() {\n    this.refs['filter-manager'].open();\n  },\n\n  onDisplayNameChange: function(event) {\n    var updates = {\n      query_name: ExplorerUtils.slugify(event.target.value),\n      metadata: {\n        display_name: event.target.value\n      }\n    };\n    ExplorerActions.update(this.state.activeExplorer.id, updates);\n  },\n\n  onQueryNameChange: function(event) {\n    var name = event.target.value.replace(/[^\\w-]/g,'');\n    ExplorerActions.update(this.state.activeExplorer.id, { query_name: name });\n  },\n\n  handleRevertChanges: function(event) {\n    event.preventDefault();\n    ExplorerActions.revertActiveChanges();\n  },\n\n  handleQuerySubmit: function(event) {\n    event.preventDefault();\n    if (ExplorerUtils.isEmailExtraction(this.state.activeExplorer)) {\n      ExplorerActions.runEmailExtraction(this.props.client, this.state.activeExplorer.id);\n    } else {\n      ExplorerActions.exec(this.props.client, this.state.activeExplorer.id);\n    }\n  },\n\n  setExtractionType: function(event) {\n    var updates = {\n      query: {\n        email: event.target.value === 'email' ? \"\" : null\n      }\n    };\n    ExplorerActions.update(this.state.activeExplorer.id, updates);\n  },\n\n  handleClearQuery: function() {\n    // NOTE: (Eric Anderson, Aug 19, 2015): Awful terrible hack to\n    // ensure that the components properly display the values of the cleared\n    // model.\n    var self = this;\n    setTimeout(function(){\n      ExplorerActions.clear(self.state.activeExplorer.id);\n    }, 0);\n  },\n\n  handleAddFilter: function() {\n    ExplorerActions.addFilter(this.state.activeExplorer.id);\n  },\n\n  handleRemoveFilter: function(index) {\n    ExplorerActions.removeFilter(this.state.activeExplorer.id, index);\n  },\n\n  handleFilterChange: function(index, updates) {\n    ExplorerActions.updateFilter(this.state.activeExplorer.id, index, updates);\n  },\n\n  // ********************************\n  // Convenience functions\n  // ********************************\n\n  setVizWrapTop: function(top) {\n    this.refs['viz-area'].style.top = top + 'px';\n  },\n\n  getSelectedIndex: function() {\n    if (!this.state.activeExplorer || !ExplorerUtils.isPersisted(this.state.activeExplorer)) {\n      return null;\n    }\n    return _.findIndex(this.state.allPersistedExplorers, { id: this.state.activeExplorer.id });\n  },\n\n  toggleQueryPane: function(pane) {\n    this.setState({ activeQueryPane: pane });\n  },\n\n  getSelectedIndex: function() {\n    var index;\n    for (var i=0; i<this.state.allPersistedExplorers.length; i++) {\n      if (this.state.allPersistedExplorers[i].active) {\n        index = i;\n        break;\n      }\n    }\n    return index;\n  },\n\n  toggleCodeSample: function(event) {\n    event.preventDefault();\n    AppStateActions.update({\n      codeSampleHidden: !this.state.appState.codeSampleHidden\n    });\n  },\n\n  getEventPropertyNames: function(collection)  {\n    return ProjectUtils.getEventCollectionPropertyNames(\n      this.props.project,\n      collection\n    );\n  },\n\n  getPropertyType: function (eventCollection, property_name) {\n    return ProjectUtils.getPropertyType(\n      this.props.project,\n      eventCollection,\n      property_name\n    );\n  },\n\n  // Lifecycle hooks\n\n  componentDidMount: function() {\n    ExplorerStore.addChangeListener(this._onChange);\n    NoticeStore.addChangeListener(this._onChange);\n    AppStateStore.addChangeListener(this._onChange);\n  },\n\n  componentWillUnmount: function() {\n    ExplorerStore.removeChangeListener(this._onChange);\n    NoticeStore.removeChangeListener(this._onChange);\n    AppStateStore.removeChangeListener(this._onChange);\n    // Create a default filter if there are no filters already on this model\n    if (!this.state.activeExplorer.query.filters.length) {\n      ExplorerActions.addFilter(this.state.activeExplorer.id);\n    }\n  },\n\n  getInitialState: function() {\n    return _.assign(getStoresState(), {\n      activeQueryPane: 'build'\n    });\n  },\n\n  render: function() {\n    var cacheToggle,\n        queryPane,\n        queryPaneTabs,\n        browseListNotice,\n        browseEmptyContent;\n\n    if (this.props.persistence) {\n      queryPaneTabs = <QueryPaneTabs ref=\"query-pane-tabs\"\n                                     activePane={this.state.activeQueryPane}\n                                     toggleCallback={this.toggleQueryPane}\n                                     createNewQuery={this.createNewQuery}\n                                     persisted={ExplorerUtils.isPersisted(this.state.activeExplorer)} />;\n      if (['extraction'].indexOf(this.state.activeExplorer.query.analysis_type) === -1) {\n        cacheToggle = <CacheToggle model={this.state.activeExplorer} isLimited={this.state.appState.isLimited} />;\n      }\n      if (this.state.appState.fetchingPersistedExplorers) {\n        browseListNotice = <Notice notice={{ icon: 'info-sign', text: 'Loading saved queries...', type: 'info' }} closable={false} />\n      } else {\n        browseEmptyContent = <h4 className=\"text-center\">You don&#39;t have any saved queries yet.</h4>;\n      }\n    }\n\n    if (!this.props.persistence || this.state.activeQueryPane === 'build') {\n      queryPane = <QueryBuilder ref=\"query-builder\"\n                                model={this.state.activeExplorer}\n                                originalModel={this.state.activeExplorerOriginal}\n                                client={this.props.client}\n                                project={this.props.project}\n                                onBrowseEvents={this.onBrowseEvents}\n                                handleFiltersToggle={this.handleFiltersToggle}\n                                handleRevertChanges={this.handleRevertChanges}\n                                handleQuerySubmit={this.handleQuerySubmit}\n                                setExtractionType={this.setExtractionType}\n                                handleClearQuery={this.handleClearQuery}\n                                getEventPropertyNames={this.getEventPropertyNames}\n                                getPropertyType={this.getPropertyType}\n                                analysisTypes={ProjectUtils.getConstant('ANALYSIS_TYPES')}\n                                stepNotices={this.state.stepNotices} />;\n    } else {\n      queryPane = <BrowseQueries ref=\"query-browser\"\n                                 listItems={this.state.allPersistedExplorers}\n                                 emptyContent={browseEmptyContent}\n                                 notice={browseListNotice}\n                                 clickCallback={this.savedQueryClicked}\n                                 selectedIndex={this.getSelectedIndex()} />;\n    }\n\n    return (\n      <div ref=\"root\">\n        <div className=\"row\">\n          <div className=\"col-sm-5 col-md-4 explorer-query-builder\">\n            {queryPaneTabs}\n            {queryPane}\n          </div>\n          <div ref=\"viz-area\" className=\"col-sm-7 col-md-8 explorer-visualization\">\n            <Visualization notice={this.state.notice}\n                           model={this.state.activeExplorer}\n                           client={this.props.client}\n                           project={this.props.project}\n                           persistence={this.props.persistence}\n                           onNameChange={this.onNameChange}\n                           appState={this.state.appState}\n                           toggleCodeSample={this.toggleCodeSample}\n                           onQueryNameChange={this.onQueryNameChange}\n                           onDisplayNameChange={this.onDisplayNameChange} />\n            {cacheToggle}\n            <QueryActions model={this.state.activeExplorer}\n                          handleRevertChanges={this.handleRevertChanges}\n                          handleQuerySubmit={this.handleQuerySubmit}\n                          saveQueryClick={this.saveQueryClick}\n                          removeClick={this.removeSavedQueryClicked}\n                          cloneQueryClick={this.cloneQueryClick}\n                          persistence={this.props.persistence}\n                          codeSampleHidden={this.state.appState.codeSampleHidden}\n                          toggleCodeSample={this.toggleCodeSample} />\n          </div>\n        </div>\n        <EventBrowser ref=\"event-browser\"\n                      client={this.props.client}\n                      project={this.props.project}\n                      currentEventCollection={this.state.activeExplorer.query.event_collection}\n                      selectEventCollection={this.selectEventCollection} />\n        <FilterManager ref=\"filter-manager\"\n                       eventCollection={this.state.activeExplorer.query.event_collection}\n                       filters={this.state.activeExplorer.query.filters}\n                       handleChange={this.handleFilterChange}\n                       removeFilter={this.handleRemoveFilter}\n                       addFilter={this.handleAddFilter}\n                       getPropertyType={this.getPropertyType}\n                       propertyNames={this.getEventPropertyNames(this.state.activeExplorer.query.event_collection)} />\n      </div>\n    );\n  },\n\n  _onChange: function() {\n    var newState = getStoresState();\n    this.setState(newState);\n    if (ExplorerUtils.isPersisted(newState.activeExplorer)) {\n      window.history.pushState({ model: newState.activeExplorer }, \"\", '?saved_query='+newState.activeExplorer.id);\n    } else {\n      QueryStringUtils.updateSearchString(ExplorerUtils.paramsForURL(newState.activeExplorer));\n    }\n  }\n});\n\nexport default Explorer;\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport Loader from '../common/loader.js';\nimport FormatUtils from '../../utils/FormatUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport ProjectActions from '../../actions/ProjectActions';\nimport Modal from './modal.js';\n\nconst EventBrowser = React.createClass({\n\n  onKeyUp: function(event) {\n    var enterKeyCode = 13;\n    if (event.keyCode === enterKeyCode) this.selectEventCollection();\n  },\n\n  shouldFetchCollectionSchema: function (collection) {\n    if (!this.props.project.schema[collection]) return false;\n    return _.keys(this.props.project.schema[collection].properties).length < 1;\n  },\n\n  selectEventCollectionClick: function(event) {\n    event.preventDefault();\n    this.props.selectEventCollection(this.state.activeEventCollection);\n  },\n\n  setActiveEventCollectionClick: function(event) {\n    this.setActiveEventCollection(event.target.innerText);\n  },\n\n  setActiveEventCollection: function(collection) {\n    if (collection === this.state.activeEventCollection) return;\n    this.setState({ activeEventCollection: collection });\n    if (this.state.activeView === 'recentEvents') {\n      this.fetchRecentEvents(collection);\n    }\n    else if (this.shouldFetchCollectionSchema(collection)) {\n      ProjectActions.fetchCollectionSchema(this.props.client, collection);\n    }\n  },\n\n  modalOpened: function() {\n    if (this.state.activeView === 'recentEvents') {\n      this.fetchRecentEvents();\n    }\n    else if (this.shouldFetchCollectionSchema(this.state.activeEventCollection)) {\n      ProjectActions.fetchCollectionSchema(this.props.client, this.state.activeEventCollection);\n    }\n  },\n\n  fetchRecentEvents: function(collectionToUse) {\n    var collection = collectionToUse ? collectionToUse : this.state.activeEventCollection;\n    var schema = this.props.project.schema;\n    if (!_.isEmpty(schema) && schema[collection] && !schema[collection].recentEvents && !schema[collection].loading) {\n      ProjectActions.fetchRecentEventsForCollection(this.props.client, collection);\n    }\n  },\n\n  setSearchText: function(event) {\n    this.setState({ searchtext: event.target.value });\n  },\n\n  // Builders\n\n  buildEventCollectionNodes: function() {\n    return _.map(this.props.project.eventCollections, _.bind(function(eventCollection) {\n      var re = new RegExp(this.state.searchtext, 'i');\n      var classes = classNames({\n        'active': this.state.activeEventCollection === eventCollection,\n        'hide':  re.test(eventCollection) ? false : true\n      });\n      return (\n        <li className={classes} key={eventCollection}>\n          <a href=\"#\" onClick={this.setActiveEventCollectionClick}>{eventCollection}</a>\n        </li>\n      );\n    }, this));\n  },\n\n  // Convenience functions\n\n  getNavClasses: function(name) {\n    return (this.state.activeView === name) ? 'active' : '';\n  },\n\n  shouldShowLoader: function() {\n    if (this.props.project.schema[this.state.activeEventCollection]) {\n      return this.props.project.schema[this.state.activeEventCollection].loading;\n    }\n    return false;\n  },\n\n  getRecentEvents: function() {\n    if (!this.props.project.schema[this.state.activeEventCollection]) return \"\";\n    var recentEvents = this.props.project.schema[this.state.activeEventCollection].recentEvents;\n    return recentEvents ? FormatUtils.prettyPrintJSON(recentEvents) : \"\";\n  },\n\n  getSchema: function() {\n    var schema = this.props.project.schema;\n    var collection = this.state.activeEventCollection;\n    var properties = schema[collection] ? schema[collection].properties : {};\n    var ordered = {};\n    if (properties) {\n      _.each(Object.keys(properties).sort(), function(key, i) {\n        ordered[key] = properties[key];\n      });\n    }\n    return FormatUtils.prettyPrintJSON(ordered) || '';\n  },\n\n  changeActiveView: function(event) {\n    event.preventDefault();\n    var tabName = event.target.name;\n    this.setState({ activeView: tabName });\n    if (tabName === 'recentEvents') this.fetchRecentEvents();\n  },\n\n  // Lifecycle hooks\n\n  getInitialState: function() {\n    return {\n      activeView: 'schema',\n      activeEventCollection: null,\n      searchtext: ''\n    }\n  },\n\n  componentDidMount: function() {\n    if (!this.state.activeEventCollection && !_.isEmpty(this.props.project.schema)) {\n      this.setActiveEventCollection(this.props.currentEventCollection || this.props.project.eventCollections[0]);\n    }\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    if (!_.isEmpty(nextProps.project.schema) && !this.state.activeEventCollection) {\n      this.setState({ activeEventCollection: nextProps.project.eventCollections[0] });\n    }\n    if (nextProps.currentEventCollection && nextProps.currentEventCollection != this.props.currentEventCollection) {\n      this.setState({ activeEventCollection: nextProps.currentEventCollection });\n    }\n  },\n\n  render: function() {\n    var previewData;\n    if (this.state.activeView === 'recentEvents') {\n      previewData = this.getRecentEvents();\n    } else {\n      previewData = this.getSchema();\n    }\n\n    var browseContent = (\n      <div className=\"event-browser\" onKeyUp={this.handleKeyUp}>\n        <div className=\"event-names\">\n          <div className=\"search-box\">\n            <input type=\"text\" name=\"search\" ref=\"search-box\" placeholder=\"Search...\" onChange={this.setSearchText} autoComplete=\"off\" />\n            <span className=\"glyphicon glyphicon-search icon\"></span>\n          </div>\n          <ul className=\"nav nav-pills nav-stacked event-names-list\" ref=\"event-names-list\">\n            {this.buildEventCollectionNodes()}\n          </ul>\n        </div>\n        <div className=\"event-browser-content\">\n          <ul className=\"nav nav-tabs view-options\">\n            <li className={this.getNavClasses('schema')}>\n              <a href=\"#\" name=\"schema\" onClick={this.changeActiveView}>\n                Schema\n              </a>\n            </li>\n            <li className={this.getNavClasses('recentEvents')}>\n              <a href=\"#\" name=\"recentEvents\" onClick={this.changeActiveView}>\n                Recent Events\n              </a>\n            </li>\n          </ul>\n          <div ref=\"event-data-wrapper\" className=\"event-data-wrapper\">\n            <Loader ref=\"loader\" visible={this.shouldShowLoader()} />\n            <textarea className=\"json-view\" value={previewData} readOnly />\n          </div>\n        </div>\n      </div>\n    );\n\n    var alertContent = (\n      <div className=\"alert alert-info no-margin no-collections-alert\">\n        There is no data to preview. This project does not have any event collections.\n      </div>\n    );\n\n    var footerBtns = [{ text: 'Close' }];\n\n    var modalClasses = this.props.project.eventCollections.length > 0 ? \"event-browser-modal\" : \"\";\n\n    if (this.props.project.eventCollections.length > 0) {\n      footerBtns.push({\n        text: 'Use this Event Collection',\n        iconName: 'ok',\n        classes: 'btn-primary',\n        onClick: this.selectEventCollectionClick\n      });\n    }\n\n    return (\n      <Modal ref=\"modal\"\n             title=\"Project Event Collections\"\n             size=\"large\"\n             modalClasses={modalClasses}\n             onOpen={this.modalOpened}\n             footerBtns={footerBtns}>\n\n        { this.props.project.eventCollections.length > 0 ? browseContent : alertContent }\n      </Modal>\n    );\n  }\n});\n\nexport default EventBrowser;\n","import _ from 'lodash';\nimport React from 'react';\nimport classNames from 'classnames';\nimport KeenDataviz from 'keen-dataviz';\nimport Select from '../../common/select.js';\nimport Notice from '../../common/notice.js';\nimport Chart from './chart.js';\nimport CodeSample from './code_sample.js';\nimport AppDispatcher from '../../../dispatcher/AppDispatcher';\nimport ExplorerConstants from '../../../constants/ExplorerConstants';\nimport ExplorerActions from '../../../actions/ExplorerActions';\nimport ExplorerStore from '../../../stores/ExplorerStore';\nimport NoticeActions from '../../../actions/NoticeActions';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport ChartTypeUtils from '../../../utils/ChartTypeUtils';\nimport FormatUtils from '../../../utils/FormatUtils';\nimport DataUtils from '../../../utils/DataUtils';\n\nconst Visualization = React.createClass({\n\n  getInitialState: function() {\n    return {\n      focusDisplayName: false,\n      focusQueryName: false,\n      blurTimeout: 100\n    };\n  },\n\n  handleDisplayNameFocus: function(){\n    this.setState({ focusDisplayName: true });\n  },\n\n  handleDisplayNameBlur: function(){\n    setTimeout(function(){\n      this.setState({ focusDisplayName: false });\n    }.bind(this), this.state.blurTimeout);\n  },\n\n  handleQueryNameFocus: function(){\n    this.setState({ focusQueryName: true });\n  },\n\n  handleQueryNameBlur: function(){\n    setTimeout(function(){\n      this.setState({ focusQueryName: false });\n    }.bind(this), this.state.blurTimeout);\n  },\n\n  noticeClosed: function() {\n    NoticeActions.clearAll();\n  },\n\n  changeChartType: function(event) {\n    var chartType = _.find(this.formatChartTypes(), function(type){\n      return type.value === event.target.value;\n    });\n    var updates = {\n      metadata: {\n        visualization: { chart_type: chartType.value }\n      }\n    };\n    ExplorerActions.update(this.props.model.id, updates);\n  },\n\n  formatChartTypes: function() {\n    return _.map(ChartTypeUtils.getChartTypeOptions(this.props.model.query), function(type) {\n      return {\n        name: (type !== 'JSON') ? FormatUtils.toTitleCase(type).replace('chart', '') : type,\n        value: type\n      };\n    });\n  },\n\n  chartType: function() {\n    if (this.props.model.metadata.visualization &&\n        this.props.model.metadata.visualization.chart_type) {\n      return this.props.model.metadata.visualization.chart_type;\n    }\n    else {\n      return _.first(ChartTypeUtils.getChartTypeOptions(this.props.model.query))\n    }\n  },\n\n  componentWillMount: function() {\n    this.dataviz = new KeenDataviz();\n  },\n\n  componentWillUnmount: function() {\n    AppDispatcher.unregister(this.dispatcherToken);\n  },\n\n  exportToCsv: function() {\n    var data = this.dataviz.dataset.matrix;\n    var filename = this.props.model.query_name || 'untitled-query';\n    DataUtils.exportToCsv(data, filename);\n  },\n\n  render: function() {\n    var chartTitle,\n        codeSample;\n\n    var chartDetailBarClasses = classNames({\n      'chart-detail-bar': true,\n      'chart-detail-bar-focus': (this.state.focusDisplayName || this.state.focusQueryName) && this.props.model.response !== null && !this.props.model.loading,\n      'chart-detail-active': this.props.model.response !== null && !this.props.model.loading\n    });\n\n    if (this.props.model.isValid) {\n      codeSample = ExplorerUtils.getSdkExample(this.props.model, this.props.client);\n    }\n\n    if (this.props.persistence) {\n      chartTitle = (\n        <div className=\"chart-title-component\">\n          <input className=\"chart-display-name\"\n                 type=\"text\"\n                 onChange={this.props.onDisplayNameChange}\n                 onBlur={this.handleDisplayNameBlur}\n                 onFocus={this.handleDisplayNameFocus}\n                 spellCheck=\"false\"\n                 value={this.props.model.metadata.display_name}\n                 placeholder=\"Give your query a name...\" />\n          <div className=\"chart-query-name\">\n            <label>\n              Saved Query Resource Name &nbsp;\n              <a href=\"https://keen.io/docs/api/#saved-queries\" target=\"_blank\">\n                <i className=\"icon glyphicon glyphicon-question-sign\"></i>\n              </a>\n            </label>\n            <input className=\"chart-query-name\"\n                   type=\"text\"\n                   onChange={this.props.onQueryNameChange}\n                   onBlur={this.handleQueryNameBlur}\n                   onFocus={this.handleQueryNameFocus}\n                   spellCheck=\"false\"\n                   value={this.props.model.query_name} />\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"visualization\">\n        <Notice notice={this.props.notice} closeCallback={this.noticeClosed} />\n        <div className=\"visualization-wrapper\">\n          <div className={chartDetailBarClasses}>\n            {chartTitle}\n            <div className=\"chart-type-component\">\n              <Select label={false}\n                      ref=\"chart-type\"\n                      name=\"chart_type\"\n                      classes=\"chart-type\"\n                      options={this.formatChartTypes()}\n                      handleSelection={this.changeChartType}\n                      selectedOption={this.chartType()}\n                      emptyOption={false}\n                      disabled={this.props.model.loading} />\n            </div>\n          </div>\n          <div className=\"chart-component\">\n            <Chart model={this.props.model}\n                   dataviz={this.dataviz}\n                   exportToCsv={this.exportToCsv}/>\n          </div>\n          <CodeSample ref=\"codesample\"\n                      codeSample={codeSample}\n                      hidden={this.props.appState.codeSampleHidden}\n                      onCloseClick={this.props.toggleCodeSample}\n                      isValid={this.props.model.isValid} />\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Visualization;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__62__;","import _ from 'lodash';\nimport React from 'react';\nimport Loader from '../../common/loader.js';\nimport KeenViz from './keen_viz.js';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport { prettyPrintJSON } from '../../../utils/FormatUtils';\n\nconst Chart = React.createClass({\n\n  // ***********************\n  // Content building\n  // ***********************\n\n  buildVizContent: function() {\n    if (!this.props.model.response) {\n      return (\n          <div ref=\"notice\" className=\"big-notice\">\n          <div className=\"alert alert-info\">\n          {'Let\\'s go exploring!'}\n          </div>\n          </div>\n          );\n    }\n\n    if (ExplorerUtils.isEmailExtraction(this.props.model)) {\n      return (\n          <div ref=\"notice\" className=\"big-notice\">\n          <div className=\"alert alert-info\">\n          {'Email extractions don\\'t have visualizations.'}\n          </div>\n          </div>\n          );\n    }\n\n    if (!ExplorerUtils.resultCanBeVisualized(this.props.model)) {\n      return (\n          <div ref=\"notice\" className=\"big-notice\">\n          <div className=\"alert alert-danger\">\n          <span className=\"icon glyphicon glyphicon-info-sign error\"></span>\n          Your query returned no results.\n          </div>\n          </div>\n          );\n    }\n\n    if (ExplorerUtils.resultCanBeVisualized(this.props.model)) {\n      return this.buildViz();\n    } else {\n      this.props.dataviz.destroy();\n    }\n  },\n\n  buildViz: function() {\n    var chartContent;\n    var msgContent;\n    var analysisType = this.props.model.query.analysis_type;\n    var wrapClasses = analysisType + '-viz';\n\n    if (ExplorerUtils.isJSONViz(this.props.model)) {\n      var content = {\n        result: this.props.model.response.result\n      };\n      if (this.props.model.response.actors) {\n        content.actors = this.props.model.response.actors;\n      }\n      chartContent = (\n        <textarea ref='jsonViz'\n                  className=\"json-view\"\n                  value={prettyPrintJSON(content)}\n                  readOnly />\n      );\n    }\n\n    else {\n      chartContent = (\n          <KeenViz model={this.props.model} dataviz={this.props.dataviz}\n          exportToCsv={this.props.exportToCsv}/>\n          );\n    }\n\n    return (\n        <div className={wrapClasses}>\n        {chartContent}\n        </div>\n        );\n  },\n\n  // ***********************\n  // Lifecycle hooks\n  // ***********************\n\n  render: function() {\n    var vizContent = this.buildVizContent();\n\n    return (\n        <div className=\"chart-area\">\n        <Loader visible={this.props.model.loading} />\n        {vizContent}\n        </div>\n        );\n    }\n});\n\nexport default Chart;\n","import React from 'react';\nimport ChartTypeUtils from '../../../utils/ChartTypeUtils';\nimport FormatUtils from '../../../utils/FormatUtils';\n\nconst KeenViz = React.createClass({\n\n  lastDataTimestamp: null,\n  lastChartType: null,\n\n  // ***********************\n  // Convenience functions\n  // ***********************\n\n  showVisualization: function() {\n    this.props.dataviz.destroy();\n\n    this.props.dataviz\n      .data(this.props.model.response)\n      .el(this.refs['keen-viz'])\n      .height(300)\n      .title(null)\n      .type(this.props.model.metadata.visualization.chart_type);\n\n    if (this.props.model.query.analysis_type !== \"funnel\") {\n      this.props.dataviz.sortGroups('desc')\n    }\n\n    this.props.dataviz.render();\n\n    this.lastDataTimestamp = this.props.model.dataTimestamp;\n    this.lastChartType = this.props.model.metadata.visualization.chart_type;\n  },\n\n  // ***********************\n  // Lifecycle hooks\n  // ***********************\n\n  shouldComponentUpdate: function(nextProps, nextState) {\n    if (this.lastChartType !== nextProps.model.metadata.visualization.chart_type) {\n      return true;\n    }\n    if (!this.lastDataTimestamp || this.lastDataTimestamp !== nextProps.model.dataTimestamp) {\n      return true\n    }\n    return false;\n  },\n\n  componentDidUpdate: function() {\n    this.showVisualization();\n  },\n\n  componentDidMount: function() {\n    this.showVisualization();\n  },\n\n  render: function() {\n    var exportBtn;\n    if (ChartTypeUtils.isTableChartType(this.props.model.metadata.visualization.chart_type)) {\n      exportBtn = (\n        <button className=\"btn btn-default btn-download-csv\"\n                role=\"export-table\"\n                type=\"button\"\n                onClick={this.props.exportToCsv}>\n          Download CSV\n        </button>\n      );\n    }\n\n    return (\n      <div ref=\"keen-viz-wrapper\">\n        <div ref=\"keen-viz\"></div>\n        {exportBtn}\n      </div>\n    );\n  }\n});\n\nexport default KeenViz;\n","import _ from 'lodash';\nimport React from 'react';\nimport classNames from 'classnames';\nimport Highlight from 'react-highlight';\n\nconst CodeSample = React.createClass({\n  render: function() {\n    var panelClasses = classNames({\n      'code-sample-panel': true,\n      'hide': this.props.hidden\n    });\n\n    var text;\n    if(this.props.isValid) {\n      text = this.props.codeSample;\n    } else {\n      text = \"Your query is not valid right now, so we can't show you a code sample.\";\n    }\n\n    return (\n      <div className={panelClasses}>\n        <a href=\"#\" className=\"close-btn\" onClick={this.props.onCloseClick}>\n          <span className=\"icon glyphicon glyphicon glyphicon-remove-circle no-margin\"></span>\n        </a>\n        <div className=\"sample\">\n          <Highlight className=\"html\">\n            {text}\n          </Highlight>\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default CodeSample;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__66__;","export default {\n  exportToCsv: function(data, filename) {\n    var csvContent = '';\n    var htmlElement;\n\n    data.forEach(function(row, i){\n      row.forEach(function(cell, j){\n        csvContent += String(cell).replace(/,/g, '');\n        if (row.length > j+1) {\n          csvContent += ',';\n        }\n      });\n      if (data.length > i+1) {\n        csvContent += '\\n';\n      }\n    });\n\n    var encodedData = '';\n    if (typeof window !== 'undefined' && window.URL) {\n      var blob = new Blob(['\\ufeff' + csvContent], { type: 'text/csv; charset=utf-8' });\n      encodedData = window.URL.createObjectURL(blob);\n    } else {\n      encodedData = 'data:text/csv;charset=utf-8,' + encodeURI(csvContent);\n    }\n\n    htmlElement = document.createElement('a');\n    htmlElement.setAttribute('href', encodedData);\n\n    if (filename.indexOf('.csv') === -1) {\n      filename += '.csv';\n    }\n    htmlElement.setAttribute('download', filename);\n    document.body.appendChild(htmlElement);\n    htmlElement.click();\n  }\n}\n","import React from 'react';\nimport classNames from 'classnames';\n\nconst QueryPaneTabs = React.createClass({\n\n  toggled: function(tab) {\n    this.props.toggleCallback(tab);\n  },\n\n  render: function() {\n    var btnNewQuery;\n    var queryPaneClasses = classNames({\n      'query-pane-tabs clearfix': true,\n      'query-pane-persisted': this.props.persisted,\n      'query-pane-new': !this.props.persisted\n    });\n\n    if (this.props.persisted) {\n      btnNewQuery = <li role=\"presentation\" className=\"tab-new-query\">\n        <a ref=\"new-query\" href=\"#\"\n           title=\"Create a new query\"\n           onClick={this.props.createNewQuery}>\n          <span className=\"icon glyphicon icon-plus glyphicon-plus\"></span>\n        </a>\n      </li>;\n    }\n\n    return (\n      <div className={queryPaneClasses}>\n        <ul className=\"nav nav-tabs\">\n          {btnNewQuery}\n          <li role=\"presentation\" className={this.props.activePane === 'build' ? 'tab-build-query active' : 'tab-build-query'}>\n            <a ref=\"build-tab\" href=\"#\"\n               id=\"build-query\"\n               title={this.props.persisted ? \"Edit query\" : \"Create a new query\"}\n               onClick={this.toggled.bind(this, 'build')}>\n              {this.props.persisted ? \"Edit query\" : \"Create a new query\"}\n            </a>\n          </li>\n          <li role=\"presentation\" className={this.props.activePane === 'browse' ? 'tab-browse-queries active' : 'tab-browse-queries'}>\n            <a ref=\"browse-tab\" href=\"#\"\n               id=\"browse\"\n               title=\"Browse saved queries\"\n               onClick={this.toggled.bind(this, 'browse')}>\n              <span className=\"icon glyphicon icon-th-list glyphicon-th-list\"></span>\n              Browse\n            </a>\n          </li>\n        </ul>\n      </div>\n    );\n  }\n\n});\n\nexport default QueryPaneTabs;\n","import _ from 'lodash';\nimport React from 'react';\n\n// Components\nimport FieldsToggle from '../../common/fields_toggle.js';\nimport SelectField from './select_field.js';\nimport PercentileField from './percentile_field.js';\nimport GroupByField from './group_by_field.js';\nimport ExtractionOptions from './extraction_options.js';\nimport FunnelBuilder from './funnels/funnel_builder.js';\nimport Timeframe from '../../common/timeframe.js';\nimport Interval from '../../common/interval.js';\nimport Input from '../../common/input.js';\nimport ApiUrl from './api_url.js';\nimport ExplorerStore from '../../../stores/ExplorerStore';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport FilterUtils from '../../../utils/FilterUtils';\nimport ExplorerActions from '../../../actions/ExplorerActions';\n\nconst QueryBuilder = React.createClass({\n\n  // Event callbacks\n\n  handleSelectionWithEvent: function(event) {\n    this.handleChange(event.target.name, event.target.value);\n  },\n\n  handleChange: function(update, value) {\n    var updates = { query: {} };\n\n    if(_.isPlainObject(update)) {\n      for(key in update) {\n        updates.query[key] = update[key];\n      }\n    } else {\n      updates.query[update] = value;\n    }\n\n    ExplorerActions.update(this.props.model.id, updates);\n  },\n\n  // Convenience Methods\n\n  updateGroupBy: function(updates) {\n    ExplorerActions.update(this.props.model.id, { query: updates });\n  },\n\n  handleRevertChanges: function(event) {\n    event.preventDefault();\n    ExplorerActions.revertActiveChanges();\n  },\n\n  shouldShowRevertButton: function() {\n    return ExplorerUtils.isPersisted(this.props.model) && this.props.model.originalModel && this.props.model.originalModel.query && !_.isEqual(this.props.model.query, this.props.model.originalModel.query);\n  },\n\n  // Fields Builders\n\n  buildEventCollectionField: function() {\n    if (this.props.model.query.analysis_type !== 'funnel') {\n      return (\n        <SelectField name=\"event_collection\"\n                     label=\"Event Collection\"\n                     value={this.props.model.query.event_collection}\n                     requiredLabel={true}\n                     onBrowseEvents={this.props.onBrowseEvents}\n                     handleChange={this.handleChange}\n                     options={this.props.project.eventCollections} />\n      );\n    }\n  },\n\n  buildExtractionOptions: function() {\n    if (this.props.model.query.analysis_type === 'extraction') {\n      return (\n        <ExtractionOptions latest={this.props.model.query.latest}\n                           email={this.props.model.query.email}\n                           property_names={this.props.model.query.property_names}\n                           event_collection={this.props.model.query.event_collection}\n                           projectSchema={this.props.project.schema}\n                           isEmail={ExplorerUtils.isEmailExtraction(this.props.model)}\n                           handleChangeWithEvent={this.handleSelectionWithEvent}\n                           handleChange={this.handleChange}\n                           setExtractionType={this.props.setExtractionType} />\n      );\n    }\n  },\n\n  buildGroupByField: function() {\n    if (['extraction', 'funnel'].indexOf(this.props.model.query.analysis_type) === -1) {\n      return (\n        <GroupByField ref=\"group-by-field\"\n                      value={this.props.model.query.group_by}\n                      updateGroupBy={this.updateGroupBy}\n                      options={this.props.getEventPropertyNames(this.props.model.query.event_collection)}\n                      handleChange={this.handleChange} />\n      );\n    }\n  },\n\n  buildTargetPropertyField: function() {\n    var type = this.props.model.query.analysis_type;\n    if (type !== null && ExplorerUtils.shouldHaveTarget(this.props.model)) {\n      return (\n        <SelectField name=\"target_property\"\n                     label=\"Target Property\"\n                     inputClasses={['target-property']}\n                     requiredLabel={true}\n                     handleChange={this.handleChange}\n                     options={this.props.getEventPropertyNames(this.props.model.query.event_collection)}\n                     value={this.props.model.query.target_property}\n                     sort={true} />\n      );\n    }\n  },\n\n  buildPercentileField: function() {\n    if (this.props.model.query.analysis_type === 'percentile') {\n      return (\n        <PercentileField ref=\"percentile-field\"\n                         value={this.props.model.query.percentile}\n                         onChange={this.handleSelectionWithEvent} />\n      );\n    }\n  },\n\n  buildIntervalField: function() {\n    if (['extraction', 'funnel'].indexOf(this.props.model.query.analysis_type) === -1) {\n      return (\n        <Interval interval={this.props.model.query.interval}\n                  handleChange={this.handleChange} />\n      );\n    }\n  },\n\n  buildFilters: function() {\n    if (this.props.model.query.analysis_type !== 'funnel') {\n      return (\n        <div className=\"field-component\">\n          <FieldsToggle ref=\"filters-fields-toggle\"\n                        name=\"Filters\"\n                        toggleCallback={this.props.handleFiltersToggle}\n                        fieldsCount={FilterUtils.validFilters(this.props.model.query.filters).length} />\n        </div>\n      );\n    }\n  },\n\n  buildGlobalTimeframePicker: function() {\n    if (this.props.model.query.analysis_type !== 'funnel') {\n      return (\n        <div>\n          <Timeframe ref=\"timeframe\"\n                     time={this.props.model.query.time}\n                     timezone={this.props.model.query.timezone}\n                     handleChange={this.handleChange}/>\n          <hr className=\"fieldset-divider\" />\n        </div>\n      );\n    }\n  },\n\n  buildFunnelBuilder: function() {\n    if (this.props.model.query.analysis_type === 'funnel') {\n      return <FunnelBuilder modelId={this.props.model.id}\n                            steps={this.props.model.query.steps}\n                            stepNotices={this.props.stepNotices || []}\n                            onBrowseEvents={this.props.onBrowseEvents}\n                            eventCollections={this.props.project.eventCollections}\n                            getEventPropertyNames={this.props.getEventPropertyNames}\n                            getPropertyType={this.props.getPropertyType} />;\n    }\n  },\n\n  buildClearButton: function() {\n    if (!this.shouldShowRevertButton()) {\n      return (\n        <button type=\"reset\" role=\"clear-query\"\n          className=\"btn btn-default btn-block\"\n          id=\"clear-explorer-query\"\n          onClick={this.props.handleClearQuery}>\n            Clear\n        </button>\n      );\n    } else {\n      return (\n        <button\n          className=\"btn btn-default btn-block\"\n          onClick={this.handleRevertChanges}\n          role=\"revert-query\">\n            Revert to original\n        </button>\n      );\n    }\n  },\n\n  // React methods\n\n  render: function() {\n    var apiQueryUrl;\n    if (this.props.model.isValid) {\n      apiQueryUrl = ExplorerUtils.getApiQueryUrl(this.props.client, this.props.model);\n    }\n\n    return (\n      <section className=\"query-pane-section query-builder\">\n        <form className=\"form query-builder-form\" onSubmit={this.props.handleQuerySubmit}>\n          <SelectField name=\"analysis_type\"\n                       label=\"Analysis Type\"\n                       inputClasses={['analysis-type']}\n                       options={this.props.analysisTypes}\n                       value={this.props.model.query.analysis_type}\n                       handleChange={this.handleChange}\n                       requiredLabel={true} />\n          {this.buildEventCollectionField()}\n          {this.buildFunnelBuilder()}\n          {this.buildExtractionOptions()}\n          {this.buildTargetPropertyField()}\n          {this.buildPercentileField()}\n          {this.buildGlobalTimeframePicker()}\n          {this.buildGroupByField()}\n          {this.buildFilters()}\n          {this.buildIntervalField()}\n          <div className=\"button-set-clear-toggle\">\n            {this.buildClearButton()}\n          </div>\n          <ApiUrl url={apiQueryUrl}\n                  isValid={this.props.model.isValid} />\n        </form>\n      </section>\n    );\n  }\n});\n\nexport default QueryBuilder;\n","import React from 'react';\nimport _ from 'lodash';\n\n// Components\nimport Input from '../../common/input.js';\n\nconst PercentileField = React.createClass({\n\n  // React methods\n\n  render: function() {\n    return (\n      <div className=\"field-component\">\n        <Input ref=\"input\"\n               label=\"Percentile Value\"\n               classes=\"percentile\"\n               name=\"percentile\"\n               required=\"true\"\n               placeholder=\"Ex: 50\"\n               onChange={this.props.onChange}\n               value={this.props.value || \"\"} />\n      </div>\n    );\n  }\n\n});\n\nexport default PercentileField;\n","import React from 'react';\nimport _ from 'lodash';\nimport FieldsToggle from '../../common/fields_toggle.js';\n\n// Components\nimport ReactSelect from '../../common/react_select.js';\n\nconst GroupByField = React.createClass({\n\n  focusOnReactSelect: function(toggled) {\n    if (toggled && !this.props.value) {\n      var self = this;\n      setTimeout(function(){\n        self.refs.select.refs.input.focus();\n      }, 100);\n    }\n  },\n\n  multiGroupToggle: function() {\n    var icon = this.props.value.length > 1 ? 'remove' : 'plus';\n    var text = this.props.value.length > 1 ? 'Remove second property' : 'Group by a second property';\n    return (\n      <a className=\"double-groupby-toggle\" href=\"#\" onClick={this.toggleMultiGroupBy}>\n        <i className={\"margin-right-bump icon glyphicon glyphicon-\"+icon}></i>\n        {text}\n      </a>\n    );\n  },\n\n  secondField: function() {\n    if (this.props.value.length > 1) {\n      return (\n        <ReactSelect ref=\"select\"\n                     inputClasses=\"group-by form-control margin-bottom-tiny\"\n                     wrapClasses=\"margin-top-tiny\"\n                     name=\"group_by.1\"\n                     items={this.props.options}\n                     handleChange={this.handleChange}\n                     value={this.props.value[1] || ''}\n                     sort={true} />\n      )\n    }\n  },\n\n  getGroupBy: function() {\n    return this.props.value;\n  },\n\n  handleChange: function(name, value) {\n    var newVal = this.props.value.slice();\n    newVal[name.split('.')[1]] = value;\n    this.props.handleChange('group_by', newVal);\n  },\n\n  toggleMultiGroupBy: function(event) {\n    event.preventDefault();\n    var newVal;\n    switch (this.props.value.length) {\n      case 0:\n        newVal = ['', ''];\n        break;\n      case 1:\n        newVal = this.props.value.concat(['']);\n        break;\n      case 2:\n        newVal = this.props.value.slice(0,1);\n        break;\n    }\n    this.props.handleChange('group_by', newVal);\n  },\n\n  shouldBeOpen: function() {\n    return this.props.value && this.props.value[0]\n  },\n\n  // React methods\n\n  render: function() {\n    return (\n      <div className=\"field-component\">\n        <FieldsToggle ref=\"toggle\"\n                      name=\"Group By\"\n                      initialOpenState={this.shouldBeOpen()}\n                      updateFn={this.props.updateGroupBy}\n                      getFn={this.getGroupBy}\n                      attrsToStore=\"group_by\"\n                      resetValues={{\n                        group_by: []\n                      }}\n                      toggleCallback={this.focusOnReactSelect}>\n          <ReactSelect ref=\"select\"\n                       inputClasses=\"group-by form-control margin-bottom-tiny\"\n                       name=\"group_by.0\"\n                       items={this.props.options}\n                       handleChange={this.handleChange}\n                       value={this.props.value[0] || ''}\n                       sort={true} />\n          {this.secondField()}\n          {this.multiGroupToggle()}\n        </FieldsToggle>\n      </div>\n    );\n  }\n\n});\n\nexport default GroupByField;\n","import React from 'react';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\nimport Input from '../../common/input.js';\nimport ReactMultiSelect from '../../common/react_multi_select.js';\nimport LatestField from './latest_field.js';\n\nclass ExtractionOptions extends React.Component {\n\n  _getExtractionKeys() {\n    if (typeof this.props.projectSchema === \"undefined\") {\n      return false;\n    }\n\n    const schema = this.props.projectSchema[this.props.event_collection];\n    if (typeof schema === \"undefined\") {\n      return false;\n    }\n\n    if (!schema.sortedProperties || !schema.sortedProperties.length) {\n      return false;\n    }\n\n    return schema.sortedProperties.map((property) => {\n      return {\n        value: property,\n        selected: this.props.property_names.indexOf(property) > -1\n      }\n    });\n  }\n\n  _handlePropertyNamesChange(name, propertyName, shouldBeSelected) {\n    let newPropertyNames = this.props.property_names.slice(0);\n    if (shouldBeSelected) {\n      newPropertyNames.push(propertyName);\n    } else {\n      newPropertyNames = newPropertyNames.filter((name) => {\n        return name !== propertyName;\n      });\n    }\n    this.props.handleChange(name, newPropertyNames);\n  }\n\n  render(){\n    let emailField;\n    let latestField;\n    let extractionPropertiesFilter;\n\n    if (this.props.isEmail) {\n      emailField = (\n        <Input type=\"text\"\n               name=\"email\"\n               label=\"Recipient email address\"\n               placeholder=\"your@email.com\"\n               required=\"true\"\n               value={this.props.email}\n               onChange={this.props.handleChangeWithEvent} />\n      );\n      latestField = (\n        <LatestField latest={this.props.latest} handleChange={this.props.handleChangeWithEvent} />\n      );\n    }\n\n    if (this._getExtractionKeys()) {\n      extractionPropertiesFilter = <ReactMultiSelect\n            name=\"property_names\"\n            label=\"Filter extraction properties\"\n            handleChange={this._handlePropertyNamesChange.bind(this)}\n            items={this._getExtractionKeys()}\n      />\n    }\n\n    return (\n      <div className=\"field-component\">\n        <div className=\"extraction-options\">\n          <label>\n            <input type=\"radio\" name=\"extraction_type\" value=\"immediate\" onChange={this.props.setExtractionType} checked={!this.props.isEmail}/> Preview latest {ExplorerUtils.EXRACTION_EVENT_LIMIT} events now\n          </label>\n          <label>\n            <input type=\"radio\" name=\"extraction_type\" value=\"email\" onChange={this.props.setExtractionType} checked={this.props.isEmail}/> Bulk CSV extraction by email\n          </label>\n\n          {emailField}\n          {latestField}\n          {extractionPropertiesFilter}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ExtractionOptions;\n","import React from 'react';\n\nclass ReactMultiSelect extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n      id: 'react-multi-select',\n      focusedIndex: 0\n    }\n  }\n\n  interceptEvent(event) {\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  // Private Event Handler Methods\n  _toggleOpenClose(event) {\n    this.interceptEvent(event);\n\n    if(this.state.open) {\n      return this.setState({ open: false });\n    }\n    else {\n      this.setState({ open: true })\n    }\n  }\n\n  _isSelected(itemVal) {\n    return this.props.items.filter((item) => {\n      if (item.value === itemVal && item.selected) return true;\n      return false;\n    }).length > 0;\n  }\n\n  _handleOptionChange(event) {\n    this.interceptEvent(event);\n    this.props.handleChange(this.props.name, event.target.text, !this._isSelected(event.target.text));\n  }\n\n  _renderOption(option, i) {\n    let className = 'react-select-box-option';\n    if (i === this.state.focusedIndex) {\n      className += ' react-select-box-option-focused'\n    }\n    if (option.selected) {\n      className += ' react-select-box-option-selected'\n    }\n\n    return (<a\n      id={`${this.state.id}-${i}`}\n      className={className}\n      href='#'\n      onClick={this._handleOptionChange.bind(this)}\n      title={option.label}\n      key={`${i}_${option.label}`}\n    >{option.label}</a>\n    )\n  }\n\n  // Private HTML Element methods\n  _renderOptionMenu() {\n    let className = 'react-select-box-options';\n    if (!this.state.open) {\n      className += ' react-select-box-hidden';\n    }\n\n    const options = this.props.items.map((item, i) => {\n      return this._renderOption({ value: item.value, selected: item.selected, label: item.value }, i);\n    });\n\n    return (<div className={className} ref='menu'>\n      {options}\n    </div>)\n  }\n\n  render() {\n    const selectedItems = this.props.items.filter(i => i.selected);\n    const label = selectedItems.length > 0 ? selectedItems.map(i => i.value).join(', ') : this.props.label;\n\n    return (<div className='react-select-box-container react-select-box-multi'>\n      <button id={this.state.id} onClick={this._toggleOpenClose.bind(this)} className='react-select-box'>\n        <div className='react-select-box-label'>{label}</div>\n      </button>\n\n      {this._renderOptionMenu()}\n    </div>);\n  }\n}\n\nexport default ReactMultiSelect;\n","import React from 'react';\nimport Input from '../../common/input.js';\nimport ExplorerUtils from '../../../utils/ExplorerUtils';\n\nconst LatestField = React.createClass({\n\n  render: function() {\n    return (\n      <div className=\"form-group\">\n        <Input type=\"text\"\n               name=\"latest\"\n               label=\"Limit number of events to extract\"\n               value={this.props.latest}\n               placeholder=\"Eg: 1000\"\n               onChange={this.props.handleChange} />\n        <small className=\"text-muted\">\n          <span className=\"icon glyphicon glyphicon-info-sign\"></span>\n          <span>{'Results are limited to 10 million events'}</span>\n        </small>\n      </div>\n    );\n  }\n\n});\n\nexport default LatestField;\n","import React from 'react';\nimport _ from 'lodash';\nimport FunnelStep from './funnel_step.js';\nimport ExplorerActions from '../../../../actions/ExplorerActions.js';\n\nconst FunnelsBuilder = React.createClass({\n\n  propTypes: {\n    modelId:               React.PropTypes.string.isRequired,\n    eventCollections:      React.PropTypes.array.isRequired,\n    steps:                 React.PropTypes.array.isRequired,\n    stepNotices:           React.PropTypes.array.isRequired,\n    onBrowseEvents:        React.PropTypes.func.isRequired,\n    getEventPropertyNames: React.PropTypes.func.isRequired,\n    getPropertyType:       React.PropTypes.func.isRequired\n  },\n\n  handleChange: function(index, name, value) {\n    var updates = {}\n    updates[name] = value;\n    ExplorerActions.updateStep(this.props.modelId, index, updates);\n  },\n\n  addStep: function(e) {\n    e.preventDefault();\n    ExplorerActions.addStep(this.props.modelId);\n  },\n\n  removeStep: function(index) {\n    ExplorerActions.removeStep(this.props.modelId, index);\n  },\n\n  handleAddFilter: function(index) {\n    ExplorerActions.addStepFilter(this.props.modelId, index);\n  },\n\n  handleRemoveFilter: function(stepIndex, filterIndex) {\n    ExplorerActions.removeStepFilter(this.props.modelId, stepIndex, filterIndex);\n  },\n\n  handleFilterChange: function(stepIndex, filterIndex, updates) {\n    ExplorerActions.updateStepFilter(this.props.modelId, stepIndex, filterIndex, updates);\n  },\n\n  toggleStepActive: function(index, active) {\n    if (active) {\n      ExplorerActions.setStepActive(this.props.modelId, index);\n    } else {\n      ExplorerActions.updateStep(this.props.modelId, index, { active: false });\n    }\n  },\n\n  moveStep: function(index, direction) {\n    ExplorerActions.moveStep(this.props.modelId, index, direction);\n  },\n\n  buildSteps: function() {\n    return this.props.steps.map(function(step, index) {\n      var notice = _.find(this.props.stepNotices, { stepIndex: index });\n      return (\n        <li key={index}>\n          <FunnelStep index={index}\n                      step={step}\n                      notice={notice}\n                      removeStep={this.removeStep}\n                      canRemove={this.props.steps.length > 1}\n                      eventCollections={this.props.eventCollections}\n                      propertyNames={this.props.getEventPropertyNames(step.event_collection)}\n                      onBrowseEvents={this.props.onBrowseEvents}\n                      toggleStepActive={this.toggleStepActive}\n                      handleChange={this.handleChange}\n                      handleAddFilter={this.handleAddFilter}\n                      handleRemoveFilter={this.handleRemoveFilter}\n                      handleFilterChange={this.handleFilterChange}\n                      getPropertyType={this.props.getPropertyType}\n                      handleFiltersToggle={this.handleFiltersToggle}\n                      moveStep={this.moveStep} />\n        </li>\n      );\n    }.bind(this));\n  },\n\n  render: function() {\n    return (\n      <div className=\"funnel-builder margin-top-small\">\n        <h4>Steps</h4>\n        <ul className=\"steps\">\n          {this.buildSteps()}\n        </ul>\n        <a href=\"#\" className=\"add-step\" onClick={this.addStep}>\n          <i className=\"icon glyphicon glyphicon-plus-sign margin-right-tiny\"></i>\n          Add a step\n        </a>\n      </div>\n    );\n  }\n\n});\n\nexport default FunnelsBuilder;\n","import React from 'react';\nimport _ from 'lodash';\nimport SelectField from '../select_field.js';\nimport Timeframe from '../../../common/timeframe.js';\nimport FieldsToggle from '../../../common/fields_toggle.js';\nimport Notice from '../../../common/notice.js';\nimport FilterManager from '../../../common/filter_manager.js';\nimport FilterUtils from '../../../../utils/FilterUtils.js';\nimport classNames from 'classnames';\n\nconst FunnelStep = React.createClass({\n\n  propTypes: {\n    index:                React.PropTypes.number.isRequired,\n    step:                 React.PropTypes.object.isRequired,\n    eventCollections:     React.PropTypes.array.isRequired,\n    propertyNames:        React.PropTypes.array.isRequired,\n    onBrowseEvents:       React.PropTypes.func.isRequired,\n    getPropertyType:      React.PropTypes.func.isRequired,\n    moveStep:             React.PropTypes.func.isRequired,\n    removeStep:           React.PropTypes.func.isRequired,\n    handleChange:         React.PropTypes.func.isRequired,\n    toggleStepActive:     React.PropTypes.func.isRequired,\n    handleFilterChange:   React.PropTypes.func.isRequired,\n    handleAddFilter:      React.PropTypes.func.isRequired,\n    handleRemoveFilter:   React.PropTypes.func.isRequired\n  },\n\n  removeStep: function(e) {\n    e.preventDefault();\n    if (this.props.canRemove && confirm(\"Are you sure you want to delete this funnel step?\")) {\n      this.props.removeStep(this.props.index);\n    }\n  },\n\n  handleChange: function(name, value) {\n    this.props.handleChange(this.props.index, name, value);\n  },\n\n  handleChangeWithEvent: function(e) {\n    e.preventDefault();\n    this.props.handleChange(this.props.index, e.target.name, e.target.value);\n  },\n\n  handleCheckboxChange: function(e) {\n    this.props.handleChange(this.props.index, e.target.name, e.target.checked);\n  },\n\n  toggleStepActive: function(e) {\n    this.props.toggleStepActive(this.props.index, !this.props.step.active);\n  },\n\n  handleFiltersToggle: function() {\n    this.refs['filter-manager'].open();\n  },\n\n  handleAddFilter: function() {\n    this.props.handleAddFilter(this.props.index);\n  },\n\n  handleRemoveFilter: function(filterIndex) {\n    this.props.handleRemoveFilter(this.props.index, filterIndex);\n  },\n\n  handleFilterChange: function(filterIndex, updates) {\n    this.props.handleFilterChange(this.props.index, filterIndex, updates);\n  },\n\n  moveStepUp: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.moveStep(this.props.index, 'up');\n  },\n\n  moveStepDown: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.moveStep(this.props.index, 'down');\n  },\n\n  buildStepBody: function() {\n    var remove, notice;\n\n    if (this.props.canRemove) {\n      remove = (\n        <a href=\"#\" className=\"remove-step\" onClick={this.removeStep}>\n          <i className=\"icon glyphicon glyphicon-remove-circle margin-right-tiny\"></i>\n          Remove Step\n        </a>\n      );\n    }\n    if (this.props.notice) {\n      notice = (<Notice notice={this.props.notice} closable={false} />);\n    }\n\n    if (this.props.step.active === true) {\n      return (\n        <div className=\"step-body margin-top-small margin-bottom-small\">\n          {notice}\n          <SelectField name=\"event_collection\"\n                       label=\"Event Collection\"\n                       value={this.props.step.event_collection}\n                       options={this.props.eventCollections}\n                       requiredLabel={true}\n                       onBrowseEvents={this.props.onBrowseEvents}\n                       handleChange={this.handleChange} />\n          <SelectField name=\"actor_property\"\n                       label=\"Actor Property\"\n                       value={this.props.step.actor_property}\n                       options={this.props.propertyNames}\n                       requiredLabel={true}\n                       handleChange={this.handleChange} />\n          <Timeframe ref=\"timeframe\"\n                     time={this.props.step.time}\n                     timezone={this.props.step.timezone}\n                     handleChange={this.handleChange}/>\n          <div className=\"field-component\">\n            <FieldsToggle ref=\"filters-fields-toggle\"\n                          name=\"Filters\"\n                          toggleCallback={this.handleFiltersToggle}\n                          fieldsCount={FilterUtils.validFilters(this.props.step.filters).length} />\n          </div>\n          <FilterManager ref=\"filter-manager\"\n                         eventCollection={this.props.step.event_collection}\n                         filters={this.props.step.filters}\n                         handleChange={this.handleFilterChange}\n                         removeFilter={this.handleRemoveFilter}\n                         addFilter={this.handleAddFilter}\n                         getPropertyType={this.props.getPropertyType}\n                         propertyNames={this.props.propertyNames} />\n          <label className=\"block-label margin-top-small\">\n            <input name=\"optional\" type=\"checkbox\" checked={this.props.step.optional} onChange={this.handleCheckboxChange} /> Optional Step\n          </label>\n          <label className=\"block-label\">\n            <input name=\"inverted\" type=\"checkbox\" checked={this.props.step.inverted} onChange={this.handleCheckboxChange} /> Inverted Step\n          </label>\n          <label className=\"block-label\">\n            <input name=\"with_actors\" type=\"checkbox\" checked={this.props.step.with_actors} onChange={this.handleCheckboxChange} /> With Actors\n          </label>\n\n          <hr />\n          {remove}\n        </div>\n      );\n    }\n  },\n\n  render: function() {\n    var stepWrapperClasses = classNames({\n      'funnel-step': true,\n      'active': this.props.step.active\n    });\n    return (\n      <div className={stepWrapperClasses}>\n        <div className=\"step-header clearfix\" onClick={this.toggleStepActive} role=\"step-header\">\n          <div className=\"step-move-btns\">\n            <a href=\"#\" className=\"up\" onClick={this.moveStepUp} role=\"move-step\">\n              <span className=\"arrow\"></span>\n            </a>\n            <a href=\"#\" className=\"down\" onClick={this.moveStepDown} role=\"move-step\">\n              <span className=\"arrow\"></span>\n            </a>\n          </div>\n          <div className=\"step-number\">\n            {this.props.index + 1}\n          </div>\n          <div className=\"step-name\">\n            Step {this.props.index + 1}\n          </div>\n        </div>\n        {this.buildStepBody()}\n      </div>\n    );\n  }\n\n});\n\nexport default FunnelStep;\n","import React from 'react';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport Datepicker from './datepicker.js';\nimport Timepicker from './timepicker.js';\n\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport ExplorerActions from '../../actions/ExplorerActions';\n\nconst dateFormat = 'll';\nconst timeFormat = 'h:mm A';\n\nconst AbsolutePicker = React.createClass({\n\n  setDate: function(name, value) {\n    var time = this.props.time;\n    var endValue = new Date(time.end);\n\n    var updates = _.cloneDeep(time);\n    if (name === 'start_date' && value > endValue) {\n      updates.end = '';\n    }\n    updates[name] = new Date(moment(new Date(value)).format(dateFormat) + \" \" + moment(time[name]).format(timeFormat));\n    this.props.handleChange('time', updates);\n  },\n\n  handleDateBlur: function (event) {\n    var name = event.target.name;\n    var value = event.target.value;\n    this.setDate(name, value);\n  },\n\n  setTime: function(name, value) {\n    var time = this.props.time;\n    var updates = _.cloneDeep(time);\n    updates[name] = new Date(moment(time[name]).format(dateFormat) + \" \" + moment(new Date(value)).format(timeFormat));\n    this.props.handleChange('time', updates);\n  },\n\n  // React methods\n\n  render: function() {\n    var time = this.props.time;\n\n    return (\n      <div className=\"absolute-timeframe-picker\">\n        <div className=\"row\">\n          <div className=\"col-xs-2\">\n            <label>Start</label>\n          </div>\n          <div className=\"col-xs-5 form-collapse-right\">\n            <Datepicker ref=\"start-date\"\n                        value={moment(time.start).format(dateFormat)}\n                        name=\"start\"\n                        placeholder=\"Date\"\n                        onBlur={this.handleDateBlur}\n                        onSet={this.setDate} />\n          </div>\n          <div className=\"col-xs-5 form-collapse-left\">\n            <Timepicker ref=\"start-time\"\n                        value={moment(time.start).format(timeFormat)}\n                        name=\"start\"\n                        placeholder=\"Time\"\n                        handleBlur={this.setTime}\n                        handleSelection={this.setTime} />\n          </div>\n        </div>\n        <div className=\"row\">\n          <div className=\"col-xs-2\">\n            <label>End</label>\n          </div>\n          <div className=\"col-xs-5 form-collapse-right\">\n            <Datepicker ref=\"end-date\"\n                        value={moment(time.end).format(dateFormat)}\n                        minimum={moment(time.start).format(dateFormat)}\n                        name=\"end\"\n                        placeholder=\"Date\"\n                        onBlur={this.handleDateBlur}\n                        onSet={this.setDate} />\n          </div>\n          <div className=\"col-xs-5 form-collapse-left\">\n            <Timepicker ref=\"end-time\"\n                        value={moment(time.end).format(timeFormat)}\n                        name=\"end\"\n                        placeholder=\"Time\"\n                        handleBlur={this.setTime}\n                        handleSelection={this.setTime} />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default AbsolutePicker;\n","\n/*!\n * Date picker for pickadate.js v3.5.4\n * http://amsul.github.io/pickadate.js/date.htm\n */\n\n(function ( factory ) {\n\n    // AMD.\n    if ( typeof define == 'function' && define.amd )\n        define( ['picker','jquery'], factory )\n\n    // Node.js/browserify.\n    else if ( typeof exports == 'object' )\n        module.exports = factory( require('./picker.js'), require('jquery') )\n\n    // Browser globals.\n    else factory( Picker, jQuery )\n\n}(function( Picker, $ ) {\n\n\n/**\n * Globals and constants\n */\nvar DAYS_IN_WEEK = 7,\n    WEEKS_IN_CALENDAR = 6,\n    _ = Picker._\n\n\n\n/**\n * The date picker constructor\n */\nfunction DatePicker( picker, settings ) {\n\n    var calendar = this,\n        element = picker.$node[ 0 ],\n        elementValue = element.value,\n        elementDataValue = picker.$node.data( 'value' ),\n        valueString = elementDataValue || elementValue,\n        formatString = elementDataValue ? settings.formatSubmit : settings.format,\n        isRTL = function() {\n\n            return element.currentStyle ?\n\n                // For IE.\n                element.currentStyle.direction == 'rtl' :\n\n                // For normal browsers.\n                getComputedStyle( picker.$root[0] ).direction == 'rtl'\n        }\n\n    calendar.settings = settings\n    calendar.$node = picker.$node\n\n    // The queue of methods that will be used to build item objects.\n    calendar.queue = {\n        min: 'measure create',\n        max: 'measure create',\n        now: 'now create',\n        select: 'parse create validate',\n        highlight: 'parse navigate create validate',\n        view: 'parse create validate viewset',\n        disable: 'deactivate',\n        enable: 'activate'\n    }\n\n    // The component's item object.\n    calendar.item = {}\n\n    calendar.item.clear = null\n    calendar.item.disable = ( settings.disable || [] ).slice( 0 )\n    calendar.item.enable = -(function( collectionDisabled ) {\n        return collectionDisabled[ 0 ] === true ? collectionDisabled.shift() : -1\n    })( calendar.item.disable )\n\n    calendar.\n        set( 'min', settings.min ).\n        set( 'max', settings.max ).\n        set( 'now' )\n\n    // When theres a value, set the `select`, which in turn\n    // also sets the `highlight` and `view`.\n    if ( valueString ) {\n        calendar.set( 'select', valueString, { format: formatString })\n    }\n\n    // If theres no value, default to highlighting today.\n    else {\n        calendar.\n            set( 'select', null ).\n            set( 'highlight', calendar.item.now )\n    }\n\n\n    // The keycode to movement mapping.\n    calendar.key = {\n        40: 7, // Down\n        38: -7, // Up\n        39: function() { return isRTL() ? -1 : 1 }, // Right\n        37: function() { return isRTL() ? 1 : -1 }, // Left\n        go: function( timeChange ) {\n            var highlightedObject = calendar.item.highlight,\n                targetDate = new Date( Date.UTC(highlightedObject.year, highlightedObject.month, highlightedObject.date + timeChange) )\n            calendar.set(\n                'highlight',\n                targetDate,\n                { interval: timeChange }\n            )\n            this.render()\n        }\n    }\n\n\n    // Bind some picker events.\n    picker.\n        on( 'render', function() {\n            picker.$root.find( '.' + settings.klass.selectMonth ).on( 'change', function() {\n                var value = this.value\n                if ( value ) {\n                    picker.set( 'highlight', [ picker.get( 'view' ).year, value, picker.get( 'highlight' ).date ] )\n                    picker.$root.find( '.' + settings.klass.selectMonth ).trigger( 'focus' )\n                }\n            })\n            picker.$root.find( '.' + settings.klass.selectYear ).on( 'change', function() {\n                var value = this.value\n                if ( value ) {\n                    picker.set( 'highlight', [ value, picker.get( 'view' ).month, picker.get( 'highlight' ).date ] )\n                    picker.$root.find( '.' + settings.klass.selectYear ).trigger( 'focus' )\n                }\n            })\n        }, 1 ).\n        on( 'open', function() {\n            var includeToday = ''\n            if ( calendar.disabled( calendar.get('now') ) ) {\n                includeToday = ':not(.' + settings.klass.buttonToday + ')'\n            }\n            picker.$root.find( 'button' + includeToday + ', select' ).attr( 'disabled', false )\n        }, 1 ).\n        on( 'close', function() {\n            picker.$root.find( 'button, select' ).attr( 'disabled', true )\n        }, 1 )\n\n} //DatePicker\n\n\n/**\n * Set a datepicker item object.\n */\nDatePicker.prototype.set = function( type, value, options ) {\n\n    var calendar = this,\n        calendarItem = calendar.item\n\n    // If the value is `null` just set it immediately.\n    if ( value === null ) {\n        if ( type == 'clear' ) type = 'select'\n        calendarItem[ type ] = value\n        return calendar\n    }\n\n    // Otherwise go through the queue of methods, and invoke the functions.\n    // Update this as the time unit, and set the final value as this item.\n    // * In the case of `enable`, keep the queue but set `disable` instead.\n    //   And in the case of `flip`, keep the queue but set `enable` instead.\n    calendarItem[ ( type == 'enable' ? 'disable' : type == 'flip' ? 'enable' : type ) ] = calendar.queue[ type ].split( ' ' ).map( function( method ) {\n        value = calendar[ method ]( type, value, options )\n        return value\n    }).pop()\n\n    // Check if we need to cascade through more updates.\n    if ( type == 'select' ) {\n        calendar.set( 'highlight', calendarItem.select, options )\n    }\n    else if ( type == 'highlight' ) {\n        calendar.set( 'view', calendarItem.highlight, options )\n    }\n    else if ( type.match( /^(flip|min|max|disable|enable)$/ ) ) {\n        if ( calendarItem.select && calendar.disabled( calendarItem.select ) ) {\n            calendar.set( 'select', calendarItem.select, options )\n        }\n        if ( calendarItem.highlight && calendar.disabled( calendarItem.highlight ) ) {\n            calendar.set( 'highlight', calendarItem.highlight, options )\n        }\n    }\n\n    return calendar\n} //DatePicker.prototype.set\n\n\n/**\n * Get a datepicker item object.\n */\nDatePicker.prototype.get = function( type ) {\n    return this.item[ type ]\n} //DatePicker.prototype.get\n\n\n/**\n * Create a picker date object.\n */\nDatePicker.prototype.create = function( type, value, options ) {\n\n    var isInfiniteValue,\n        calendar = this\n\n    // If theres no value, use the type as the value.\n    value = value === undefined ? type : value\n\n\n    // If its infinity, update the value.\n    if ( value == -Infinity || value == Infinity ) {\n        isInfiniteValue = value\n    }\n\n    // If its an object, use the native date object.\n    else if ( $.isPlainObject( value ) && _.isInteger( value.pick ) ) {\n        value = value.obj\n    }\n\n    // If its an array, convert it into a date and make sure\n    // that its a valid date  otherwise default to today.\n    else if ( $.isArray( value ) ) {\n        value = new Date(Date.UTC(value[ 0 ], value[ 1 ], value[ 2 ] ))\n        value = _.isDate( value ) ? value : calendar.create().obj\n    }\n\n    // If its a number, make a normalized date.\n    else if ( _.isInteger( value ) ) {\n        value = calendar.normalize( new Date( value ), options )\n    }\n\n    // If its a date object, make a normalized date.\n    else if ( _.isDate( value ) ) {\n        value = calendar.normalize( value, options )\n    }\n\n    // If its a literal true or any other case, set it to now.\n    else /*if ( value === true )*/ {\n        value = calendar.now( type, value, options )\n    }\n\n    // Return the compiled object.\n    return {\n        year: isInfiniteValue || value.getUTCFullYear(),\n        month: isInfiniteValue || value.getUTCMonth(),\n        date: isInfiniteValue || value.getUTCDate(),\n        day: isInfiniteValue || value.getUTCDay(),\n        obj: isInfiniteValue || value,\n        pick: isInfiniteValue || value.getTime()\n    }\n} //DatePicker.prototype.create\n\n\n/**\n * Create a range limit object using an array, date object,\n * literal true, or integer relative to another time.\n */\nDatePicker.prototype.createRange = function( from, to ) {\n\n    var calendar = this,\n        createDate = function( date ) {\n            if ( date === true || $.isArray( date ) || _.isDate( date ) ) {\n                return calendar.create( date )\n            }\n            return date\n        }\n\n    // Create objects if possible.\n    if ( !_.isInteger( from ) ) {\n        from = createDate( from )\n    }\n    if ( !_.isInteger( to ) ) {\n        to = createDate( to )\n    }\n\n    // Create relative dates.\n    if ( _.isInteger( from ) && $.isPlainObject( to ) ) {\n        from = [ to.year, to.month, to.date + from ];\n    }\n    else if ( _.isInteger( to ) && $.isPlainObject( from ) ) {\n        to = [ from.year, from.month, from.date + to ];\n    }\n\n    return {\n        from: createDate( from ),\n        to: createDate( to )\n    }\n} //DatePicker.prototype.createRange\n\n\n/**\n * Check if a date unit falls within a date range object.\n */\nDatePicker.prototype.withinRange = function( range, dateUnit ) {\n    range = this.createRange(range.from, range.to)\n    return dateUnit.pick >= range.from.pick && dateUnit.pick <= range.to.pick\n}\n\n\n/**\n * Check if two date range objects overlap.\n */\nDatePicker.prototype.overlapRanges = function( one, two ) {\n\n    var calendar = this\n\n    // Convert the ranges into comparable dates.\n    one = calendar.createRange( one.from, one.to )\n    two = calendar.createRange( two.from, two.to )\n\n    return calendar.withinRange( one, two.from ) || calendar.withinRange( one, two.to ) ||\n        calendar.withinRange( two, one.from ) || calendar.withinRange( two, one.to )\n}\n\n\n/**\n * Get the date today.\n */\nDatePicker.prototype.now = function( type, value, options ) {\n    value = new Date()\n    if ( options && options.rel ) {\n        value.setUTCDate( value.getUTCDate() + options.rel )\n    }\n    return this.normalize( value, options )\n}\n\n\n/**\n * Navigate to next/prev month.\n */\nDatePicker.prototype.navigate = function( type, value, options ) {\n\n    var targetDateObject,\n        targetYear,\n        targetMonth,\n        targetDate,\n        isTargetArray = $.isArray( value ),\n        isTargetObject = $.isPlainObject( value ),\n        viewsetObject = this.item.view/*,\n        safety = 100*/\n\n\n    if ( isTargetArray || isTargetObject ) {\n\n        if ( isTargetObject ) {\n            targetYear = value.year\n            targetMonth = value.month\n            targetDate = value.date\n        }\n        else {\n            targetYear = +value[0]\n            targetMonth = +value[1]\n            targetDate = +value[2]\n        }\n\n        // If were navigating months but the view is in a different\n        // month, navigate to the views year and month.\n        if ( options && options.nav && viewsetObject && viewsetObject.month !== targetMonth ) {\n            targetYear = viewsetObject.year\n            targetMonth = viewsetObject.month\n        }\n\n        // Figure out the expected target year and month.\n        targetDateObject = new Date( Date.UTC( targetYear, targetMonth + ( options && options.nav ? options.nav : 0 ), 1 ) )\n        targetYear = targetDateObject.getUTCFullYear()\n        targetMonth = targetDateObject.getUTCMonth()\n\n        // If the month were going to doesnt have enough days,\n        // keep decreasing the date until we reach the months last date.\n        while ( /*safety &&*/ new Date( Date.UTC( targetYear, targetMonth, targetDate ) ).getUTCMonth() !== targetMonth ) {\n            targetDate -= 1\n            /*safety -= 1\n            if ( !safety ) {\n                throw 'Fell into an infinite loop while navigating to ' + new Date( targetYear, targetMonth, targetDate ) + '.'\n            }*/\n        }\n\n        value = [ targetYear, targetMonth, targetDate ]\n    }\n\n    return value\n} //DatePicker.prototype.navigate\n\n\n/**\n * Normalize a date by setting the hours to midnight.\n */\nDatePicker.prototype.normalize = function( value/*, options*/ ) {\n    value.setUTCHours( 0, 0, 0, 0 )\n    return value\n}\n\n\n/**\n * Measure the range of dates.\n */\nDatePicker.prototype.measure = function( type, value/*, options*/ ) {\n\n    var calendar = this\n\n    // If its anything false-y, remove the limits.\n    if ( !value ) {\n        value = type == 'min' ? -Infinity : Infinity\n    }\n\n    // If its a string, parse it.\n    else if ( typeof value == 'string' ) {\n        value = calendar.parse( type, value )\n    }\n\n    // If it's an integer, get a date relative to today.\n    else if ( _.isInteger( value ) ) {\n        value = calendar.now( type, value, { rel: value } )\n    }\n\n    return value\n} ///DatePicker.prototype.measure\n\n\n/**\n * Create a viewset object based on navigation.\n */\nDatePicker.prototype.viewset = function( type, dateObject/*, options*/ ) {\n    return this.create([ dateObject.year, dateObject.month, 1 ])\n}\n\n\n/**\n * Validate a date as enabled and shift if needed.\n */\nDatePicker.prototype.validate = function( type, dateObject, options ) {\n\n    var calendar = this,\n\n        // Keep a reference to the original date.\n        originalDateObject = dateObject,\n\n        // Make sure we have an interval.\n        interval = options && options.interval ? options.interval : 1,\n\n        // Check if the calendar enabled dates are inverted.\n        isFlippedBase = calendar.item.enable === -1,\n\n        // Check if we have any enabled dates after/before now.\n        hasEnabledBeforeTarget, hasEnabledAfterTarget,\n\n        // The min & max limits.\n        minLimitObject = calendar.item.min,\n        maxLimitObject = calendar.item.max,\n\n        // Check if weve reached the limit during shifting.\n        reachedMin, reachedMax,\n\n        // Check if the calendar is inverted and at least one weekday is enabled.\n        hasEnabledWeekdays = isFlippedBase && calendar.item.disable.filter( function( value ) {\n\n            // If theres a date, check where it is relative to the target.\n            if ( $.isArray( value ) ) {\n                var dateTime = calendar.create( value ).pick\n                if ( dateTime < dateObject.pick ) hasEnabledBeforeTarget = true\n                else if ( dateTime > dateObject.pick ) hasEnabledAfterTarget = true\n            }\n\n            // Return only integers for enabled weekdays.\n            return _.isInteger( value )\n        }).length/*,\n\n        safety = 100*/\n\n\n\n    // Cases to validate for:\n    // [1] Not inverted and date disabled.\n    // [2] Inverted and some dates enabled.\n    // [3] Not inverted and out of range.\n    //\n    // Cases to **not** validate for:\n    //  Navigating months.\n    //  Not inverted and date enabled.\n    //  Inverted and all dates disabled.\n    //  ..and anything else.\n    if ( !options || !options.nav ) if (\n        /* 1 */ ( !isFlippedBase && calendar.disabled( dateObject ) ) ||\n        /* 2 */ ( isFlippedBase && calendar.disabled( dateObject ) && ( hasEnabledWeekdays || hasEnabledBeforeTarget || hasEnabledAfterTarget ) ) ||\n        /* 3 */ ( !isFlippedBase && (dateObject.pick <= minLimitObject.pick || dateObject.pick >= maxLimitObject.pick) )\n    ) {\n\n\n        // When inverted, flip the direction if there arent any enabled weekdays\n        // and there are no enabled dates in the direction of the interval.\n        if ( isFlippedBase && !hasEnabledWeekdays && ( ( !hasEnabledAfterTarget && interval > 0 ) || ( !hasEnabledBeforeTarget && interval < 0 ) ) ) {\n            interval *= -1\n        }\n\n\n        // Keep looping until we reach an enabled date.\n        while ( /*safety &&*/ calendar.disabled( dateObject ) ) {\n\n            /*safety -= 1\n            if ( !safety ) {\n                throw 'Fell into an infinite loop while validating ' + dateObject.obj + '.'\n            }*/\n\n\n            // If weve looped into the next/prev month with a large interval, return to the original date and flatten the interval.\n            if ( Math.abs( interval ) > 1 && ( dateObject.month < originalDateObject.month || dateObject.month > originalDateObject.month ) ) {\n                dateObject = originalDateObject\n                interval = interval > 0 ? 1 : -1\n            }\n\n\n            // If weve reached the min/max limit, reverse the direction, flatten the interval and set it to the limit.\n            if ( dateObject.pick <= minLimitObject.pick ) {\n                reachedMin = true\n                interval = 1\n                dateObject = calendar.create([\n                    minLimitObject.year,\n                    minLimitObject.month,\n                    minLimitObject.date + (dateObject.pick === minLimitObject.pick ? 0 : -1)\n                ])\n            }\n            else if ( dateObject.pick >= maxLimitObject.pick ) {\n                reachedMax = true\n                interval = -1\n                dateObject = calendar.create([\n                    maxLimitObject.year,\n                    maxLimitObject.month,\n                    maxLimitObject.date + (dateObject.pick === maxLimitObject.pick ? 0 : 1)\n                ])\n            }\n\n\n            // If weve reached both limits, just break out of the loop.\n            if ( reachedMin && reachedMax ) {\n                break\n            }\n\n\n            // Finally, create the shifted date using the interval and keep looping.\n            dateObject = calendar.create([ dateObject.year, dateObject.month, dateObject.date + interval ])\n        }\n\n    } //endif\n\n\n    // Return the date object settled on.\n    return dateObject\n} //DatePicker.prototype.validate\n\n\n/**\n * Check if a date is disabled.\n */\nDatePicker.prototype.disabled = function( dateToVerify ) {\n\n    var\n        calendar = this,\n\n        // Filter through the disabled dates to check if this is one.\n        isDisabledMatch = calendar.item.disable.filter( function( dateToDisable ) {\n\n            // If the date is a number, match the weekday with 0index and `firstDay` check.\n            if ( _.isInteger( dateToDisable ) ) {\n                return dateToVerify.day === ( calendar.settings.firstDay ? dateToDisable : dateToDisable - 1 ) % 7\n            }\n\n            // If its an array or a native JS date, create and match the exact date.\n            if ( $.isArray( dateToDisable ) || _.isDate( dateToDisable ) ) {\n                return dateToVerify.pick === calendar.create( dateToDisable ).pick\n            }\n\n            // If its an object, match a date within the from and to range.\n            if ( $.isPlainObject( dateToDisable ) ) {\n                return calendar.withinRange( dateToDisable, dateToVerify )\n            }\n        })\n\n    // If this date matches a disabled date, confirm its not inverted.\n    isDisabledMatch = isDisabledMatch.length && !isDisabledMatch.filter(function( dateToDisable ) {\n        return $.isArray( dateToDisable ) && dateToDisable[3] == 'inverted' ||\n            $.isPlainObject( dateToDisable ) && dateToDisable.inverted\n    }).length\n\n    // Check the calendar enabled flag and respectively flip the\n    // disabled state. Then also check if its beyond the min/max limits.\n    return calendar.item.enable === -1 ? !isDisabledMatch : isDisabledMatch ||\n        dateToVerify.pick < calendar.item.min.pick ||\n        dateToVerify.pick > calendar.item.max.pick\n\n} //DatePicker.prototype.disabled\n\n\n/**\n * Parse a string into a usable type.\n */\nDatePicker.prototype.parse = function( type, value, options ) {\n\n    var calendar = this,\n        parsingObject = {}\n\n    // If its already parsed, were good.\n    if ( !value || typeof value != 'string' ) {\n        return value\n    }\n\n    // We need a `.format` to parse the value with.\n    if ( !( options && options.format ) ) {\n        options = options || {}\n        options.format = calendar.settings.format\n    }\n\n    // Convert the format into an array and then map through it.\n    calendar.formats.toArray( options.format ).map( function( label ) {\n\n        var\n            // Grab the formatting label.\n            formattingLabel = calendar.formats[ label ],\n\n            // The format length is from the formatting label function or the\n            // label length without the escaping exclamation (!) mark.\n            formatLength = formattingLabel ? _.trigger( formattingLabel, calendar, [ value, parsingObject ] ) : label.replace( /^!/, '' ).length\n\n        // If there's a format label, split the value up to the format length.\n        // Then add it to the parsing object with appropriate label.\n        if ( formattingLabel ) {\n            parsingObject[ label ] = value.substr( 0, formatLength )\n        }\n\n        // Update the value as the substring from format length to end.\n        value = value.substr( formatLength )\n    })\n\n    // Compensate for month 0index.\n    return [\n        parsingObject.yyyy || parsingObject.yy,\n        +( parsingObject.mm || parsingObject.m ) - 1,\n        parsingObject.dd || parsingObject.d\n    ]\n} //DatePicker.prototype.parse\n\n\n/**\n * Various formats to display the object in.\n */\nDatePicker.prototype.formats = (function() {\n\n    // Return the length of the first word in a collection.\n    function getWordLengthFromCollection( string, collection, dateObject ) {\n\n        // Grab the first word from the string.\n        var word = string.match( /\\w+/ )[ 0 ]\n\n        // If there's no month index, add it to the date object\n        if ( !dateObject.mm && !dateObject.m ) {\n            dateObject.m = collection.indexOf( word ) + 1\n        }\n\n        // Return the length of the word.\n        return word.length\n    }\n\n    // Get the length of the first word in a string.\n    function getFirstWordLength( string ) {\n        return string.match( /\\w+/ )[ 0 ].length\n    }\n\n    return {\n\n        d: function( string, dateObject ) {\n\n            // If there's string, then get the digits length.\n            // Otherwise return the selected date.\n            return string ? _.digits( string ) : dateObject.date\n        },\n        dd: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 2.\n            // Otherwise return the selected date with a leading zero.\n            return string ? 2 : _.lead( dateObject.date )\n        },\n        ddd: function( string, dateObject ) {\n\n            // If there's a string, then get the length of the first word.\n            // Otherwise return the short selected weekday.\n            return string ? getFirstWordLength( string ) : this.settings.weekdaysShort[ dateObject.day ]\n        },\n        dddd: function( string, dateObject ) {\n\n            // If there's a string, then get the length of the first word.\n            // Otherwise return the full selected weekday.\n            return string ? getFirstWordLength( string ) : this.settings.weekdaysFull[ dateObject.day ]\n        },\n        m: function( string, dateObject ) {\n\n            // If there's a string, then get the length of the digits\n            // Otherwise return the selected month with 0index compensation.\n            return string ? _.digits( string ) : dateObject.month + 1\n        },\n        mm: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 2.\n            // Otherwise return the selected month with 0index and leading zero.\n            return string ? 2 : _.lead( dateObject.month + 1 )\n        },\n        mmm: function( string, dateObject ) {\n\n            var collection = this.settings.monthsShort\n\n            // If there's a string, get length of the relevant month from the short\n            // months collection. Otherwise return the selected month from that collection.\n            return string ? getWordLengthFromCollection( string, collection, dateObject ) : collection[ dateObject.month ]\n        },\n        mmmm: function( string, dateObject ) {\n\n            var collection = this.settings.monthsFull\n\n            // If there's a string, get length of the relevant month from the full\n            // months collection. Otherwise return the selected month from that collection.\n            return string ? getWordLengthFromCollection( string, collection, dateObject ) : collection[ dateObject.month ]\n        },\n        yy: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 2.\n            // Otherwise return the selected year by slicing out the first 2 digits.\n            return string ? 2 : ( '' + dateObject.year ).slice( 2 )\n        },\n        yyyy: function( string, dateObject ) {\n\n            // If there's a string, then the length is always 4.\n            // Otherwise return the selected year.\n            return string ? 4 : dateObject.year\n        },\n\n        // Create an array by splitting the formatting string passed.\n        toArray: function( formatString ) { return formatString.split( /(d{1,4}|m{1,4}|y{4}|yy|!.)/g ) },\n\n        // Format an object into a string using the formatting options.\n        toString: function ( formatString, itemObject ) {\n            var calendar = this\n            return calendar.formats.toArray( formatString ).map( function( label ) {\n                return _.trigger( calendar.formats[ label ], calendar, [ 0, itemObject ] ) || label.replace( /^!/, '' )\n            }).join( '' )\n        }\n    }\n})() //DatePicker.prototype.formats\n\n\n\n\n/**\n * Check if two date units are the exact.\n */\nDatePicker.prototype.isDateExact = function( one, two ) {\n\n    var calendar = this\n\n    // When were working with weekdays, do a direct comparison.\n    if (\n        ( _.isInteger( one ) && _.isInteger( two ) ) ||\n        ( typeof one == 'boolean' && typeof two == 'boolean' )\n     ) {\n        return one === two\n    }\n\n    // When were working with date representations, compare the pick value.\n    if (\n        ( _.isDate( one ) || $.isArray( one ) ) &&\n        ( _.isDate( two ) || $.isArray( two ) )\n    ) {\n        return calendar.create( one ).pick === calendar.create( two ).pick\n    }\n\n    // When were working with range objects, compare the from and to.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return calendar.isDateExact( one.from, two.from ) && calendar.isDateExact( one.to, two.to )\n    }\n\n    return false\n}\n\n\n/**\n * Check if two date units overlap.\n */\nDatePicker.prototype.isDateOverlap = function( one, two ) {\n\n    var calendar = this,\n        firstDay = calendar.settings.firstDay ? 1 : 0\n\n    // When were working with a weekday index, compare the days.\n    if ( _.isInteger( one ) && ( _.isDate( two ) || $.isArray( two ) ) ) {\n        one = one % 7 + firstDay\n        return one === calendar.create( two ).day + 1\n    }\n    if ( _.isInteger( two ) && ( _.isDate( one ) || $.isArray( one ) ) ) {\n        two = two % 7 + firstDay\n        return two === calendar.create( one ).day + 1\n    }\n\n    // When were working with range objects, check if the ranges overlap.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return calendar.overlapRanges( one, two )\n    }\n\n    return false\n}\n\n\n/**\n * Flip the enabled state.\n */\nDatePicker.prototype.flipEnable = function(val) {\n    var itemObject = this.item\n    itemObject.enable = val || (itemObject.enable == -1 ? 1 : -1)\n}\n\n\n/**\n * Mark a collection of dates as disabled.\n */\nDatePicker.prototype.deactivate = function( type, datesToDisable ) {\n\n    var calendar = this,\n        disabledItems = calendar.item.disable.slice(0)\n\n\n    // If were flipping, thats all we need to do.\n    if ( datesToDisable == 'flip' ) {\n        calendar.flipEnable()\n    }\n\n    else if ( datesToDisable === false ) {\n        calendar.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( datesToDisable === true ) {\n        calendar.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the dates to disable.\n    else {\n\n        datesToDisable.map(function( unitToDisable ) {\n\n            var matchFound\n\n            // When we have disabled items, check for matches.\n            // If something is matched, immediately break out.\n            for ( var index = 0; index < disabledItems.length; index += 1 ) {\n                if ( calendar.isDateExact( unitToDisable, disabledItems[index] ) ) {\n                    matchFound = true\n                    break\n                }\n            }\n\n            // If nothing was found, add the validated unit to the collection.\n            if ( !matchFound ) {\n                if (\n                    _.isInteger( unitToDisable ) ||\n                    _.isDate( unitToDisable ) ||\n                    $.isArray( unitToDisable ) ||\n                    ( $.isPlainObject( unitToDisable ) && unitToDisable.from && unitToDisable.to )\n                ) {\n                    disabledItems.push( unitToDisable )\n                }\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems\n} //DatePicker.prototype.deactivate\n\n\n/**\n * Mark a collection of dates as enabled.\n */\nDatePicker.prototype.activate = function( type, datesToEnable ) {\n\n    var calendar = this,\n        disabledItems = calendar.item.disable,\n        disabledItemsCount = disabledItems.length\n\n    // If were flipping, thats all we need to do.\n    if ( datesToEnable == 'flip' ) {\n        calendar.flipEnable()\n    }\n\n    else if ( datesToEnable === true ) {\n        calendar.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( datesToEnable === false ) {\n        calendar.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the disabled dates.\n    else {\n\n        datesToEnable.map(function( unitToEnable ) {\n\n            var matchFound,\n                disabledUnit,\n                index,\n                isExactRange\n\n            // Go through the disabled items and try to find a match.\n            for ( index = 0; index < disabledItemsCount; index += 1 ) {\n\n                disabledUnit = disabledItems[index]\n\n                // When an exact match is found, remove it from the collection.\n                if ( calendar.isDateExact( disabledUnit, unitToEnable ) ) {\n                    matchFound = disabledItems[index] = null\n                    isExactRange = true\n                    break\n                }\n\n                // When an overlapped match is found, add the inverted state to it.\n                else if ( calendar.isDateOverlap( disabledUnit, unitToEnable ) ) {\n                    if ( $.isPlainObject( unitToEnable ) ) {\n                        unitToEnable.inverted = true\n                        matchFound = unitToEnable\n                    }\n                    else if ( $.isArray( unitToEnable ) ) {\n                        matchFound = unitToEnable\n                        if ( !matchFound[3] ) matchFound.push( 'inverted' )\n                    }\n                    else if ( _.isDate( unitToEnable ) ) {\n                        matchFound = [ unitToEnable.getUTCFullYear(), unitToEnable.getUTCMonth(), unitToEnable.getUTCDate(), 'inverted' ]\n                    }\n                    break\n                }\n            }\n\n            // If a match was found, remove a previous duplicate entry.\n            if ( matchFound ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( calendar.isDateExact( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // In the event that were dealing with an exact range of dates,\n            // make sure there are no inverted dates because of it.\n            if ( isExactRange ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( calendar.isDateOverlap( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // If something is still matched, add it into the collection.\n            if ( matchFound ) {\n                disabledItems.push( matchFound )\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems.filter(function( val ) { return val != null })\n} //DatePicker.prototype.activate\n\n\n/**\n * Create a string for the nodes in the picker.\n */\nDatePicker.prototype.nodes = function( isOpen ) {\n\n    var\n        calendar = this,\n        settings = calendar.settings,\n        calendarItem = calendar.item,\n        nowObject = calendarItem.now,\n        selectedObject = calendarItem.select,\n        highlightedObject = calendarItem.highlight,\n        viewsetObject = calendarItem.view,\n        disabledCollection = calendarItem.disable,\n        minLimitObject = calendarItem.min,\n        maxLimitObject = calendarItem.max,\n\n\n        // Create the calendar table head using a copy of weekday labels collection.\n        // * We do a copy so we don't mutate the original array.\n        tableHead = (function( collection, fullCollection ) {\n\n            // If the first day should be Monday, move Sunday to the end.\n            if ( settings.firstDay ) {\n                collection.push( collection.shift() )\n                fullCollection.push( fullCollection.shift() )\n            }\n\n            // Create and return the table head group.\n            return _.node(\n                'thead',\n                _.node(\n                    'tr',\n                    _.group({\n                        min: 0,\n                        max: DAYS_IN_WEEK - 1,\n                        i: 1,\n                        node: 'th',\n                        item: function( counter ) {\n                            return [\n                                collection[ counter ],\n                                settings.klass.weekdays,\n                                'scope=col title=\"' + fullCollection[ counter ] + '\"'\n                            ]\n                        }\n                    })\n                )\n            ) //endreturn\n        })( ( settings.showWeekdaysFull ? settings.weekdaysFull : settings.weekdaysShort ).slice( 0 ), settings.weekdaysFull.slice( 0 ) ), //tableHead\n\n\n        // Create the nav for next/prev month.\n        createMonthNav = function( next ) {\n\n            // Otherwise, return the created month tag.\n            return _.node(\n                'div',\n                ' ',\n                settings.klass[ 'nav' + ( next ? 'Next' : 'Prev' ) ] + (\n\n                    // If the focused month is outside the range, disabled the button.\n                    ( next && viewsetObject.year >= maxLimitObject.year && viewsetObject.month >= maxLimitObject.month ) ||\n                    ( !next && viewsetObject.year <= minLimitObject.year && viewsetObject.month <= minLimitObject.month ) ?\n                    ' ' + settings.klass.navDisabled : ''\n                ),\n                'data-nav=' + ( next || -1 ) + ' ' +\n                _.ariaAttr({\n                    role: 'button',\n                    controls: calendar.$node[0].id + '_table'\n                }) + ' ' +\n                'title=\"' + (next ? settings.labelMonthNext : settings.labelMonthPrev ) + '\"'\n            ) //endreturn\n        }, //createMonthNav\n\n\n        // Create the month label.\n        createMonthLabel = function() {\n\n            var monthsCollection = settings.showMonthsShort ? settings.monthsShort : settings.monthsFull\n\n            // If there are months to select, add a dropdown menu.\n            if ( settings.selectMonths ) {\n\n                return _.node( 'select',\n                    _.group({\n                        min: 0,\n                        max: 11,\n                        i: 1,\n                        node: 'option',\n                        item: function( loopedMonth ) {\n\n                            return [\n\n                                // The looped month and no classes.\n                                monthsCollection[ loopedMonth ], 0,\n\n                                // Set the value and selected index.\n                                'value=' + loopedMonth +\n                                ( viewsetObject.month == loopedMonth ? ' selected' : '' ) +\n                                (\n                                    (\n                                        ( viewsetObject.year == minLimitObject.year && loopedMonth < minLimitObject.month ) ||\n                                        ( viewsetObject.year == maxLimitObject.year && loopedMonth > maxLimitObject.month )\n                                    ) ?\n                                    ' disabled' : ''\n                                )\n                            ]\n                        }\n                    }),\n                    settings.klass.selectMonth,\n                    ( isOpen ? '' : 'disabled' ) + ' ' +\n                    _.ariaAttr({ controls: calendar.$node[0].id + '_table' }) + ' ' +\n                    'title=\"' + settings.labelMonthSelect + '\"'\n                )\n            }\n\n            // If there's a need for a month selector\n            return _.node( 'div', monthsCollection[ viewsetObject.month ], settings.klass.month )\n        }, //createMonthLabel\n\n\n        // Create the year label.\n        createYearLabel = function() {\n\n            var focusedYear = viewsetObject.year,\n\n            // If years selector is set to a literal \"true\", set it to 5. Otherwise\n            // divide in half to get half before and half after focused year.\n            numberYears = settings.selectYears === true ? 5 : ~~( settings.selectYears / 2 )\n\n            // If there are years to select, add a dropdown menu.\n            if ( numberYears ) {\n\n                var\n                    minYear = minLimitObject.year,\n                    maxYear = maxLimitObject.year,\n                    lowestYear = focusedYear - numberYears,\n                    highestYear = focusedYear + numberYears\n\n                // If the min year is greater than the lowest year, increase the highest year\n                // by the difference and set the lowest year to the min year.\n                if ( minYear > lowestYear ) {\n                    highestYear += minYear - lowestYear\n                    lowestYear = minYear\n                }\n\n                // If the max year is less than the highest year, decrease the lowest year\n                // by the lower of the two: available and needed years. Then set the\n                // highest year to the max year.\n                if ( maxYear < highestYear ) {\n\n                    var availableYears = lowestYear - minYear,\n                        neededYears = highestYear - maxYear\n\n                    lowestYear -= availableYears > neededYears ? neededYears : availableYears\n                    highestYear = maxYear\n                }\n\n                return _.node( 'select',\n                    _.group({\n                        min: lowestYear,\n                        max: highestYear,\n                        i: 1,\n                        node: 'option',\n                        item: function( loopedYear ) {\n                            return [\n\n                                // The looped year and no classes.\n                                loopedYear, 0,\n\n                                // Set the value and selected index.\n                                'value=' + loopedYear + ( focusedYear == loopedYear ? ' selected' : '' )\n                            ]\n                        }\n                    }),\n                    settings.klass.selectYear,\n                    ( isOpen ? '' : 'disabled' ) + ' ' + _.ariaAttr({ controls: calendar.$node[0].id + '_table' }) + ' ' +\n                    'title=\"' + settings.labelYearSelect + '\"'\n                )\n            }\n\n            // Otherwise just return the year focused\n            return _.node( 'div', focusedYear, settings.klass.year )\n        } //createYearLabel\n\n\n    // Create and return the entire calendar.\n    return _.node(\n        'div',\n        ( settings.selectYears ? createYearLabel() + createMonthLabel() : createMonthLabel() + createYearLabel() ) +\n        createMonthNav() + createMonthNav( 1 ),\n        settings.klass.header\n    ) + _.node(\n        'table',\n        tableHead +\n        _.node(\n            'tbody',\n            _.group({\n                min: 0,\n                max: WEEKS_IN_CALENDAR - 1,\n                i: 1,\n                node: 'tr',\n                item: function( rowCounter ) {\n\n                    // If Monday is the first day and the month starts on Sunday, shift the date back a week.\n                    var shiftDateBy = settings.firstDay && calendar.create([ viewsetObject.year, viewsetObject.month, 1 ]).day === 0 ? -7 : 0\n\n                    return [\n                        _.group({\n                            min: DAYS_IN_WEEK * rowCounter - viewsetObject.day + shiftDateBy + 1, // Add 1 for weekday 0index\n                            max: function() {\n                                return this.min + DAYS_IN_WEEK - 1\n                            },\n                            i: 1,\n                            node: 'td',\n                            item: function( targetDate ) {\n\n                                // Convert the time date from a relative date to a target date.\n                                targetDate = calendar.create([ viewsetObject.year, viewsetObject.month, targetDate + ( settings.firstDay ? 1 : 0 ) ])\n\n                                var isSelected = selectedObject && selectedObject.pick == targetDate.pick,\n                                    isHighlighted = highlightedObject && highlightedObject.pick == targetDate.pick,\n                                    isDisabled = disabledCollection && calendar.disabled( targetDate ) || targetDate.pick < minLimitObject.pick || targetDate.pick > maxLimitObject.pick\n\n                                return [\n                                    _.node(\n                                        'div',\n                                        targetDate.date,\n                                        (function( klasses ) {\n\n                                            // Add the `infocus` or `outfocus` classes based on month in view.\n                                            klasses.push( viewsetObject.month == targetDate.month ? settings.klass.infocus : settings.klass.outfocus )\n\n                                            // Add the `today` class if needed.\n                                            if ( nowObject.pick == targetDate.pick ) {\n                                                klasses.push( settings.klass.now )\n                                            }\n\n                                            // Add the `selected` class if something's selected and the time matches.\n                                            if ( isSelected ) {\n                                                klasses.push( settings.klass.selected )\n                                            }\n\n                                            // Add the `highlighted` class if something's highlighted and the time matches.\n                                            if ( isHighlighted ) {\n                                                klasses.push( settings.klass.highlighted )\n                                            }\n\n                                            // Add the `disabled` class if something's disabled and the object matches.\n                                            if ( isDisabled ) {\n                                                klasses.push( settings.klass.disabled )\n                                            }\n\n                                            return klasses.join( ' ' )\n                                        })([ settings.klass.day ]),\n                                        'data-pick=' + targetDate.pick + ' ' + _.ariaAttr({\n                                            role: 'gridcell',\n                                            selected: isSelected && calendar.$node.val() === _.trigger(\n                                                    calendar.formats.toString,\n                                                    calendar,\n                                                    [ settings.format, targetDate ]\n                                                ) ? true : null,\n                                            activedescendant: isHighlighted ? true : null,\n                                            disabled: isDisabled ? true : null\n                                        })\n                                    ),\n                                    '',\n                                    _.ariaAttr({ role: 'presentation' })\n                                ] //endreturn\n                            }\n                        })\n                    ] //endreturn\n                }\n            })\n        ),\n        settings.klass.table,\n        'id=\"' + calendar.$node[0].id + '_table' + '\" ' + _.ariaAttr({\n            role: 'grid',\n            controls: calendar.$node[0].id,\n            readonly: true\n        })\n    ) +\n\n    // * For Firefox forms to submit, make sure to set the buttons `type` attributes as button.\n    _.node(\n        'div',\n        _.node( 'button', settings.today, settings.klass.buttonToday,\n            'type=button data-pick=' + nowObject.pick +\n            ( isOpen && !calendar.disabled(nowObject) ? '' : ' disabled' ) + ' ' +\n            _.ariaAttr({ controls: calendar.$node[0].id }) ) +\n        _.node( 'button', settings.clear, settings.klass.buttonClear,\n            'type=button data-clear=1' +\n            ( isOpen ? '' : ' disabled' ) + ' ' +\n            _.ariaAttr({ controls: calendar.$node[0].id }) ) +\n        _.node('button', settings.close, settings.klass.buttonClose,\n            'type=button data-close=true ' +\n            ( isOpen ? '' : ' disabled' ) + ' ' +\n            _.ariaAttr({ controls: calendar.$node[0].id }) ),\n        settings.klass.footer\n    ) //endreturn\n} //DatePicker.prototype.nodes\n\n\n\n\n/**\n * The date picker defaults.\n */\nDatePicker.defaults = (function( prefix ) {\n\n    return {\n\n        // The title label to use for the month nav buttons\n        labelMonthNext: 'Next month',\n        labelMonthPrev: 'Previous month',\n\n        // The title label to use for the dropdown selectors\n        labelMonthSelect: 'Select a month',\n        labelYearSelect: 'Select a year',\n\n        // Months and weekdays\n        monthsFull: [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ],\n        monthsShort: [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ],\n        weekdaysFull: [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday' ],\n        weekdaysShort: [ 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat' ],\n\n        // Today and clear\n        today: 'Today',\n        clear: 'Clear',\n        close: 'Close',\n\n        // The format to show on the `input` element\n        format: 'd mmmm, yyyy',\n\n        // Classes\n        klass: {\n\n            table: prefix + 'table',\n\n            header: prefix + 'header',\n\n            navPrev: prefix + 'nav--prev',\n            navNext: prefix + 'nav--next',\n            navDisabled: prefix + 'nav--disabled',\n\n            month: prefix + 'month',\n            year: prefix + 'year',\n\n            selectMonth: prefix + 'select--month',\n            selectYear: prefix + 'select--year',\n\n            weekdays: prefix + 'weekday',\n\n            day: prefix + 'day',\n            disabled: prefix + 'day--disabled',\n            selected: prefix + 'day--selected',\n            highlighted: prefix + 'day--highlighted',\n            now: prefix + 'day--today',\n            infocus: prefix + 'day--infocus',\n            outfocus: prefix + 'day--outfocus',\n\n            footer: prefix + 'footer',\n\n            buttonClear: prefix + 'button--clear',\n            buttonToday: prefix + 'button--today',\n            buttonClose: prefix + 'button--close'\n        }\n    }\n})( Picker.klasses().picker + '__' )\n\n\n\n\n\n/**\n * Extend the picker to add the date picker.\n */\nPicker.extend( 'pickadate', DatePicker )\n\n\n}));\n","\n/*!\n * Time picker for pickadate.js v3.5.4\n * http://amsul.github.io/pickadate.js/time.htm\n */\n\n(function ( factory ) {\n\n    // AMD.\n    if ( typeof define == 'function' && define.amd )\n        define( ['picker','jquery'], factory )\n\n    // Node.js/browserify.\n    else if ( typeof exports == 'object' )\n        module.exports = factory( require('./picker.js'), require('jquery') )\n\n    // Browser globals.\n    else factory( Picker, jQuery )\n\n}(function( Picker, $ ) {\n\n\n/**\n * Globals and constants\n */\nvar HOURS_IN_DAY = 24,\n    MINUTES_IN_HOUR = 60,\n    HOURS_TO_NOON = 12,\n    MINUTES_IN_DAY = HOURS_IN_DAY * MINUTES_IN_HOUR,\n    _ = Picker._\n\n\n\n/**\n * The time picker constructor\n */\nfunction TimePicker( picker, settings ) {\n\n    var clock = this,\n        elementValue = picker.$node[ 0 ].value,\n        elementDataValue = picker.$node.data( 'value' ),\n        valueString = elementDataValue || elementValue,\n        formatString = elementDataValue ? settings.formatSubmit : settings.format\n\n    clock.settings = settings\n    clock.$node = picker.$node\n\n    // The queue of methods that will be used to build item objects.\n    clock.queue = {\n        interval: 'i',\n        min: 'measure create',\n        max: 'measure create',\n        now: 'now create',\n        select: 'parse create validate',\n        highlight: 'parse create validate',\n        view: 'parse create validate',\n        disable: 'deactivate',\n        enable: 'activate'\n    }\n\n    // The component's item object.\n    clock.item = {}\n\n    clock.item.clear = null\n    clock.item.interval = settings.interval || 30\n    clock.item.disable = ( settings.disable || [] ).slice( 0 )\n    clock.item.enable = -(function( collectionDisabled ) {\n        return collectionDisabled[ 0 ] === true ? collectionDisabled.shift() : -1\n    })( clock.item.disable )\n\n    clock.\n        set( 'min', settings.min ).\n        set( 'max', settings.max ).\n        set( 'now' )\n\n    // When theres a value, set the `select`, which in turn\n    // also sets the `highlight` and `view`.\n    if ( valueString ) {\n        clock.set( 'select', valueString, {\n            format: formatString,\n            fromValue: !!elementValue\n        })\n    }\n\n    // If theres no value, default to highlighting today.\n    else {\n        clock.\n            set( 'select', null ).\n            set( 'highlight', clock.item.now )\n    }\n\n    // The keycode to movement mapping.\n    clock.key = {\n        40: 1, // Down\n        38: -1, // Up\n        39: 1, // Right\n        37: -1, // Left\n        go: function( timeChange ) {\n            clock.set(\n                'highlight',\n                clock.item.highlight.pick + timeChange * clock.item.interval,\n                { interval: timeChange * clock.item.interval }\n            )\n            this.render()\n        }\n    }\n\n\n    // Bind some picker events.\n    picker.\n        on( 'render', function() {\n            var $pickerHolder = picker.$root.children(),\n                $viewset = $pickerHolder.find( '.' + settings.klass.viewset ),\n                vendors = function( prop ) {\n                    return ['webkit', 'moz', 'ms', 'o', ''].map(function( vendor ) {\n                        return ( vendor ? '-' + vendor + '-' : '' ) + prop\n                    })\n                },\n                animations = function( $el, state ) {\n                    vendors( 'transform' ).map(function( prop ) {\n                        $el.css( prop, state )\n                    })\n                    vendors( 'transition' ).map(function( prop ) {\n                        $el.css( prop, state )\n                    })\n                }\n            if ( $viewset.length ) {\n                animations( $pickerHolder, 'none' )\n                $pickerHolder[ 0 ].scrollTop = ~~$viewset.position().top - ( $viewset[ 0 ].clientHeight * 2 )\n                animations( $pickerHolder, '' )\n            }\n        }, 1 ).\n        on( 'open', function() {\n            picker.$root.find( 'button' ).attr( 'disabled', false )\n        }, 1 ).\n        on( 'close', function() {\n            picker.$root.find( 'button' ).attr( 'disabled', true )\n        }, 1 )\n\n} //TimePicker\n\n\n/**\n * Set a timepicker item object.\n */\nTimePicker.prototype.set = function( type, value, options ) {\n\n    var clock = this,\n        clockItem = clock.item\n\n    // If the value is `null` just set it immediately.\n    if ( value === null ) {\n        if ( type == 'clear' ) type = 'select'\n        clockItem[ type ] = value\n        return clock\n    }\n\n    // Otherwise go through the queue of methods, and invoke the functions.\n    // Update this as the time unit, and set the final value as this item.\n    // * In the case of `enable`, keep the queue but set `disable` instead.\n    //   And in the case of `flip`, keep the queue but set `enable` instead.\n    clockItem[ ( type == 'enable' ? 'disable' : type == 'flip' ? 'enable' : type ) ] = clock.queue[ type ].split( ' ' ).map( function( method ) {\n        value = clock[ method ]( type, value, options )\n        return value\n    }).pop()\n\n    // Check if we need to cascade through more updates.\n    if ( type == 'select' ) {\n        clock.set( 'highlight', clockItem.select, options )\n    }\n    else if ( type == 'highlight' ) {\n        clock.set( 'view', clockItem.highlight, options )\n    }\n    else if ( type == 'interval' ) {\n        clock.\n            set( 'min', clockItem.min, options ).\n            set( 'max', clockItem.max, options )\n    }\n    else if ( type.match( /^(flip|min|max|disable|enable)$/ ) ) {\n        if ( type == 'min' ) {\n            clock.set( 'max', clockItem.max, options )\n        }\n        if ( clockItem.select && clock.disabled( clockItem.select ) ) {\n            clock.set( 'select', clockItem.select, options )\n        }\n        if ( clockItem.highlight && clock.disabled( clockItem.highlight ) ) {\n            clock.set( 'highlight', clockItem.highlight, options )\n        }\n    }\n\n    return clock\n} //TimePicker.prototype.set\n\n\n/**\n * Get a timepicker item object.\n */\nTimePicker.prototype.get = function( type ) {\n    return this.item[ type ]\n} //TimePicker.prototype.get\n\n\n/**\n * Create a picker time object.\n */\nTimePicker.prototype.create = function( type, value, options ) {\n\n    var clock = this\n\n    // If theres no value, use the type as the value.\n    value = value === undefined ? type : value\n\n    // If its a date object, convert it into an array.\n    if ( _.isDate( value ) ) {\n        value = [ value.getHours(), value.getMinutes() ]\n    }\n\n    // If its an object, use the pick value.\n    if ( $.isPlainObject( value ) && _.isInteger( value.pick ) ) {\n        value = value.pick\n    }\n\n    // If its an array, convert it into minutes.\n    else if ( $.isArray( value ) ) {\n        value = +value[ 0 ] * MINUTES_IN_HOUR + (+value[ 1 ])\n    }\n\n    // If no valid value is passed, set it to now.\n    else if ( !_.isInteger( value ) ) {\n        value = clock.now( type, value, options )\n    }\n\n    // If were setting the max, make sure its greater than the min.\n    if ( type == 'max' && value < clock.item.min.pick ) {\n        value += MINUTES_IN_DAY\n    }\n\n    // If the value doesnt fall directly on the interval,\n    // add one interval to indicate it as passed.\n    if ( type != 'min' && type != 'max' && (value - clock.item.min.pick) % clock.item.interval !== 0 ) {\n        value += clock.item.interval\n    }\n\n    // Normalize it into a reachable interval.\n    value = clock.normalize( type, value, options )\n\n    // Return the compiled object.\n    return {\n\n        // Divide to get hours from minutes.\n        hour: ~~( HOURS_IN_DAY + value / MINUTES_IN_HOUR ) % HOURS_IN_DAY,\n\n        // The remainder is the minutes.\n        mins: ( MINUTES_IN_HOUR + value % MINUTES_IN_HOUR ) % MINUTES_IN_HOUR,\n\n        // The time in total minutes.\n        time: ( MINUTES_IN_DAY + value ) % MINUTES_IN_DAY,\n\n        // Reference to the relative value to pick.\n        pick: value\n    }\n} //TimePicker.prototype.create\n\n\n/**\n * Create a range limit object using an array, date object,\n * literal true, or integer relative to another time.\n */\nTimePicker.prototype.createRange = function( from, to ) {\n\n    var clock = this,\n        createTime = function( time ) {\n            if ( time === true || $.isArray( time ) || _.isDate( time ) ) {\n                return clock.create( time )\n            }\n            return time\n        }\n\n    // Create objects if possible.\n    if ( !_.isInteger( from ) ) {\n        from = createTime( from )\n    }\n    if ( !_.isInteger( to ) ) {\n        to = createTime( to )\n    }\n\n    // Create relative times.\n    if ( _.isInteger( from ) && $.isPlainObject( to ) ) {\n        from = [ to.hour, to.mins + ( from * clock.settings.interval ) ];\n    }\n    else if ( _.isInteger( to ) && $.isPlainObject( from ) ) {\n        to = [ from.hour, from.mins + ( to * clock.settings.interval ) ];\n    }\n\n    return {\n        from: createTime( from ),\n        to: createTime( to )\n    }\n} //TimePicker.prototype.createRange\n\n\n/**\n * Check if a time unit falls within a time range object.\n */\nTimePicker.prototype.withinRange = function( range, timeUnit ) {\n    range = this.createRange(range.from, range.to)\n    return timeUnit.pick >= range.from.pick && timeUnit.pick <= range.to.pick\n}\n\n\n/**\n * Check if two time range objects overlap.\n */\nTimePicker.prototype.overlapRanges = function( one, two ) {\n\n    var clock = this\n\n    // Convert the ranges into comparable times.\n    one = clock.createRange( one.from, one.to )\n    two = clock.createRange( two.from, two.to )\n\n    return clock.withinRange( one, two.from ) || clock.withinRange( one, two.to ) ||\n        clock.withinRange( two, one.from ) || clock.withinRange( two, one.to )\n}\n\n\n/**\n * Get the time relative to now.\n */\nTimePicker.prototype.now = function( type, value/*, options*/ ) {\n\n    var interval = this.item.interval,\n        date = new Date(),\n        nowMinutes = date.getHours() * MINUTES_IN_HOUR + date.getMinutes(),\n        isValueInteger = _.isInteger( value ),\n        isBelowInterval\n\n    // Make sure now falls within the interval range.\n    nowMinutes -= nowMinutes % interval\n\n    // Check if the difference is less than the interval itself.\n    isBelowInterval = value < 0 && interval * value + nowMinutes <= -interval\n\n    // Add an interval because the time has passed.\n    nowMinutes += type == 'min' && isBelowInterval ? 0 : interval\n\n    // If the value is a number, adjust by that many intervals.\n    if ( isValueInteger ) {\n        nowMinutes += interval * (\n            isBelowInterval && type != 'max' ?\n                value + 1 :\n                value\n            )\n    }\n\n    // Return the final calculation.\n    return nowMinutes\n} //TimePicker.prototype.now\n\n\n/**\n * Normalize minutes to be reachable based on the min and interval.\n */\nTimePicker.prototype.normalize = function( type, value/*, options*/ ) {\n\n    var interval = this.item.interval,\n        minTime = this.item.min && this.item.min.pick || 0\n\n    // If setting min time, dont shift anything.\n    // Otherwise get the value and min difference and then\n    // normalize the difference with the interval.\n    value -= type == 'min' ? 0 : ( value - minTime ) % interval\n\n    // Return the adjusted value.\n    return value\n} //TimePicker.prototype.normalize\n\n\n/**\n * Measure the range of minutes.\n */\nTimePicker.prototype.measure = function( type, value, options ) {\n\n    var clock = this\n\n    // If its anything false-y, set it to the default.\n    if ( !value ) {\n        value = type == 'min' ? [ 0, 0 ] : [ HOURS_IN_DAY - 1, MINUTES_IN_HOUR - 1 ]\n    }\n\n    // If its a string, parse it.\n    if ( typeof value == 'string' ) {\n        value = clock.parse( type, value )\n    }\n\n    // If its a literal true, or an integer, make it relative to now.\n    else if ( value === true || _.isInteger( value ) ) {\n        value = clock.now( type, value, options )\n    }\n\n    // If its an object already, just normalize it.\n    else if ( $.isPlainObject( value ) && _.isInteger( value.pick ) ) {\n        value = clock.normalize( type, value.pick, options )\n    }\n\n    return value\n} ///TimePicker.prototype.measure\n\n\n/**\n * Validate an object as enabled.\n */\nTimePicker.prototype.validate = function( type, timeObject, options ) {\n\n    var clock = this,\n        interval = options && options.interval ? options.interval : clock.item.interval\n\n    // Check if the object is disabled.\n    if ( clock.disabled( timeObject ) ) {\n\n        // Shift with the interval until we reach an enabled time.\n        timeObject = clock.shift( timeObject, interval )\n    }\n\n    // Scope the object into range.\n    timeObject = clock.scope( timeObject )\n\n    // Do a second check to see if we landed on a disabled min/max.\n    // In that case, shift using the opposite interval as before.\n    if ( clock.disabled( timeObject ) ) {\n        timeObject = clock.shift( timeObject, interval * -1 )\n    }\n\n    // Return the final object.\n    return timeObject\n} //TimePicker.prototype.validate\n\n\n/**\n * Check if an object is disabled.\n */\nTimePicker.prototype.disabled = function( timeToVerify ) {\n\n    var clock = this,\n\n        // Filter through the disabled times to check if this is one.\n        isDisabledMatch = clock.item.disable.filter( function( timeToDisable ) {\n\n            // If the time is a number, match the hours.\n            if ( _.isInteger( timeToDisable ) ) {\n                return timeToVerify.hour == timeToDisable\n            }\n\n            // If its an array, create the object and match the times.\n            if ( $.isArray( timeToDisable ) || _.isDate( timeToDisable ) ) {\n                return timeToVerify.pick == clock.create( timeToDisable ).pick\n            }\n\n            // If its an object, match a time within the from and to range.\n            if ( $.isPlainObject( timeToDisable ) ) {\n                return clock.withinRange( timeToDisable, timeToVerify )\n            }\n        })\n\n    // If this time matches a disabled time, confirm its not inverted.\n    isDisabledMatch = isDisabledMatch.length && !isDisabledMatch.filter(function( timeToDisable ) {\n        return $.isArray( timeToDisable ) && timeToDisable[2] == 'inverted' ||\n            $.isPlainObject( timeToDisable ) && timeToDisable.inverted\n    }).length\n\n    // If the clock is \"enabled\" flag is flipped, flip the condition.\n    return clock.item.enable === -1 ? !isDisabledMatch : isDisabledMatch ||\n        timeToVerify.pick < clock.item.min.pick ||\n        timeToVerify.pick > clock.item.max.pick\n} //TimePicker.prototype.disabled\n\n\n/**\n * Shift an object by an interval until we reach an enabled object.\n */\nTimePicker.prototype.shift = function( timeObject, interval ) {\n\n    var clock = this,\n        minLimit = clock.item.min.pick,\n        maxLimit = clock.item.max.pick/*,\n        safety = 1000*/\n\n    interval = interval || clock.item.interval\n\n    // Keep looping as long as the time is disabled.\n    while ( /*safety &&*/ clock.disabled( timeObject ) ) {\n\n        /*safety -= 1\n        if ( !safety ) {\n            throw 'Fell into an infinite loop while shifting to ' + timeObject.hour + ':' + timeObject.mins + '.'\n        }*/\n\n        // Increase/decrease the time by the interval and keep looping.\n        timeObject = clock.create( timeObject.pick += interval )\n\n        // If we've looped beyond the limits, break out of the loop.\n        if ( timeObject.pick <= minLimit || timeObject.pick >= maxLimit ) {\n            break\n        }\n    }\n\n    // Return the final object.\n    return timeObject\n} //TimePicker.prototype.shift\n\n\n/**\n * Scope an object to be within range of min and max.\n */\nTimePicker.prototype.scope = function( timeObject ) {\n    var minLimit = this.item.min.pick,\n        maxLimit = this.item.max.pick\n    return this.create( timeObject.pick > maxLimit ? maxLimit : timeObject.pick < minLimit ? minLimit : timeObject )\n} //TimePicker.prototype.scope\n\n\n/**\n * Parse a string into a usable type.\n */\nTimePicker.prototype.parse = function( type, value, options ) {\n\n    var hour, minutes, isPM, item, parseValue,\n        clock = this,\n        parsingObject = {}\n\n    // If its already parsed, were good.\n    if ( !value || typeof value != 'string' ) {\n        return value\n    }\n\n    // We need a `.format` to parse the value with.\n    if ( !( options && options.format ) ) {\n        options = options || {}\n        options.format = clock.settings.format\n    }\n\n    // Convert the format into an array and then map through it.\n    clock.formats.toArray( options.format ).map( function( label ) {\n\n        var\n            substring,\n\n            // Grab the formatting label.\n            formattingLabel = clock.formats[ label ],\n\n            // The format length is from the formatting label function or the\n            // label length without the escaping exclamation (!) mark.\n            formatLength = formattingLabel ?\n                _.trigger( formattingLabel, clock, [ value, parsingObject ] ) :\n                label.replace( /^!/, '' ).length\n\n        // If there's a format label, split the value up to the format length.\n        // Then add it to the parsing object with appropriate label.\n        if ( formattingLabel ) {\n            substring = value.substr( 0, formatLength )\n            parsingObject[ label ] = substring.match(/^\\d+$/) ? +substring : substring\n        }\n\n        // Update the time value as the substring from format length to end.\n        value = value.substr( formatLength )\n    })\n\n    // Grab the hour and minutes from the parsing object.\n    for ( item in parsingObject ) {\n        parseValue = parsingObject[item]\n        if ( _.isInteger(parseValue) ) {\n            if ( item.match(/^(h|hh)$/i) ) {\n                hour = parseValue\n                if ( item == 'h' || item == 'hh' ) {\n                    hour %= 12\n                }\n            }\n            else if ( item == 'i' ) {\n                minutes = parseValue\n            }\n        }\n        else if ( item.match(/^a$/i) && parseValue.match(/^p/i) && ('h' in parsingObject || 'hh' in parsingObject) ) {\n            isPM = true\n        }\n    }\n\n    // Calculate it in minutes and return.\n    return (isPM ? hour + 12 : hour) * MINUTES_IN_HOUR + minutes\n} //TimePicker.prototype.parse\n\n\n/**\n * Various formats to display the object in.\n */\nTimePicker.prototype.formats = {\n\n    h: function( string, timeObject ) {\n\n        // If there's string, then get the digits length.\n        // Otherwise return the selected hour in \"standard\" format.\n        return string ? _.digits( string ) : timeObject.hour % HOURS_TO_NOON || HOURS_TO_NOON\n    },\n    hh: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 2.\n        // Otherwise return the selected hour in \"standard\" format with a leading zero.\n        return string ? 2 : _.lead( timeObject.hour % HOURS_TO_NOON || HOURS_TO_NOON )\n    },\n    H: function( string, timeObject ) {\n\n        // If there's string, then get the digits length.\n        // Otherwise return the selected hour in \"military\" format as a string.\n        return string ? _.digits( string ) : '' + ( timeObject.hour % 24 )\n    },\n    HH: function( string, timeObject ) {\n\n        // If there's string, then get the digits length.\n        // Otherwise return the selected hour in \"military\" format with a leading zero.\n        return string ? _.digits( string ) : _.lead( timeObject.hour % 24 )\n    },\n    i: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 2.\n        // Otherwise return the selected minutes.\n        return string ? 2 : _.lead( timeObject.mins )\n    },\n    a: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 4.\n        // Otherwise check if it's more than \"noon\" and return either am/pm.\n        return string ? 4 : MINUTES_IN_DAY / 2 > timeObject.time % MINUTES_IN_DAY ? 'a.m.' : 'p.m.'\n    },\n    A: function( string, timeObject ) {\n\n        // If there's a string, then the length is always 2.\n        // Otherwise check if it's more than \"noon\" and return either am/pm.\n        return string ? 2 : MINUTES_IN_DAY / 2 > timeObject.time % MINUTES_IN_DAY ? 'AM' : 'PM'\n    },\n\n    // Create an array by splitting the formatting string passed.\n    toArray: function( formatString ) { return formatString.split( /(h{1,2}|H{1,2}|i|a|A|!.)/g ) },\n\n    // Format an object into a string using the formatting options.\n    toString: function ( formatString, itemObject ) {\n        var clock = this\n        return clock.formats.toArray( formatString ).map( function( label ) {\n            return _.trigger( clock.formats[ label ], clock, [ 0, itemObject ] ) || label.replace( /^!/, '' )\n        }).join( '' )\n    }\n} //TimePicker.prototype.formats\n\n\n\n\n/**\n * Check if two time units are the exact.\n */\nTimePicker.prototype.isTimeExact = function( one, two ) {\n\n    var clock = this\n\n    // When were working with minutes, do a direct comparison.\n    if (\n        ( _.isInteger( one ) && _.isInteger( two ) ) ||\n        ( typeof one == 'boolean' && typeof two == 'boolean' )\n     ) {\n        return one === two\n    }\n\n    // When were working with time representations, compare the pick value.\n    if (\n        ( _.isDate( one ) || $.isArray( one ) ) &&\n        ( _.isDate( two ) || $.isArray( two ) )\n    ) {\n        return clock.create( one ).pick === clock.create( two ).pick\n    }\n\n    // When were working with range objects, compare the from and to.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return clock.isTimeExact( one.from, two.from ) && clock.isTimeExact( one.to, two.to )\n    }\n\n    return false\n}\n\n\n/**\n * Check if two time units overlap.\n */\nTimePicker.prototype.isTimeOverlap = function( one, two ) {\n\n    var clock = this\n\n    // When were working with an integer, compare the hours.\n    if ( _.isInteger( one ) && ( _.isDate( two ) || $.isArray( two ) ) ) {\n        return one === clock.create( two ).hour\n    }\n    if ( _.isInteger( two ) && ( _.isDate( one ) || $.isArray( one ) ) ) {\n        return two === clock.create( one ).hour\n    }\n\n    // When were working with range objects, check if the ranges overlap.\n    if ( $.isPlainObject( one ) && $.isPlainObject( two ) ) {\n        return clock.overlapRanges( one, two )\n    }\n\n    return false\n}\n\n\n/**\n * Flip the enabled state.\n */\nTimePicker.prototype.flipEnable = function(val) {\n    var itemObject = this.item\n    itemObject.enable = val || (itemObject.enable == -1 ? 1 : -1)\n}\n\n\n/**\n * Mark a collection of times as disabled.\n */\nTimePicker.prototype.deactivate = function( type, timesToDisable ) {\n\n    var clock = this,\n        disabledItems = clock.item.disable.slice(0)\n\n\n    // If were flipping, thats all we need to do.\n    if ( timesToDisable == 'flip' ) {\n        clock.flipEnable()\n    }\n\n    else if ( timesToDisable === false ) {\n        clock.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( timesToDisable === true ) {\n        clock.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the times to disable.\n    else {\n\n        timesToDisable.map(function( unitToDisable ) {\n\n            var matchFound\n\n            // When we have disabled items, check for matches.\n            // If something is matched, immediately break out.\n            for ( var index = 0; index < disabledItems.length; index += 1 ) {\n                if ( clock.isTimeExact( unitToDisable, disabledItems[index] ) ) {\n                    matchFound = true\n                    break\n                }\n            }\n\n            // If nothing was found, add the validated unit to the collection.\n            if ( !matchFound ) {\n                if (\n                    _.isInteger( unitToDisable ) ||\n                    _.isDate( unitToDisable ) ||\n                    $.isArray( unitToDisable ) ||\n                    ( $.isPlainObject( unitToDisable ) && unitToDisable.from && unitToDisable.to )\n                ) {\n                    disabledItems.push( unitToDisable )\n                }\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems\n} //TimePicker.prototype.deactivate\n\n\n/**\n * Mark a collection of times as enabled.\n */\nTimePicker.prototype.activate = function( type, timesToEnable ) {\n\n    var clock = this,\n        disabledItems = clock.item.disable,\n        disabledItemsCount = disabledItems.length\n\n    // If were flipping, thats all we need to do.\n    if ( timesToEnable == 'flip' ) {\n        clock.flipEnable()\n    }\n\n    else if ( timesToEnable === true ) {\n        clock.flipEnable(1)\n        disabledItems = []\n    }\n\n    else if ( timesToEnable === false ) {\n        clock.flipEnable(-1)\n        disabledItems = []\n    }\n\n    // Otherwise go through the disabled times.\n    else {\n\n        timesToEnable.map(function( unitToEnable ) {\n\n            var matchFound,\n                disabledUnit,\n                index,\n                isRangeMatched\n\n            // Go through the disabled items and try to find a match.\n            for ( index = 0; index < disabledItemsCount; index += 1 ) {\n\n                disabledUnit = disabledItems[index]\n\n                // When an exact match is found, remove it from the collection.\n                if ( clock.isTimeExact( disabledUnit, unitToEnable ) ) {\n                    matchFound = disabledItems[index] = null\n                    isRangeMatched = true\n                    break\n                }\n\n                // When an overlapped match is found, add the inverted state to it.\n                else if ( clock.isTimeOverlap( disabledUnit, unitToEnable ) ) {\n                    if ( $.isPlainObject( unitToEnable ) ) {\n                        unitToEnable.inverted = true\n                        matchFound = unitToEnable\n                    }\n                    else if ( $.isArray( unitToEnable ) ) {\n                        matchFound = unitToEnable\n                        if ( !matchFound[2] ) matchFound.push( 'inverted' )\n                    }\n                    else if ( _.isDate( unitToEnable ) ) {\n                        matchFound = [ unitToEnable.getFullYear(), unitToEnable.getMonth(), unitToEnable.getDate(), 'inverted' ]\n                    }\n                    break\n                }\n            }\n\n            // If a match was found, remove a previous duplicate entry.\n            if ( matchFound ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( clock.isTimeExact( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // In the event that were dealing with an overlap of range times,\n            // make sure there are no inverted times because of it.\n            if ( isRangeMatched ) for ( index = 0; index < disabledItemsCount; index += 1 ) {\n                if ( clock.isTimeOverlap( disabledItems[index], unitToEnable ) ) {\n                    disabledItems[index] = null\n                    break\n                }\n            }\n\n            // If something is still matched, add it into the collection.\n            if ( matchFound ) {\n                disabledItems.push( matchFound )\n            }\n        })\n    }\n\n    // Return the updated collection.\n    return disabledItems.filter(function( val ) { return val != null })\n} //TimePicker.prototype.activate\n\n\n/**\n * The division to use for the range intervals.\n */\nTimePicker.prototype.i = function( type, value/*, options*/ ) {\n    return _.isInteger( value ) && value > 0 ? value : this.item.interval\n}\n\n\n/**\n * Create a string for the nodes in the picker.\n */\nTimePicker.prototype.nodes = function( isOpen ) {\n\n    var\n        clock = this,\n        settings = clock.settings,\n        selectedObject = clock.item.select,\n        highlightedObject = clock.item.highlight,\n        viewsetObject = clock.item.view,\n        disabledCollection = clock.item.disable\n\n    return _.node(\n        'ul',\n        _.group({\n            min: clock.item.min.pick,\n            max: clock.item.max.pick,\n            i: clock.item.interval,\n            node: 'li',\n            item: function( loopedTime ) {\n                loopedTime = clock.create( loopedTime )\n                var timeMinutes = loopedTime.pick,\n                    isSelected = selectedObject && selectedObject.pick == timeMinutes,\n                    isHighlighted = highlightedObject && highlightedObject.pick == timeMinutes,\n                    isDisabled = disabledCollection && clock.disabled( loopedTime )\n                return [\n                    _.trigger( clock.formats.toString, clock, [ _.trigger( settings.formatLabel, clock, [ loopedTime ] ) || settings.format, loopedTime ] ),\n                    (function( klasses ) {\n\n                        if ( isSelected ) {\n                            klasses.push( settings.klass.selected )\n                        }\n\n                        if ( isHighlighted ) {\n                            klasses.push( settings.klass.highlighted )\n                        }\n\n                        if ( viewsetObject && viewsetObject.pick == timeMinutes ) {\n                            klasses.push( settings.klass.viewset )\n                        }\n\n                        if ( isDisabled ) {\n                            klasses.push( settings.klass.disabled )\n                        }\n\n                        return klasses.join( ' ' )\n                    })( [ settings.klass.listItem ] ),\n                    'data-pick=' + loopedTime.pick + ' ' + _.ariaAttr({\n                        role: 'option',\n                        selected: isSelected && clock.$node.val() === _.trigger(\n                                clock.formats.toString,\n                                clock,\n                                [ settings.format, loopedTime ]\n                            ) ? true : null,\n                        activedescendant: isHighlighted ? true : null,\n                        disabled: isDisabled ? true : null\n                    })\n                ]\n            }\n        }) +\n\n        // * For Firefox forms to submit, make sure to set the buttons `type` attribute as button.\n        _.node(\n            'li',\n            _.node(\n                'button',\n                settings.clear,\n                settings.klass.buttonClear,\n                'type=button data-clear=1' + ( isOpen ? '' : ' disabled' ) + ' ' +\n                _.ariaAttr({ controls: clock.$node[0].id })\n            ),\n            '', _.ariaAttr({ role: 'presentation' })\n        ),\n        settings.klass.list,\n        _.ariaAttr({ role: 'listbox', controls: clock.$node[0].id })\n    )\n} //TimePicker.prototype.nodes\n\n\n\n\n\n\n\n/* ==========================================================================\n   Extend the picker to add the component with the defaults.\n   ========================================================================== */\n\nTimePicker.defaults = (function( prefix ) {\n\n    return {\n\n        // Clear\n        clear: 'Clear',\n\n        // The format to show on the `input` element\n        format: 'h:i A',\n\n        // The interval between each time\n        interval: 30,\n\n        // Classes\n        klass: {\n\n            picker: prefix + ' ' + prefix + '--time',\n            holder: prefix + '__holder',\n\n            list: prefix + '__list',\n            listItem: prefix + '__list-item',\n\n            disabled: prefix + '__list-item--disabled',\n            selected: prefix + '__list-item--selected',\n            highlighted: prefix + '__list-item--highlighted',\n            viewset: prefix + '__list-item--viewset',\n            now: prefix + '__list-item--now',\n\n            buttonClear: prefix + '__button--clear'\n        }\n    }\n})( Picker.klasses().picker )\n\n\n\n\n\n/**\n * Extend the picker to add the time picker.\n */\nPicker.extend( 'pickatime', TimePicker )\n\n\n}));\n","import React from 'react';\nimport _ from 'lodash';\nimport Input from './input.js';\nimport Select from './select.js';\n\nconst RELATIVE_TIMEFRAMES = ['this', 'previous'];\n\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport FormatUtils from '../../utils/FormatUtils';\n\nfunction hasRelativeTimeframe(time) {\n  time = time || {};\n  return time.relativity && time.amount && time.sub_timeframe;\n}\n\nconst RelativePicker = React.createClass({\n\n  setRelativeTime: function(event) {\n    var name = event.target.name;\n    var value = event.target.value;\n\n    var updates = _.cloneDeep(this.props.time);\n    updates[name] = value\n    this.props.handleChange('time', updates)\n  },\n\n  buildDescriptionCopy: function() {\n    var time = this.props.time;\n\n    if (hasRelativeTimeframe(this.props.time)) {\n      var subIntervalCopy = FormatUtils.singularize(time.sub_timeframe, time.amount);\n      var timeAmountPluralSuffix = time.amount > 1 ? 's' : '';\n      var relativityCopy = time.relativity == 'this' ? 'including' : 'excluding';\n      var singularCurrentInterval = FormatUtils.singularize(subIntervalCopy);\n\n      return (<p className=\"help-block\">The last {time.amount} {subIntervalCopy}{timeAmountPluralSuffix} <b>{relativityCopy}</b> the current {singularCurrentInterval}.</p>);\n    }\n  },\n\n  // React Methods\n\n  render: function() {\n    var descriptionCopy = this.buildDescriptionCopy();\n\n    return (\n      <div className=\"relative-timeframe-picker\">\n        <div className=\"row\">\n          <div className=\"col-xs-4 form-collapse-right\" id=\"relative-type\">\n            <div className=\"btn-group\">\n              <Select label={false}\n                      name=\"relativity\"\n                      classes=\"relativity\"\n                      options={RELATIVE_TIMEFRAMES}\n                      emptyOption={false}\n                      handleSelection={this.setRelativeTime}\n                      selectedOption={this.props.time.relativity} />\n            </div>\n          </div>\n          <div className=\"col-xs-3 form-collapse-left form-collapse-right\" id=\"interval-amount\">\n            <Input label={false}\n                   name=\"amount\"\n                   classes=\"amount\"\n                   onChange={this.setRelativeTime}\n                   placeholder=\"e.g. 1\"\n                   value={this.props.time.amount || \"\"}\n                   autoComplete=\"off\" />\n          </div>\n          <div className=\"col-xs-5 form-collapse-left\" id=\"sub-interval-type\">\n            <Select label={false}\n                    name=\"sub_timeframe\"\n                    classes=\"sub-timeframe\"\n                    options={this.props.relativeIntervalTypes}\n                    emptyOption={false}\n                    handleSelection={this.setRelativeTime}\n                    selectedOption={this.props.time.sub_timeframe}\n                    sort={false} />\n          </div>\n        </div>\n        {descriptionCopy}\n      </div>\n    );\n  }\n});\n\nexport default RelativePicker;\n","import _ from 'lodash';\nimport React from 'react';\nimport ReactSelect from './react_select.js';\nimport ProjectUtils from '../../utils/ProjectUtils';\nimport ExplorerActions from '../../actions/ExplorerActions';\n\nconst Timezone = React.createClass({\n\n  handleTimezoneBlur: function() {\n    this.setState({ active: false });\n    this.refs['timezone-display'].focus();\n  },\n\n  handleTimezoneActivated: function(){\n    var self = this;\n    this.setState({ active: true });\n    setTimeout(function(){\n      self.refs['timezone'].refs['input'].focus();\n      self.refs['timezone'].setState({ visible: true });\n    }, 100);\n  },\n\n  handleTimezoneChange: function(name, value) {\n    var timezones = ProjectUtils.getConstant('TIMEZONES');\n    var timezone = timezones.filter(z => z.name === value)[0];\n    this.props.handleChange('timezone', timezone ? timezone.name : value);\n  },\n\n  // React methods\n\n  getInitialState: function(){\n    return { active: false };\n  },\n\n  componentDidMount: function() {\n    if (!this.props.timezone) {\n      this.props.handleChange('timezone', ProjectUtils.getConstant('DEFAULT_TIMEZONE'));\n    }\n    this.refs['timezone'].setState({ visible: false });\n  },\n\n  render: function(){\n    return (\n      <div className={\"timezone-toggle\" + (this.state.active ? \" active\" : \"\")}>\n        <div className=\"toggle-display\">\n          <button ref=\"timezone-display\"\n                  className=\"btn btn-link field-secondary-control\"\n                  title={\"Selectd timezone: \" + this.props.timezone}\n                  type=\"button\"\n                  onClick={this.handleTimezoneActivated}>\n            <span className=\"icon glyphicon glyphicon-globe\"></span> Timezone: {this.props.timezone}\n          </button>\n        </div>\n        <div className=\"toggle-options\">\n          <ReactSelect ref=\"timezone\"\n                       name=\"timezone\"\n                       classes=\"timezone form-control\"\n                       value={this.props.timezone}\n                       items={ProjectUtils.getConstant('TIMEZONES').map((z) => z.name)}\n                       handleChange={this.handleTimezoneChange}\n                       handleBlur={this.handleTimezoneBlur} />\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default Timezone;\n","import _ from 'lodash';\nimport React from 'react';\nimport Select from './select.js';\nimport classNames from 'classnames';\nimport ReactSelect from './react_select.js';\nimport FilterValueFields from './filter_value_fields.js';\nimport FilterUtils from '../../utils/FilterUtils';\n\nconst Filter = React.createClass({\n\n  removeFilter: function(e) {\n    e.preventDefault();\n    this.props.removeFilter(this.props.index);\n  },\n\n  handleChange: function(name, value) {\n    this.props.handleChange(this.props.index, name, value);\n  },\n\n  handleChangeWithEvent: function(e) {\n    this.props.handleChange(this.props.index, e.target.name, e.target.value);\n  },\n\n  buildValueFormGroup: function() {\n    return (\n      <FilterValueFields filter={this.props.filter}\n                         filterOperators={this.props.filterOperators}\n                         handleChange={this.handleChange} />\n    );\n  },\n\n  buildOperatorSelect: function() {\n    return (\n      <Select label={false}\n              name=\"operator\"\n              classes=\"operator\"\n              options={this.props.filterOperators}\n              emptyOption={false}\n              sort={false}\n              handleSelection={this.handleChangeWithEvent}\n              selectedOption={this.props.filter.operator} />\n    );\n  },\n\n  buildPropertyNameSelect: function() {\n    return (\n      <ReactSelect name=\"property_name\"\n                   inputClasses=\"property-name form-control\"\n                   items={this.props.propertyNames}\n                   handleChange={this.handleChange}\n                   placeholder=\"Select a property name\"\n                   value={this.props.filter.property_name}\n                   sort={true} />\n    )\n  },\n\n  getListSyntaxInfo: function() {\n    if (this.props.filter.coercion_type === 'List') {\n      return (\n        <p className=\"filter-instructions help-block\">\n          Wrap strings in <b>double</b> quotes &amp; numbers in <b>single</b> quotes.\n        </p>\n      );\n    }\n  },\n\n  buildValidationError: function() {\n    if (this.filterCompleteAndInvalid()) {\n      return (\n        <div className=\"row\">\n          <div className=\"col-md-12\">\n            <p className=\"invalid\">Invalid: {this.props.filter.errors[0].msg}</p>\n          </div>\n        </div>\n      );\n    }\n  },\n\n  filterCompleteAndInvalid: function() {\n    var complete = FilterUtils.isComplete(this.props.filter);\n    var valid = this.props.filter.isValid;\n    return complete && !valid;\n  },\n\n  // React functions\n\n  render: function() {\n    var filterClasses = classNames({\n      'filter-row': true,\n      'filter-complete': !FilterUtils.isComplete(this.props.filter) || this.props.filter.isValid,\n      'filter-incomplete': this.filterCompleteAndInvalid()\n    });\n\n    return (\n      <div className={filterClasses}>\n        <div className=\"row\">\n          <div className=\"col-md-4 filter-property-col\">\n            {this.buildPropertyNameSelect()}\n          </div>\n          <div className=\"col-md-2 filter-operator-col\">\n            {this.buildOperatorSelect()}\n          </div>\n          <div className=\"col-md-5 filter-value-col\">\n            {this.buildValueFormGroup()}\n            {this.getListSyntaxInfo()}\n          </div>\n          <div className=\"col-md-1 filter-close-col\">\n            <a href=\"#\" className=\"remove-filter\" onClick={this.removeFilter} data-index={this.props.index}>\n              <span className=\"icon no-margin\">&times;</span>\n            </a>\n          </div>\n        </div>\n        {this.buildValidationError()}\n      </div>\n    );\n  }\n});\n\nexport default Filter;\n","import _ from 'lodash';\nimport moment from 'moment';\nimport React from 'react';\nimport Select from './select.js';\nimport Datepicker from './datepicker.js';\nimport Timepicker from './timepicker.js';\nimport Geo from './geo.js';\nimport FormatUtils from '../../utils/FormatUtils';\nimport FilterUtils from '../../utils/FilterUtils';\n\nconst dateFormat = 'll';\nconst timeFormat = 'h:mm A';\n\nfunction pasrseIntoDate(dateString, timeString) {\n  var date = moment(new Date(dateString)).format(dateFormat);\n  var time = moment(new Date(timeString)).format(timeFormat);\n  return new Date(date + \" \" + time).toString();\n}\n\nconst FilterValueFields = React.createClass({\n\n  handleChangeWithEvent: function(event) {\n    this.props.handleChange(event.target.name, event.target.value);\n  },\n\n  setValueState: function(event) {\n    var updates = {};\n    updates[event.target.name] = event.target.value;\n    this.setState(updates);\n  },\n\n  setDate: function(name, value) {\n    this.props.handleChange(name, pasrseIntoDate(value, this.props.filter.property_value));\n  },\n\n  setTime: function(name, value) {\n    this.props.handleChange(name, pasrseIntoDate(this.props.filter.property_value, value));\n  },\n\n  handleDateBlur: function (event) {\n    this.setDate(event.target.name, event.target.value);\n  },\n\n  handleChange: function(event) {\n    this.props.handleChange(event.target.name, event.target.value);\n  },\n\n  getCoercionOptions: function() {\n    var operator = this.props.filter.operator;\n    return operator ? _.find(this.props.filterOperators, { value: operator }).canBeCoeredTo : [];\n  },\n\n  getInputPlaceholder: function() {\n    var type = this.props.filter.coercion_type;\n    return type === 'List' ? 'Comma sep list' : type;\n  },\n\n  // React methods\n\n  getInitialState: function() {\n    return {\n      property_value: this.props.filter.property_value\n    };\n  },\n\n  componentWillReceiveProps: function(newProps) {\n    this.setState({ property_value: newProps.filter.property_value });\n  },\n\n  render: function() {\n    var valueInput;\n    if (this.propertyType === 'geo' || this.props.filter.operator === 'within') {\n      valueInput = (\n        <Geo handleChange={this.handleChangeWithEvent}\n             filter={this.props.filter}/>\n      );\n    } else if (this.props.filter.operator === 'exists' || this.props.filter.coercion_type === 'Boolean') {\n      valueInput = (\n        <Select name=\"property_value\"\n                classes=\"property-value\"\n                ref=\"boolean-value-set\"\n                options={['true', 'false']}\n                handleBlur={this.handleChangeWithEvent}\n                handleSelection={this.setValueState}\n                selectedOption={FormatUtils.booleanMap(this.state.property_value) || 'true'}\n                emptyOption={false} />\n      );\n    } else if (this.props.filter.coercion_type === 'Datetime') {\n      valueInput = (\n        <div className=\"row property-value\">\n          <div className=\"col-md-6 form-collapse-right\">\n            <Datepicker ref=\"date-value-input\"\n                        value={moment(new Date(this.state.property_value)).format(dateFormat)}\n                        label={false}\n                        name=\"property_value\"\n                        placeholder=\"Date\"\n                        classes=\"datepicker-wrapper\"\n                        onSet={this.setDate}\n                        onBlur={this.handleDateBlur} />\n          </div>\n          <div className=\"col-md-6 form-collapse-left\">\n            <Timepicker ref=\"time-value-input\"\n                        value={moment(new Date(this.state.property_value)).format(timeFormat)}\n                        label={false}\n                        name=\"property_value\"\n                        placeholder=\"Time\"\n                        classes=\"timepicker-wrapper\"\n                        handleSelection={this.setTime}\n                        handleBlur={this.setTime} />\n          </div>\n        </div>\n      );\n    } else {\n      valueInput = (\n        <input type=\"text\"\n               ref=\"value-input\"\n               name=\"property_value\"\n               className=\"form-control property-value\"\n               value={this.state.property_value}\n               onChange={this.setValueState}\n               onBlur={this.handleChangeWithEvent}\n               placeholder={this.getInputPlaceholder()}\n               readOnly={this.props.filter.coercion_type === 'Null'}\n               autoComplete=\"off\" />\n      );\n    }\n\n    return (\n      <div className=\"row\">\n        <div className=\"col-md-3 form-collapse-right\">\n          <Select label={false}\n                  ref=\"type-set\"\n                  name=\"coercion_type\"\n                  classes=\"coercion-type\"\n                  sort={false}\n                  options={this.getCoercionOptions()}\n                  handleSelection={this.handleChangeWithEvent}\n                  selectedOption={this.props.filter.coercion_type}\n                  emptyOption={false} />\n        </div>\n        <div className=\"col-md-9 form-collapse-left\">\n          {valueInput}\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default FilterValueFields;\n","import _ from 'lodash';\nimport React from 'react';\n\nconst Geo = React.createClass({\n\n  // Note: Keen API standard is Longitude followed by Latitude.\n  render: function() {\n    return (\n      <div>\n        <div className=\"col-md-12\">\n          <label htmlFor=\"amount\">Longitude</label>\n          <input type=\"text\"\n                 name=\"coordinates.0\"\n                 className=\"form-control\"\n                 value={this.props.filter.property_value.coordinates[0] || \"\"}\n                 onChange={this.props.handleChange}\n                 autoComplete=\"off\" />\n        </div>\n        <div className=\"col-md-12\">\n          <label htmlFor=\"amount\">Latitude</label>\n          <input type=\"text\"\n                 name=\"coordinates.1\"\n                 className=\"form-control\"\n                 value={this.props.filter.property_value.coordinates[1] || \"\"}\n                 onChange={this.props.handleChange}\n                 autoComplete=\"off\" />\n        </div>\n        <div className=\"col-md-12\">\n          <label htmlFor=\"amount\">Radius in Miles</label>\n          <input type=\"text\"\n                 name=\"max_distance_miles\"\n                 className=\"form-control\"\n                 value={this.props.filter.property_value.max_distance_miles || \"\"}\n                 onChange={this.props.handleChange}\n                 autoComplete=\"off\" />\n        </div>\n      </div>\n    );\n  }\n});\n\nexport default Geo;\n","import _ from 'lodash';\nimport moment from 'moment';\nimport React from 'react';\nimport Select from './select.js';\nimport FieldsToggle from './fields_toggle.js';\nimport ExplorerActions from '../../actions/ExplorerActions';\nimport ExplorerUtils from '../../utils/ExplorerUtils';\nimport ProjectUtils from '../../utils/ProjectUtils';\n\nconst Interval = React.createClass({\n\n  setInterval: function(event) {\n    this.props.handleChange('interval', event.target.value);\n  },\n\n  intervalFieldsToggled: function(toggleState){\n    if (toggleState && !this.props.interval) {\n      this.props.handleChange('interval', 'daily')\n    }\n  },\n\n  intervalUpdateFn: function(updates) {\n    this.props.handleChange('interval', updates['interval'])\n  },\n\n  intervalGetFn: function(attr) {\n    if (attr === 'interval') {\n      return this.props.interval;\n    } else {\n      throw new Error(\"Interval component is only aware of interval attributes\")\n    }\n  },\n\n  // React Methods\n\n  render: function() {\n    return (\n      <div className=\"field-component\">\n        <FieldsToggle ref=\"interval-toggle\"\n                      name=\"Interval\"\n                      initialOpenState={this.props.interval}\n                      attrsToStore={'interval'}\n                      getFn={this.intervalGetFn}\n                      updateFn={this.intervalUpdateFn}\n                      toggleCallback={this.intervalFieldsToggled}>\n          <Select label={false}\n                  name=\"interval\"\n                  classes=\"interval-type\"\n                  options={ProjectUtils.getConstant('ABSOLUTE_INTERVAL_TYPES')}\n                  emptyOption={false}\n                  handleSelection={this.setInterval}\n                  selectedOption={this.props.interval}\n                  sort={false} />\n        </FieldsToggle>\n      </div>\n    );\n  }\n});\n\nexport default Interval;\n","import React from 'react';\n\nconst ApiUrl = React.createClass({\n\n  getInitialState: function(){\n    return {\n      active: false\n    }\n  },\n\n  handleClick: function(){\n    var self = this;\n    self.setState({ active: !self.state.active });\n    if (!self.state.active) {\n      setTimeout(function(){\n        self.refs['input'].focus();\n      }, 50);\n    }\n  },\n\n  handleInputSelect: function(e){\n    e.target.setSelectionRange(0, 9999);\n  },\n\n  handleInputChange: function(e){\n    e.preventDefault();\n  },\n\n  render: function(){\n    return (\n      <div className=\"explorer-api-url\">\n        <button className=\"btn btn-link field-secondary-control\" title=\"API URL\" type=\"button\" onClick={this.handleClick}>\n          <span className={\"icon glyphicon glyphicon-chevron-\" + (this.state.active ? \"down\" : \"right\") + \" icon-chevron-\" + (this.state.active ? \"down\" : \"right\")}></span> API Query URL\n        </button>\n        <div className={this.state.active ? \"show\" : \"hide\"}>\n          <input\n            ref=\"input\"\n            name=\"api-query\"\n            className=\"form-control input-sm\"\n            placeholder=\"API Query URL will appear here...\"\n            value={this.props.isValid ? this.props.url : \"\"}\n            onClick={this.handleInputSelect}\n            onFocus={this.handleInputSelect}\n            onChange={this.handleInputChange} />\n        </div>\n      </div>\n    );\n  }\n\n});\n\nexport default ApiUrl;\n","import React from 'react';\nimport _ from 'lodash';\nimport moment from 'moment';\n\nfunction dateForItem(item) {\n  if (item.created_date) {\n    var datetime = moment(new Date(item.created_date.replace(' ', 'T')));\n    return datetime.isValid() ? datetime.format('ll h:mm A') : null;\n  }\n}\n\nconst BrowseQueries = React.createClass({\n\n  clickCallback: function(event) {\n    this.props.clickCallback(event);\n  },\n\n  buildList: function() {\n    var listElements = this.props.listItems.map(_.bind(function(listItem, index) {\n      var isSelected = (this.props.selectedIndex === index) ? true : false;\n      var classes;\n      if (isSelected) classes = 'active';\n      var createdAt;\n      var datetime = dateForItem(listItem);\n      if (datetime) {\n        createdAt = (\n          <p className=\"date pull-right\">\n            <span className=\"icon glyphicon glyphicon-time\"></span>\n            {datetime}\n          </p>\n        );\n      }\n      var isCachedText = listItem.refresh_rate > 0 ? 'Cached' : '';\n\n      var displayName = null;\n      if (listItem.metadata && listItem.metadata.display_name) {\n        displayName = listItem.metadata.display_name;\n      } else if (listItem.query_name) {\n        displayName = listItem.query_name;\n      } else {\n        displayName = 'Query not named';\n      }\n\n      return (\n        <li className={classes} key={index} data-id={listItem.id} onClick={this.clickCallback}>\n          <h5 className=\"name\">{displayName}</h5>\n          <div className=\"metadata clearfix\">\n            <p className=\"date pull-left\">{isCachedText}</p>\n            {createdAt}\n          </div>\n        </li>\n      );\n    }, this));\n    return (\n      <ul ref=\"list\" className=\"interactive-list\">\n        {listElements}\n      </ul>\n    );\n  },\n\n  fieldChanged: function(event) {\n    var newState = {};\n    newState[event.target.name] = event.target.value;\n    this.setState(newState);\n  },\n\n  getDefaultProps: function() {\n    return {\n      listItems: [],\n      clickCallback: null,\n      selectedIndex: null,\n      notice: null,\n      emptyContent: null\n    };\n  },\n\n  render: function() {\n    var emptyContent = this.props.listItems.length ? null: this.props.emptyContent;\n    var listItems = this.buildList();\n\n    return (\n      <section className=\"query-pane-section browse-queries\">\n        {this.props.notice}\n        {listItems}\n        {emptyContent}\n      </section>\n    );\n  }\n\n});\n\nexport default BrowseQueries;\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport moment from 'moment';\n\nimport InfoIcon from '../common/info_icon';\n\nimport ExplorerActions from '../../actions/ExplorerActions';\nconst refreshRateMultiplier = 60 * 60;\n\nconst CacheToggle = React.createClass({\n\n  setCached: function(event) {\n    var updates = _.clone(this.props.model);\n    if (this._isCached()) {\n      updates.refresh_rate = 0;\n    }\n    else {\n      updates.refresh_rate = 14400;\n    }\n\n    ExplorerActions.update(this.props.model.id, updates);\n    this.setState({\n      settingsOpen: updates.refresh_rate == 0 ? false : this.state.settingsOpen\n    });\n  },\n\n  setSettingsOpen: function(event) {\n    event.preventDefault();\n    this.setState({ settingsOpen: !this.state.settingsOpen });\n  },\n\n  setRefreshRate: function(event) {\n    this.setState({ refresh_rate: event.target.value });\n  },\n\n  setRefreshRateBlur: function(event) {\n    var refresh_rate = Math.round(event.target.value*refreshRateMultiplier);\n    var updates = _.clone(this.props.model);\n    updates.refresh_rate = refresh_rate;\n\n    ExplorerActions.update(this.props.model.id, updates);\n    this.forceUpdate();\n  },\n\n  getInitialState: function() {\n   return {\n    refresh_rate: this._refreshRateInHours(this.props.model),\n    cached: false,\n    settingsOpen: false,\n    tooltip: false\n   }\n  },\n\n  tooltip: function(value) {\n    this.setState({tooltip: value})\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    this.setState({ refresh_rate: this._refreshRateInHours(nextProps.model) });\n  },\n\n  render: function() {\n    var isCached = this._isCached();\n    var parentClasses = classNames({\n      'cache-toggle': true,\n      'inactive': !isCached\n    });\n    var cacheDetailsClasses = classNames({\n      \"cache-details\": true,\n      \"hide\": !isCached\n    });\n    var cacheSettingsClasses = classNames({\n      \"cache-settings\": true,\n      \"hide\": !this.state.settingsOpen\n    });\n\n    var cacheToggleLabel = isCached? 'Caching enabled' : 'Enable caching';\n\n    return (\n      <div className={parentClasses}>\n\n        <label htmlFor=\"cache\">\n          <input type=\"checkbox\" name=\"cache\" id=\"cache\" \n            disabled={this.props.isLimited && !isCached}\n            onChange={this.setCached} checked={isCached} />\n          {cacheToggleLabel}\n        </label>\n        {this.props.isLimited &&\n          <div className='cache-limit'>\n            <span>Cached queries limit</span>\n            <div onMouseOver={() => this.tooltip(true)} onFocus={() => 0} onMouseLeave={() => this.tooltip(false)} >\n              <InfoIcon width='15px' height='15px' fill='#27566D' />\n                {this.state.tooltip &&\n                <div className='tooltip'>\n                  <p>You have reached the limit of cached queries for your organization (5 cached queries).</p>\n                  <p>Disable caching for other queries or contact us to extend the plan at <b>team@keen.io</b></p>\n                </div>\n                }\n            </div>\n          </div>\n       }\n\n        <span className={cacheDetailsClasses}>\n          {this._minutesAgo()}\n          <a href=\"#\" onClick={this.setSettingsOpen} className=\"margin-left-tiny\">\n            <span className=\"icon icon-cog glyphicon-cog glyphicon\"></span>\n          </a>\n        </span>\n\n        <span className={cacheSettingsClasses}>\n          Refresh every <input type=\"text\"\n                               name=\"refresh_rate\"\n                               value={this.state.refresh_rate}\n                               className=\"form-control\"\n                               onChange={this.setRefreshRate}\n                               onBlur={this.setRefreshRateBlur} /> hours ({\"min 4 / max 24\"})\n        </span>\n      </div>\n    );\n  },\n\n  _isCached: function() {\n    return this.props.model.refresh_rate != 0;\n  },\n\n  _minutesAgo: function() {\n    var runInformation = this.props.model.run_information;\n\n    if (runInformation != null && runInformation.last_run_status == 200) {\n      var lastRun = moment(runInformation.last_run_date).utcOffset(0);\n      var duration = moment.duration(lastRun.diff(moment())).humanize();\n      return 'Last updated ' + duration +\n          ' ago.';\n    }\n  },\n\n  _refreshRateInHours: function(model) {\n    return (model.refresh_rate/refreshRateMultiplier) * 100 / 100;\n  }\n\n});\n\nexport default CacheToggle;\n","import React from 'react';\n\nexport const InfoIcon = ({width, height, fill}) => {\n  return (\n    <svg width={width} height={height} viewBox=\"0 0 30 30\"><path fill={fill} d='M15,0 C23.2842712,0 30,6.71572875 30,15 C30,23.2842712 23.2842712,30 15,30 C6.71572875,30 0,23.2842712 0,15 C0,6.71572875 6.71572875,0 15,0 Z M15,3.33333333 C8.55667792,3.33333333 3.33333333,8.55667792 3.33333333,15 C3.33333333,21.4433221 8.55667792,26.6666667 15,26.6666667 C21.4433221,26.6666667 26.6666667,21.4433221 26.6666667,15 C26.6666667,8.55667792 21.4433221,3.33333333 15,3.33333333 Z M16.6666667,13.8333333 L16.6666667,22.9672147 L13.3333333,22.9672147 L13.3333333,13.8333333 L16.6666667,13.8333333 Z M14.959893,7 C15.3074866,7 15.6350267,7.06445672 15.9425134,7.19337017 C16.25,7.32228361 16.5196078,7.50184162 16.7513369,7.7320442 C16.983066,7.96224678 17.1657754,8.22928177 17.2994652,8.53314917 C17.4331551,8.83701657 17.5,9.16390424 17.5,9.51381215 C17.5,9.85451197 17.4331551,10.1744936 17.2994652,10.4737569 C17.1657754,10.7730203 16.983066,11.0354512 16.7513369,11.2610497 C16.5196078,11.4866483 16.25,11.6662063 15.9425134,11.7997238 C15.6350267,11.9332413 15.3074866,12 14.959893,12 C14.6212121,12 14.3048128,11.9332413 14.0106952,11.7997238 C13.7165775,11.6662063 13.4558824,11.4866483 13.2286096,11.2610497 C13.0013369,11.0354512 12.8230838,10.7730203 12.6938503,10.4737569 C12.5646168,10.1744936 12.5,9.85451197 12.5,9.51381215 C12.5,9.16390424 12.5646168,8.83701657 12.6938503,8.53314917 C12.8230838,8.22928177 13.0013369,7.96224678 13.2286096,7.7320442 C13.4558824,7.50184162 13.7165775,7.32228361 14.0106952,7.19337017 C14.3048128,7.06445672 14.6212121,7 14.959893,7 Z' /></svg>\n  )\n}\n\nexport default InfoIcon;","import _ from 'lodash';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport { EventEmitter } from 'events';\nimport NoticeConstants from '../constants/NoticeConstants';\nimport ExplorerConstants from '../constants/ExplorerConstants';\nimport ExplorerStore from '../stores/ExplorerStore';\n\nconst CHANGE_EVENT = 'change';\n\nlet _notices = {};\n\nfunction defaultAttrs() {\n  return {\n    location: 'global',\n    text: null,\n    type: null\n  };\n}\n\nfunction _removeGlobalNotices() {\n  _.each(_notices, function(val, key) {\n    if (val.location === 'global') delete _notices[key];\n  });\n}\n\nfunction _removeStepNotices() {\n  _.each(_notices, function(val, key) {\n    if (val.location === 'step') delete _notices[key];\n  });\n}\n\nfunction _create(attrs) {\n  if (!attrs.location || attrs.location === 'global') {\n    _removeGlobalNotices();\n  }\n  var tempId = \"TEMP-\" + (+new Date() + Math.floor(Math.random() * 999999)).toString(36);\n  _notices[tempId] = _.assign(defaultAttrs(), attrs);\n}\n\nfunction _clearAll() {\n  _notices = {};\n}\n\nvar NoticeStore = _.assign({}, EventEmitter.prototype, {\n  unregisterWithDispatcher: function() {\n    AppDispatcher.unregister(this.dispatchToken);\n  },\n\n  getGlobalNotice: function() {\n    return _.find(_notices, { location: 'global' });\n  },\n\n  getStepNotices: function() {\n    return _.filter(_notices, function(notice) {\n      if (notice.location === 'step') return notice;\n    });\n  },\n\n  clearAll: function() {\n    _clearAll();\n  },\n\n  emitChange: function() {\n    this.emit(CHANGE_EVENT);\n  },\n\n  addChangeListener: function(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n\n  removeChangeListener: function(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  }\n});\n\n// Register callback to handle all updates\nNoticeStore.dispatchToken = AppDispatcher.register(function(action) {\n  AppDispatcher.waitFor([ExplorerStore.dispatchToken]);\n\n  switch(action.actionType) {\n    case NoticeConstants.NOTICE_CREATE:\n      _create(action.attrs);\n      NoticeStore.emitChange();\n      break;\n\n    case NoticeConstants.NOTICE_CLEAR_ALL:\n      _clearAll();\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVING:\n      var text = action.saveType === 'save' ? 'Saving query...' : 'Updating query...';\n      _create({\n        type: 'info',\n        text: text,\n        icon: 'info-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_SUCCESS:\n      var text = action.saveType === 'save' ? 'Query saved' : 'Query updated';\n      _create({\n        type: 'success',\n        text: text + '.',\n        icon: 'ok'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_SAVE_FAIL:\n      var msg;\n      var text = action.saveType === 'save' ? 'saving' : 'updating';\n      if (action.errorMsg) {\n        msg = 'Problem ' + text + ': ' + action.errorMsg;\n      } else if (action.errorResp && action.errorResp.error_code === \"OverCachedQueryLimitError\") {\n        msg = 'Oops! Looks like youve reached your caching limit. Need more cached queries? Contact us at team@keen.io';\n      } else if (action.errorResp) {\n        msg = 'Problem ' + text + ': ' + JSON.parse(action.errorResp.text).message;\n      }\n      _create({\n        type: 'error',\n        text: msg,\n        icon: 'remove-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_DESTROYING:\n      _create({\n        type: 'info',\n        text: 'Deleting query...',\n        icon: 'info-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_DESTROY_SUCCESS:\n      _create({\n        type: 'success',\n        text: 'Query deleted.',\n        icon: 'ok'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_DESTROY_FAIL:\n      _create({\n        type: 'error',\n        text: 'There was a problem deleting your query: ' + action.errorMsg,\n        icon: 'remove-sign'\n      });\n      NoticeStore.emitChange();\n      break;\n\n    case ExplorerConstants.EXPLORER_FOUND_INVALID:\n      var explorer = ExplorerStore.get(action.id);\n      _create({\n        text: 'There was a problem: ' + explorer.errors[0].msg,\n        type: 'error',\n        icon: 'remove-sign'\n      });\n      if (explorer.query.analysis_type === 'funnel') {\n        _removeStepNotices();\n        explorer.query.steps.forEach(function(step, index) {\n          if (!step.isValid) {\n            _create({\n              id: explorer.id,\n              location: 'step',\n              stepIndex: index,\n              text: step.errors[0].msg,\n              type: 'error',\n              icon: 'remove-sign',\n            });\n          }\n        });\n      }\n      NoticeStore.emitChange();\n      break;\n\n    default:\n      // no op\n  }\n\n  return true;\n});\n\nexport default NoticeStore;\n"],"sourceRoot":""}